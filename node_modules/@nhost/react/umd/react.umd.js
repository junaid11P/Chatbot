(function(I,P){typeof exports=="object"&&typeof module!="undefined"?P(exports,require("react"),require("react/jsx-runtime")):typeof define=="function"&&define.amd?define(["exports","react","react/jsx-runtime"],P):(I=typeof globalThis!="undefined"?globalThis:I||self,P(I["@nhost/react"]={},I.React,I._jsx))})(this,function(I,P,zi){"use strict";function Ji(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const r in t)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:()=>t[r]})}}return e.default=t,Object.freeze(e)}const Wi=Ji(P);class Ze extends Error{}Ze.prototype.name="InvalidTokenError";function Qi(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Xi(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Qi(e)}catch{return atob(e)}}function Xt(t,e){if(typeof t!="string")throw new Ze("Invalid token specified: must be a string");e||(e={});const r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new Ze(`Invalid token specified: missing part #${r+1}`);let i;try{i=Xi(n)}catch(s){throw new Ze(`Invalid token specified: invalid base64 for part #${r+1} (${s.message})`)}try{return JSON.parse(i)}catch(s){throw new Ze(`Invalid token specified: invalid json for part #${r+1} (${s.message})`)}}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var S=function(){return S=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},S.apply(this,arguments)};function Zt(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function F(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function V(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function z(t,e,r){if(arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var Y;(function(t){t.Start="xstate.start",t.Stop="xstate.stop",t.Raise="xstate.raise",t.Send="xstate.send",t.Cancel="xstate.cancel",t.NullEvent="",t.Assign="xstate.assign",t.After="xstate.after",t.DoneState="done.state",t.DoneInvoke="done.invoke",t.Log="xstate.log",t.Init="xstate.init",t.Invoke="xstate.invoke",t.ErrorExecution="error.execution",t.ErrorCommunication="error.communication",t.ErrorPlatform="error.platform",t.ErrorCustom="xstate.error",t.Update="xstate.update",t.Pure="xstate.pure",t.Choose="xstate.choose"})(Y||(Y={}));var Ae;(function(t){t.Parent="#_parent",t.Internal="#_internal"})(Ae||(Ae={}));var mt=Y.Start,yt=Y.Stop,Ue=Y.Raise,et=Y.Send,er=Y.Cancel,Wr=Y.NullEvent,gt=Y.Assign,Zi=Y.After,es=Y.DoneState,Et=Y.Log,Qr=Y.Init,Tt=Y.Invoke,ts=Y.ErrorExecution,tr=Y.ErrorPlatform,rr=Y.ErrorCustom,St=Y.Update,Xr=Y.Choose,Zr=Y.Pure;const rs=Object.freeze(Object.defineProperty({__proto__:null,after:Zi,assign:gt,cancel:er,choose:Xr,doneState:es,error:rr,errorExecution:ts,errorPlatform:tr,init:Qr,invoke:Tt,log:Et,nullEvent:Wr,pure:Zr,raise:Ue,send:et,start:mt,stop:yt,update:St},Symbol.toStringTag,{value:"Module"}));var en=".",tn={},nr="xstate.guard",ns="",Q=process.env.NODE_ENV==="production",wt;function ir(t,e,r){r===void 0&&(r=en);var n=tt(t,r),i=tt(e,r);return G(i)?G(n)?i===n:!1:G(n)?n in i:Object.keys(n).every(function(s){return s in i?ir(n[s],i[s]):!1})}function rn(t){try{return G(t)||typeof t=="number"?"".concat(t):t.type}catch{throw new Error("Events must be strings or objects with a string event.type property.")}}function sr(t,e){try{return Me(t)?t:t.toString().split(e)}catch{throw new Error("'".concat(t,"' is not a valid state path."))}}function is(t){return typeof t=="object"&&"value"in t&&"context"in t&&"event"in t&&"_event"in t}function tt(t,e){if(is(t))return t.value;if(Me(t))return xt(t);if(typeof t!="string")return t;var r=sr(t,e);return xt(r)}function xt(t){if(t.length===1)return t[0];for(var e={},r=e,n=0;n<t.length-1;n++)n===t.length-2?r[t[n]]=t[n+1]:(r[t[n]]={},r=r[t[n]]);return e}function rt(t,e){for(var r={},n=Object.keys(t),i=0;i<n.length;i++){var s=n[i];r[s]=e(t[s],s,t,i)}return r}function nn(t,e,r){var n,i,s={};try{for(var o=F(Object.keys(t)),l=o.next();!l.done;l=o.next()){var c=l.value,a=t[c];r(a)&&(s[c]=e(a,c,t))}}catch(u){n={error:u}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}var ss=function(t){return function(e){var r,n,i=e;try{for(var s=F(t),o=s.next();!o.done;o=s.next()){var l=o.value;i=i[l]}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}};function os(t,e){return function(r){var n,i,s=r;try{for(var o=F(t),l=o.next();!l.done;l=o.next()){var c=l.value;s=s[e][c]}}catch(a){n={error:a}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}}function Ot(t){if(!t)return[[]];if(G(t))return[[t]];var e=X(Object.keys(t).map(function(r){var n=t[r];return typeof n!="string"&&(!n||!Object.keys(n).length)?[[r]]:Ot(t[r]).map(function(i){return[r].concat(i)})}));return e}function X(t){var e;return(e=[]).concat.apply(e,z([],V(t),!1))}function sn(t){return Me(t)?t:[t]}function fe(t){return t===void 0?[]:sn(t)}function kt(t,e,r){var n,i;if(B(t))return t(e,r.data);var s={};try{for(var o=F(Object.keys(t)),l=o.next();!l.done;l=o.next()){var c=l.value,a=t[c];B(a)?s[c]=a(e,r.data):s[c]=a}}catch(u){n={error:u}}finally{try{l&&!l.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s}function as(t){return/^(done|error)\./.test(t)}function on(t){return!!(t instanceof Promise||t!==null&&(B(t)||typeof t=="object")&&B(t.then))}function cs(t){return t!==null&&typeof t=="object"&&"transition"in t&&typeof t.transition=="function"}function us(t,e){var r,n,i=V([[],[]],2),s=i[0],o=i[1];try{for(var l=F(t),c=l.next();!c.done;c=l.next()){var a=c.value;e(a)?s.push(a):o.push(a)}}catch(u){r={error:u}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return[s,o]}function an(t,e){return rt(t.states,function(r,n){if(r){var i=(G(e)?void 0:e[n])||(r?r.current:void 0);if(i)return{current:i,states:an(r,i)}}})}function ls(t,e){return{current:e,states:an(t,e)}}function cn(t,e,r,n){Q||ie(!!t,"Attempting to update undefined context");var i=t&&r.reduce(function(s,o){var l,c,a=o.assignment,u={state:n,action:o,_event:e},f={};if(B(a))f=a(s,e.data,u);else try{for(var d=F(Object.keys(a)),h=d.next();!h.done;h=d.next()){var p=h.value,v=a[p];f[p]=B(v)?v(s,e.data,u):v}}catch(E){l={error:E}}finally{try{h&&!h.done&&(c=d.return)&&c.call(d)}finally{if(l)throw l.error}}return Object.assign({},s,f)},t);return i}var ie=function(){};Q||(ie=function(t,e){var r=t instanceof Error?t:void 0;if(!(!r&&t)&&console!==void 0){var n=["Warning: ".concat(e)];r&&n.push(r),console.warn.apply(console,n)}});function Me(t){return Array.isArray(t)}function B(t){return typeof t=="function"}function G(t){return typeof t=="string"}function un(t,e){if(t)return G(t)?{type:nr,name:t,predicate:e?e[t]:void 0}:B(t)?{type:nr,name:t.name,predicate:t}:t}function ds(t){try{return"subscribe"in t&&B(t.subscribe)}catch{return!1}}var Ie=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();wt={},wt[Ie]=function(){return this},wt[Symbol.observable]=function(){return this};function xe(t){return!!t&&"__xstatenode"in t}function hs(t){return!!t&&typeof t.send=="function"}var fs=function(){var t=0;return function(){return t++,t.toString(16)}}();function At(t,e){return G(t)||typeof t=="number"?S({type:t},e):t}function ae(t,e){if(!G(t)&&"$$type"in t&&t.$$type==="scxml")return t;var r=At(t);return S({name:r.type,data:r,$$type:"scxml",type:"external"},e)}function je(t,e){var r=sn(e).map(function(n){return typeof n=="undefined"||typeof n=="string"||xe(n)?{target:n,event:t}:S(S({},n),{event:t})});return r}function ps(t){if(!(t===void 0||t===ns))return fe(t)}function vs(t,e,r){if(!Q){var n=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";if(t===e)console.error("Missing onError handler for invocation '".concat(r,"', error was '").concat(t,"'.").concat(n));else{var i=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(r,"'. ")+"Original error: '".concat(t,"'. ").concat(n," Current error is '").concat(e,"'.").concat(i))}}}function ln(t,e,r,n,i){var s=t.options.guards,o={state:i,cond:e,_event:n};if(e.type===nr)return((s==null?void 0:s[e.name])||e.predicate)(r,n.data,o);var l=s==null?void 0:s[e.type];if(!l)throw new Error("Guard '".concat(e.type,"' is not implemented on machine '").concat(t.id,"'."));return l(r,n.data,o)}function dn(t){return typeof t=="string"?{type:t}:t}function nt(t,e,r){var n=function(){},i=typeof t=="object",s=i?t:null;return{next:((i?t.next:t)||n).bind(s),error:((i?t.error:e)||n).bind(s),complete:((i?t.complete:r)||n).bind(s)}}function It(t,e){return"".concat(t,":invocation[").concat(e,"]")}function or(t){return(t.type===Ue||t.type===et&&t.to===Ae.Internal)&&typeof t.delay!="number"}var Ne=ae({type:Qr});function bt(t,e){return e&&e[t]||void 0}function Fe(t,e){var r;if(G(t)||typeof t=="number"){var n=bt(t,e);B(n)?r={type:t,exec:n}:n?r=n:r={type:t,exec:void 0}}else if(B(t))r={type:t.name||t.toString(),exec:t};else{var n=bt(t.type,e);if(B(n))r=S(S({},t),{exec:n});else if(n){var i=n.type||t.type;r=S(S(S({},n),t),{type:i})}else r=t}return r}var Oe=function(t,e){if(!t)return[];var r=Me(t)?t:[t];return r.map(function(n){return Fe(n,e)})};function _t(t){var e=Fe(t);return S(S({id:G(t)?t:e.id},e),{type:e.type})}function hn(t,e){return{type:Ue,event:typeof t=="function"?t:At(t),delay:e?e.delay:void 0,id:e==null?void 0:e.id}}function fn(t,e,r,n){var i={_event:r},s=ae(B(t.event)?t.event(e,r.data,i):t.event),o;if(G(t.delay)){var l=n&&n[t.delay];o=B(l)?l(e,r.data,i):l}else o=B(t.delay)?t.delay(e,r.data,i):t.delay;return S(S({},t),{type:Ue,_event:s,delay:o})}function Re(t,e){return{to:e?e.to:void 0,type:et,event:B(t)?t:At(t),delay:e?e.delay:void 0,id:e&&e.id!==void 0?e.id:B(t)?t.name:rn(t)}}function pn(t,e,r,n){var i={_event:r},s=ae(B(t.event)?t.event(e,r.data,i):t.event),o;if(G(t.delay)){var l=n&&n[t.delay];o=B(l)?l(e,r.data,i):l}else o=B(t.delay)?t.delay(e,r.data,i):t.delay;var c=B(t.to)?t.to(e,r.data,i):t.to;return S(S({},t),{to:c,_event:s,event:s.data,delay:o})}function ar(t,e){return Re(t,S(S({},e),{to:Ae.Parent}))}function ms(t,e,r){return Re(e,S(S({},r),{to:t}))}function ys(){return ar(St)}function gs(t,e){return Re(t,S(S({},e),{to:function(r,n,i){var s=i._event;return s.origin}}))}var Es=function(t,e){return{context:t,event:e}};function Ts(t,e){return t===void 0&&(t=Es),{type:Et,label:e,expr:t}}var vn=function(t,e,r){return S(S({},t),{value:G(t.expr)?t.expr:t.expr(e,r.data,{_event:r})})},mn=function(t){return{type:er,sendId:t}};function yn(t){var e=_t(t);return{type:Y.Start,activity:e,exec:void 0}}function gn(t){var e=B(t)?t:_t(t);return{type:Y.Stop,activity:e,exec:void 0}}function En(t,e,r){var n=B(t.activity)?t.activity(e,r.data):t.activity,i=typeof n=="string"?{id:n}:n,s={type:Y.Stop,activity:i};return s}var Tn=function(t){return{type:gt,assignment:t}};function Ss(t){return typeof t=="object"&&"type"in t}function Sn(t,e){var r=e?"#".concat(e):"";return"".concat(Y.After,"(").concat(t,")").concat(r)}function it(t,e){var r="".concat(Y.DoneState,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function st(t,e){var r="".concat(Y.DoneInvoke,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function Ve(t,e){var r="".concat(Y.ErrorPlatform,".").concat(t),n={type:r,data:e};return n.toString=function(){return r},n}function ws(t){return{type:Y.Pure,get:t}}function xs(t,e){if(!Q&&(!t||typeof t=="function")){var r=t;t=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var s=typeof r=="function"?r.apply(void 0,z([],V(n),!1)):r;if(!s)throw new Error("Attempted to forward event to undefined actor. This risks an infinite loop in the sender.");return s}}return Re(function(n,i){return i},S(S({},e),{to:t}))}function Os(t,e){return ar(function(r,n,i){return{type:rr,data:B(t)?t(r,n,i):t}},S(S({},e),{to:Ae.Parent}))}function ks(t){return{type:Y.Choose,conds:t}}var As=function(t){var e,r,n=[];try{for(var i=F(t),s=i.next();!s.done;s=i.next())for(var o=s.value,l=0;l<o.actions.length;){if(o.actions[l].type===gt){n.push(o.actions[l]),o.actions.splice(l,1);continue}l++}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n};function ot(t,e,r,n,i,s,o){o===void 0&&(o=!1);var l=o?[]:As(i),c=l.length?cn(r,n,l,e):r,a=o?[r]:void 0,u=[];function f(p,v){var E;switch(v.type){case Ue:{var g=fn(v,c,n,t.options.delays);return s&&typeof g.delay=="number"&&s(g,c,n),g}case et:var x=pn(v,c,n,t.options.delays);if(!Q){var O=v.delay;ie(!G(O)||typeof x.delay=="number","No delay reference for delay expression '".concat(O,"' was found on machine '").concat(t.id,"'"))}return s&&x.to!==Ae.Internal&&(p==="entry"?u.push(x):s(x,c,n)),x;case Et:{var k=vn(v,c,n);return s==null||s(k,c,n),k}case Xr:{var C=v,b=(E=C.conds.find(function(m){var w=un(m.cond,t.options.guards);return!w||ln(t,w,c,n,s?void 0:e)}))===null||E===void 0?void 0:E.actions;if(!b)return[];var _=V(ot(t,e,c,n,[{type:p,actions:Oe(fe(b),t.options.actions)}],s,o),2),M=_[0],j=_[1];return c=j,a==null||a.push(c),M}case Zr:{var b=v.get(c,n.data);if(!b)return[];var Z=V(ot(t,e,c,n,[{type:p,actions:Oe(fe(b),t.options.actions)}],s,o),2),D=Z[0],$=Z[1];return c=$,a==null||a.push(c),D}case yt:{var k=En(v,c,n);return s==null||s(k,r,n),k}case gt:{c=cn(c,n,[v],s?void 0:e),a==null||a.push(c);break}default:var re=Fe(v,t.options.actions),W=re.exec;if(s)s(re,c,n);else if(W&&a){var Ce=a.length-1,Le=S(S({},re),{exec:function(m){for(var w=[],N=1;N<arguments.length;N++)w[N-1]=arguments[N];W.apply(void 0,z([a[Ce]],V(w),!1))}});re=Le}return re}}function d(p){var v,E,g=[];try{for(var x=F(p.actions),O=x.next();!O.done;O=x.next()){var k=O.value,C=f(p.type,k);C&&(g=g.concat(C))}}catch(b){v={error:b}}finally{try{O&&!O.done&&(E=x.return)&&E.call(x)}finally{if(v)throw v.error}}return u.forEach(function(b){s(b,c,n)}),u.length=0,g}var h=X(i.map(d));return[h,c]}const Is=Object.freeze(Object.defineProperty({__proto__:null,actionTypes:rs,after:Sn,assign:Tn,cancel:mn,choose:ks,done:it,doneInvoke:st,error:Ve,escalate:Os,forwardTo:xs,getActionFunction:bt,initEvent:Ne,isActionObject:Ss,log:Ts,pure:ws,raise:hn,resolveActions:ot,resolveLog:vn,resolveRaise:fn,resolveSend:pn,resolveStop:En,respond:gs,send:Re,sendParent:ar,sendTo:ms,sendUpdate:ys,start:yn,stop:gn,toActionObject:Fe,toActionObjects:Oe,toActivityDefinition:_t},Symbol.toStringTag,{value:"Module"}));var Nt=[],Be=function(t,e){Nt.push(t);var r=e(t);return Nt.pop(),r},bs=function(t){return t(Nt[Nt.length-1])};function wn(t){var e;return e={id:t,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:t}}},e[Ie]=function(){return this},e}function _s(t,e,r,n){var i,s=dn(t.src),o=(i=e==null?void 0:e.options.services)===null||i===void 0?void 0:i[s.type],l=t.data?kt(t.data,r,n):void 0,c=o?cr(o,t.id,l):wn(t.id);return c.meta=t,c}function cr(t,e,r){var n=wn(e);if(n.deferred=!0,xe(t)){var i=n.state=Be(void 0,function(){return(r?t.withContext(r):t).initialState});n.getSnapshot=function(){return i}}return n}function Ns(t){try{return typeof t.send=="function"}catch{return!1}}function Rs(t){return Ns(t)&&"id"in t}function Ds(t){var e;return S((e={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}},e[Ie]=function(){return this},e),t)}var Rt=function(t){return t.type==="atomic"||t.type==="final"};function xn(t){return Object.keys(t.states).map(function(e){return t.states[e]})}function at(t){return xn(t).filter(function(e){return e.type!=="history"})}function On(t){var e=[t];return Rt(t)?e:e.concat(X(at(t).map(On)))}function ct(t,e){var r,n,i,s,o,l,c,a,u=new Set(t),f=ur(u),d=new Set(e);try{for(var h=F(d),p=h.next();!p.done;p=h.next())for(var v=p.value,E=v.parent;E&&!d.has(E);)d.add(E),E=E.parent}catch(j){r={error:j}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}var g=ur(d);try{for(var x=F(d),O=x.next();!O.done;O=x.next()){var v=O.value;if(v.type==="compound"&&(!g.get(v)||!g.get(v).length))f.get(v)?f.get(v).forEach(function(Z){return d.add(Z)}):v.initialStateNodes.forEach(function(Z){return d.add(Z)});else if(v.type==="parallel")try{for(var k=(o=void 0,F(at(v))),C=k.next();!C.done;C=k.next()){var b=C.value;d.has(b)||(d.add(b),f.get(b)?f.get(b).forEach(function(Z){return d.add(Z)}):b.initialStateNodes.forEach(function(Z){return d.add(Z)}))}}catch(Z){o={error:Z}}finally{try{C&&!C.done&&(l=k.return)&&l.call(k)}finally{if(o)throw o.error}}}}catch(j){i={error:j}}finally{try{O&&!O.done&&(s=x.return)&&s.call(x)}finally{if(i)throw i.error}}try{for(var _=F(d),M=_.next();!M.done;M=_.next())for(var v=M.value,E=v.parent;E&&!d.has(E);)d.add(E),E=E.parent}catch(j){c={error:j}}finally{try{M&&!M.done&&(a=_.return)&&a.call(_)}finally{if(c)throw c.error}}return d}function kn(t,e){var r=e.get(t);if(!r)return{};if(t.type==="compound"){var n=r[0];if(n){if(Rt(n))return n.key}else return{}}var i={};return r.forEach(function(s){i[s.key]=kn(s,e)}),i}function ur(t){var e,r,n=new Map;try{for(var i=F(t),s=i.next();!s.done;s=i.next()){var o=s.value;n.has(o)||n.set(o,[]),o.parent&&(n.has(o.parent)||n.set(o.parent,[]),n.get(o.parent).push(o))}}catch(l){e={error:l}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function Ps(t,e){var r=ct([t],e);return kn(t,ur(r))}function ut(t,e){return Array.isArray(t)?t.some(function(r){return r===e}):t instanceof Set?t.has(e):!1}function Cs(t){return z([],V(new Set(X(z([],V(t.map(function(e){return e.ownEvents})),!1)))),!1)}function Dt(t,e){return e.type==="compound"?at(e).some(function(r){return r.type==="final"&&ut(t,r)}):e.type==="parallel"?at(e).every(function(r){return Dt(t,r)}):!1}function Ls(t){return t===void 0&&(t=[]),t.reduce(function(e,r){return r.meta!==void 0&&(e[r.id]=r.meta),e},{})}function An(t){return new Set(X(t.map(function(e){return e.tags})))}function In(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;if(G(t)||G(e))return t===e;var r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every(function(i){return In(t[i],e[i])})}function Us(t){return typeof t!="object"||t===null?!1:"value"in t&&"_event"in t}function Ms(t,e){var r=t.exec,n=S(S({},t),{exec:r!==void 0?function(){return r(e.context,e.event,{action:t,state:e,_event:e._event})}:void 0});return n}var pe=function(){function t(e){var r=this,n;this.actions=[],this.activities=tn,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||tn,this.meta=Ls(e.configuration),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=(n=Array.isArray(e.tags)?new Set(e.tags):e.tags)!==null&&n!==void 0?n:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return Cs(r.configuration)}})}return t.from=function(e,r){if(e instanceof t)return e.context!==r?new t({value:e.value,context:r,_event:e._event,_sessionid:null,historyValue:e.historyValue,history:e.history,actions:[],activities:e.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):e;var n=Ne;return new t({value:e,context:r,_event:n,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},t.create=function(e){return new t(e)},t.inert=function(e,r){if(e instanceof t){if(!e.actions.length)return e;var n=Ne;return new t({value:e.value,context:r,_event:n,_sessionid:null,historyValue:e.historyValue,history:e.history,activities:e.activities,configuration:e.configuration,transitions:[],children:{}})}return t.from(e,r)},t.prototype.toStrings=function(e,r){var n=this;if(e===void 0&&(e=this.value),r===void 0&&(r="."),G(e))return[e];var i=Object.keys(e);return i.concat.apply(i,z([],V(i.map(function(s){return n.toStrings(e[s],r).map(function(o){return s+r+o})})),!1))},t.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var r=e.tags;e.machine;var n=Zt(e,["configuration","transitions","tags","machine"]);return S(S({},n),{tags:Array.from(r)})},t.prototype.matches=function(e){return ir(e,this.value)},t.prototype.hasTag=function(e){return this.tags.has(e)},t.prototype.can=function(e){var r;Q&&ie(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=(r=this.machine)===null||r===void 0?void 0:r.getTransitionData(this,e);return!!(n!=null&&n.transitions.length)&&n.transitions.some(function(i){return i.target!==void 0||i.actions.length})},t}(),js={deferEvents:!1},bn=function(){function t(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=S(S({},js),e)}return t.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents){this.schedule(e);return}this.process(e)}this.flushEvents()},t.prototype.schedule=function(e){if(!this.initialized||this.processingEvent){this.queue.push(e);return}if(this.queue.length!==0)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()},t.prototype.clear=function(){this.queue=[]},t.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},t.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(r){throw this.clear(),r}finally{this.processingEvent=!1}},t}(),lr=new Map,Fs=0,lt={bookId:function(){return"x:".concat(Fs++)},register:function(t,e){return lr.set(t,e),t},get:function(t){return lr.get(t)},free:function(t){lr.delete(t)}};function dr(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;Q||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues")}function Vs(){var t=dr();if(t&&"__xstate__"in t)return t.__xstate__}function Bs(t){if(dr()){var e=Vs();e&&e.register(t)}}function Gs(t,e){e===void 0&&(e={});var r=t.initialState,n=new Set,i=[],s=!1,o=function(){if(!s){for(s=!0;i.length>0;){var a=i.shift();r=t.transition(r,a,c),n.forEach(function(u){return u.next(r)})}s=!1}},l=Ds({id:e.id,send:function(a){i.push(a),o()},getSnapshot:function(){return r},subscribe:function(a,u,f){var d=nt(a,u,f);return n.add(d),d.next(r),{unsubscribe:function(){n.delete(d)}}}}),c={parent:e.parent,self:l,id:e.id||"anonymous",observers:n};return r=t.start?t.start(c):r,l}var hr={sync:!1,autoForward:!1},ee;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(ee||(ee={}));var Hs=function(){function t(e,r){r===void 0&&(r=t.defaultOptions);var n=this;this.machine=e,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=ee.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(u,f){if(Me(u))return n.batch(u),n.state;var d=ae(At(u,f));if(n.status===ee.Stopped)return Q||ie(!1,'Event "'.concat(d.name,'" was sent to stopped service "').concat(n.machine.id,`". This service has already reached its final state, and will not transition.
Event: `).concat(JSON.stringify(d.data))),n.state;if(n.status!==ee.Running&&!n.options.deferEvents)throw new Error('Event "'.concat(d.name,'" was sent to uninitialized service "').concat(n.machine.id,`". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.
Event: `).concat(JSON.stringify(d.data)));return n.scheduler.schedule(function(){n.forward(d);var h=n._nextState(d);n.update(h,d)}),n._state},this.sendTo=function(u,f,d){var h=n.parent&&(f===Ae.Parent||n.parent.id===f),p=h?n.parent:G(f)?f===Ae.Internal?n:n.children.get(f)||lt.get(f):hs(f)?f:void 0;if(!p){if(!h)throw new Error("Unable to send event to child '".concat(f,"' from service '").concat(n.id,"'."));Q||ie(!1,"Service '".concat(n.id,"' has no parent: unable to send event ").concat(u.type));return}if("machine"in p){if(n.status!==ee.Stopped||n.parent!==p||n.state.done){var v=S(S({},u),{name:u.name===rr?"".concat(Ve(n.id)):u.name,origin:n.sessionId});!d&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([p,v]):p.send(v)}}else!d&&n.machine.config.predictableActionArguments?n._outgoingQueue.push([p,u.data]):p.send(u.data)},this._exec=function(u,f,d,h){h===void 0&&(h=n.machine.options.actions);var p=u.exec||bt(u.type,h),v=B(p)?p:p?p.exec:u.exec;if(v)try{return v(f,d.data,n.machine.config.predictableActionArguments?{action:u,_event:d}:{action:u,state:n.state,_event:d})}catch(W){throw n.parent&&n.parent.send({type:"xstate.error",data:W}),W}switch(u.type){case Ue:{var E=u;n.defer(E);break}case et:var g=u;if(typeof g.delay=="number"){n.defer(g);return}else g.to?n.sendTo(g._event,g.to,d===Ne):n.send(g._event);break;case er:n.cancel(u.sendId);break;case mt:{if(n.status!==ee.Running)return;var x=u.activity;if(!n.machine.config.predictableActionArguments&&!n.state.activities[x.id||x.type])break;if(x.type===Y.Invoke){var O=dn(x.src),k=n.machine.options.services?n.machine.options.services[O.type]:void 0,C=x.id,b=x.data;Q||ie(!("forward"in x),"`forward` property is deprecated (found in invocation of '".concat(x.src,"' in in machine '").concat(n.machine.id,"'). ")+"Please use `autoForward` instead.");var _="autoForward"in x?x.autoForward:!!x.forward;if(!k){Q||ie(!1,"No service found for invocation '".concat(x.src,"' in machine '").concat(n.machine.id,"'."));return}var M=b?kt(b,f,d):void 0;if(typeof k=="string")return;var j=B(k)?k(f,d.data,{data:M,src:O,meta:x.meta}):k;if(!j)return;var Z=void 0;xe(j)&&(j=M?j.withContext(M):j,Z={autoForward:_}),n.spawn(j,C,Z)}else n.spawnActivity(x);break}case yt:{n.stopChild(u.activity.id);break}case Et:var D=u,$=D.label,re=D.value;$?n.logger($,re):n.logger(re);break;default:Q||ie(!1,"No implementation found for action type '".concat(u.type,"'"));break}};var i=S(S({},t.defaultOptions),r),s=i.clock,o=i.logger,l=i.parent,c=i.id,a=c!==void 0?c:e.id;this.id=a,this.logger=o,this.clock=s,this.parent=l,this.options=i,this.scheduler=new bn({deferEvents:this.options.deferEvents}),this.sessionId=lt.bookId()}return Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:Be(this,function(){return e._initialState=e.machine.initialState,e._initialState})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return Q||ie(this.status!==ee.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),t.prototype.execute=function(e,r){var n,i;try{for(var s=F(e.actions),o=s.next();!o.done;o=s.next()){var l=o.value;this.exec(l,e,r)}}catch(c){n={error:c}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}},t.prototype.update=function(e,r){var n,i,s,o,l,c,a,u,f=this;if(e._sessionid=this.sessionId,this._state=e,(!this.machine.config.predictableActionArguments||r===Ne)&&this.options.execute)this.execute(this.state);else for(var d=void 0;d=this._outgoingQueue.shift();)d[0].send(d[1]);if(this.children.forEach(function(j){f.state.children[j.id]=j}),this.devTools&&this.devTools.send(r.data,e),e.event)try{for(var h=F(this.eventListeners),p=h.next();!p.done;p=h.next()){var v=p.value;v(e.event)}}catch(j){n={error:j}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}try{for(var E=F(this.listeners),g=E.next();!g.done;g=E.next()){var v=g.value;v(e,e.event)}}catch(j){s={error:j}}finally{try{g&&!g.done&&(o=E.return)&&o.call(E)}finally{if(s)throw s.error}}try{for(var x=F(this.contextListeners),O=x.next();!O.done;O=x.next()){var k=O.value;k(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(j){l={error:j}}finally{try{O&&!O.done&&(c=x.return)&&c.call(x)}finally{if(l)throw l.error}}if(this.state.done){var C=e.configuration.find(function(j){return j.type==="final"&&j.parent===f.machine}),b=C&&C.doneData?kt(C.doneData,e.context,r):void 0;this._doneEvent=st(this.id,b);try{for(var _=F(this.doneListeners),M=_.next();!M.done;M=_.next()){var v=M.value;v(this._doneEvent)}}catch(j){a={error:j}}finally{try{M&&!M.done&&(u=_.return)&&u.call(_)}finally{if(a)throw a.error}}this._stop(),this._stopChildren(),lt.free(this.sessionId)}},t.prototype.onTransition=function(e){return this.listeners.add(e),this.status===ee.Running&&e(this.state,this.state.event),this},t.prototype.subscribe=function(e,r,n){var i=this,s=nt(e,r,n);this.listeners.add(s.next),this.status!==ee.NotStarted&&s.next(this.state);var o=function(){i.doneListeners.delete(o),i.stopListeners.delete(o),s.complete()};return this.status===ee.Stopped?s.complete():(this.onDone(o),this.onStop(o)),{unsubscribe:function(){i.listeners.delete(s.next),i.doneListeners.delete(o),i.stopListeners.delete(o)}}},t.prototype.onEvent=function(e){return this.eventListeners.add(e),this},t.prototype.onSend=function(e){return this.sendListeners.add(e),this},t.prototype.onChange=function(e){return this.contextListeners.add(e),this},t.prototype.onStop=function(e){return this.stopListeners.add(e),this},t.prototype.onDone=function(e){return this.status===ee.Stopped&&this._doneEvent?e(this._doneEvent):this.doneListeners.add(e),this},t.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},t.prototype.start=function(e){var r=this;if(this.status===ee.Running)return this;this.machine._init(),lt.register(this.sessionId,this),this.initialized=!0,this.status=ee.Running;var n=e===void 0?this.initialState:Be(this,function(){return Us(e)?r.machine.resolveState(e):r.machine.resolveState(pe.from(e,r.machine.context))});return this.options.devTools&&this.attachDev(),this.scheduler.initialize(function(){r.update(n,Ne)}),this},t.prototype._stopChildren=function(){this.children.forEach(function(e){B(e.stop)&&e.stop()}),this.children.clear()},t.prototype._stop=function(){var e,r,n,i,s,o,l,c,a,u;try{for(var f=F(this.listeners),d=f.next();!d.done;d=f.next()){var h=d.value;this.listeners.delete(h)}}catch(_){e={error:_}}finally{try{d&&!d.done&&(r=f.return)&&r.call(f)}finally{if(e)throw e.error}}try{for(var p=F(this.stopListeners),v=p.next();!v.done;v=p.next()){var h=v.value;h(),this.stopListeners.delete(h)}}catch(_){n={error:_}}finally{try{v&&!v.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}try{for(var E=F(this.contextListeners),g=E.next();!g.done;g=E.next()){var h=g.value;this.contextListeners.delete(h)}}catch(_){s={error:_}}finally{try{g&&!g.done&&(o=E.return)&&o.call(E)}finally{if(s)throw s.error}}try{for(var x=F(this.doneListeners),O=x.next();!O.done;O=x.next()){var h=O.value;this.doneListeners.delete(h)}}catch(_){l={error:_}}finally{try{O&&!O.done&&(c=x.return)&&c.call(x)}finally{if(l)throw l.error}}if(!this.initialized)return this;this.initialized=!1,this.status=ee.Stopped,this._initialState=void 0;try{for(var k=F(Object.keys(this.delayedEventsMap)),C=k.next();!C.done;C=k.next()){var b=C.value;this.clock.clearTimeout(this.delayedEventsMap[b])}}catch(_){a={error:_}}finally{try{C&&!C.done&&(u=k.return)&&u.call(k)}finally{if(a)throw a.error}}this.scheduler.clear(),this.scheduler=new bn({deferEvents:this.options.deferEvents})},t.prototype.stop=function(){var e=this,r=this.scheduler;return this._stop(),r.schedule(function(){var n;if(!(!((n=e._state)===null||n===void 0)&&n.done)){var i=ae({type:"xstate.stop"}),s=Be(e,function(){var o=X(z([],V(e.state.configuration),!1).sort(function(f,d){return d.order-f.order}).map(function(f){return Oe(f.onExit,e.machine.options.actions)})),l=V(ot(e.machine,e.state,e.state.context,i,[{type:"exit",actions:o}],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),c=l[0],a=l[1],u=new pe({value:e.state.value,context:a,_event:i,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:c.filter(function(f){return!or(f)}),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return u.changed=!0,u});e.update(s,i),e._stopChildren(),lt.free(e.sessionId)}}),this},t.prototype.batch=function(e){var r=this;if(this.status===ee.NotStarted&&this.options.deferEvents)Q||ie(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,`" and are deferred. Make sure .start() is called for this service.
Event: `).concat(JSON.stringify(event)));else if(this.status!==ee.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(e.length){var n=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule(function(){var i,s,o=r.state,l=!1,c=[],a=function(h){var p=ae(h);r.forward(p),o=Be(r,function(){return r.machine.transition(o,p,void 0,n||void 0)}),c.push.apply(c,z([],V(r.machine.config.predictableActionArguments?o.actions:o.actions.map(function(v){return Ms(v,o)})),!1)),l=l||!!o.changed};try{for(var u=F(e),f=u.next();!f.done;f=u.next()){var d=f.value;a(d)}}catch(h){i={error:h}}finally{try{f&&!f.done&&(s=u.return)&&s.call(u)}finally{if(i)throw i.error}}o.changed=l,o.actions=c,r.update(o,ae(e[e.length-1]))})}},t.prototype.sender=function(e){return this.send.bind(this,e)},t.prototype._nextState=function(e,r){var n=this;r===void 0&&(r=!!this.machine.config.predictableActionArguments&&this._exec);var i=ae(e);if(i.name.indexOf(tr)===0&&!this.state.nextEvents.some(function(o){return o.indexOf(tr)===0}))throw i.data.data;var s=Be(this,function(){return n.machine.transition(n.state,i,void 0,r||void 0)});return s},t.prototype.nextState=function(e){return this._nextState(e,!1)},t.prototype.forward=function(e){var r,n;try{for(var i=F(this.forwardTo),s=i.next();!s.done;s=i.next()){var o=s.value,l=this.children.get(o);if(!l)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(o,"'."));l.send(e)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.defer=function(e){var r=this,n=this.clock.setTimeout(function(){"to"in e&&e.to?r.sendTo(e._event,e.to,!0):r.send(e._event)},e.delay);e.id&&(this.delayedEventsMap[e.id]=n)},t.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},t.prototype.exec=function(e,r,n){n===void 0&&(n=this.machine.options.actions),this._exec(e,r.context,r._event,n)},t.prototype.removeChild=function(e){var r;this.children.delete(e),this.forwardTo.delete(e),(r=this.state)===null||r===void 0||delete r.children[e]},t.prototype.stopChild=function(e){var r=this.children.get(e);r&&(this.removeChild(e),B(r.stop)&&r.stop())},t.prototype.spawn=function(e,r,n){if(this.status!==ee.Running)return cr(e,r);if(on(e))return this.spawnPromise(Promise.resolve(e),r);if(B(e))return this.spawnCallback(e,r);if(Rs(e))return this.spawnActor(e,r);if(ds(e))return this.spawnObservable(e,r);if(xe(e))return this.spawnMachine(e,S(S({},n),{id:r}));if(cs(e))return this.spawnBehavior(e,r);throw new Error('Unable to spawn entity "'.concat(r,'" of type "').concat(typeof e,'".'))},t.prototype.spawnMachine=function(e,r){var n=this;r===void 0&&(r={});var i=new t(e,S(S({},this.options),{parent:this,id:r.id||e.id})),s=S(S({},hr),r);s.sync&&i.onTransition(function(l){n.send(St,{state:l,id:i.id})});var o=i;return this.children.set(i.id,o),s.autoForward&&this.forwardTo.add(i.id),i.onDone(function(l){n.removeChild(i.id),n.send(ae(l,{origin:i.id}))}).start(),o},t.prototype.spawnBehavior=function(e,r){var n=Gs(e,{id:r,parent:this});return this.children.set(r,n),n},t.prototype.spawnPromise=function(e,r){var n,i=this,s=!1,o;e.then(function(c){s||(o=c,i.removeChild(r),i.send(ae(st(r,c),{origin:r})))},function(c){if(!s){i.removeChild(r);var a=Ve(r,c);try{i.send(ae(a,{origin:r}))}catch(u){vs(c,u,r),i.devTools&&i.devTools.send(a,i.state),i.machine.strict&&i.stop()}}});var l=(n={id:r,send:function(){},subscribe:function(c,a,u){var f=nt(c,a,u),d=!1;return e.then(function(h){d||(f.next(h),!d&&f.complete())},function(h){d||f.error(h)}),{unsubscribe:function(){return d=!0}}},stop:function(){s=!0},toJSON:function(){return{id:r}},getSnapshot:function(){return o}},n[Ie]=function(){return this},n);return this.children.set(r,l),l},t.prototype.spawnCallback=function(e,r){var n,i=this,s=!1,o=new Set,l=new Set,c,a=function(d){c=d,l.forEach(function(h){return h(d)}),!s&&i.send(ae(d,{origin:r}))},u;try{u=e(a,function(d){o.add(d)})}catch(d){this.send(Ve(r,d))}if(on(u))return this.spawnPromise(u,r);var f=(n={id:r,send:function(d){return o.forEach(function(h){return h(d)})},subscribe:function(d){var h=nt(d);return l.add(h.next),{unsubscribe:function(){l.delete(h.next)}}},stop:function(){s=!0,B(u)&&u()},toJSON:function(){return{id:r}},getSnapshot:function(){return c}},n[Ie]=function(){return this},n);return this.children.set(r,f),f},t.prototype.spawnObservable=function(e,r){var n,i=this,s,o=e.subscribe(function(c){s=c,i.send(ae(c,{origin:r}))},function(c){i.removeChild(r),i.send(ae(Ve(r,c),{origin:r}))},function(){i.removeChild(r),i.send(ae(st(r),{origin:r}))}),l=(n={id:r,send:function(){},subscribe:function(c,a,u){return e.subscribe(c,a,u)},stop:function(){return o.unsubscribe()},getSnapshot:function(){return s},toJSON:function(){return{id:r}}},n[Ie]=function(){return this},n);return this.children.set(r,l),l},t.prototype.spawnActor=function(e,r){return this.children.set(r,e),e},t.prototype.spawnActivity=function(e){var r=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(!r){Q||ie(!1,"No implementation found for activity '".concat(e.type,"'"));return}var n=r(this.state.context,e);this.spawnEffect(e.id,n)},t.prototype.spawnEffect=function(e,r){var n;this.children.set(e,(n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:r||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}},n[Ie]=function(){return this},n))},t.prototype.attachDev=function(){var e=dr();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var r=typeof this.options.devTools=="object"?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(S(S({name:this.id,autoPause:!0,stateSanitizer:function(n){return{value:n.value,context:n.context,actions:n.actions}}},r),{features:S({jump:!1,skip:!1},r?r.features:void 0)}),this.machine),this.devTools.init(this.state)}Bs(this)}},t.prototype.toJSON=function(){return{id:this.id}},t.prototype[Ie]=function(){return this},t.prototype.getSnapshot=function(){return this.status===ee.NotStarted?this.initialState:this._state},t.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,r){return setTimeout(e,r)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},t.interpret=De,t}(),Ks=function(t){return G(t)?S(S({},hr),{name:t}):S(S(S({},hr),{name:fs()}),t)};function Ys(t,e){var r=Ks(e);return bs(function(n){if(!Q){var i=xe(t)||B(t);ie(!!n||i,'Attempted to spawn an Actor (ID: "'.concat(xe(t)?t.id:"undefined",'") outside of a service. This will have no effect.'))}return n?n.spawn(t,r.name,r):cr(t,r.name)})}function De(t,e){var r=new Hs(t,e);return r}function $s(t){if(typeof t=="string"){var e={type:t};return e.toString=function(){return t},e}return t}function Pt(t){return S(S({type:Tt},t),{toJSON:function(){t.onDone,t.onError;var e=Zt(t,["onDone","onError"]);return S(S({},e),{type:Tt,src:$s(t.src)})}})}var Ge="",fr="#",dt="*",He={},Ke=function(t){return t[0]===fr},qs=function(){return{actions:{},guards:{},services:{},activities:{},delays:{}}},zs=function(t,e,r){var n=r.slice(0,-1).some(function(s){return!("cond"in s)&&!("in"in s)&&(G(s.target)||xe(s.target))}),i=e===Ge?"the transient event":"event '".concat(e,"'");ie(!n,"One or more transitions for ".concat(i," on state '").concat(t.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")},Js=function(){function t(e,r,n,i){n===void 0&&(n="context"in e?e.context:void 0);var s=this,o;this.config=e,this._context=n,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign(qs(),r),this.parent=i==null?void 0:i.parent,this.key=this.config.key||(i==null?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:en),this.id=this.config.id||z([this.machine.key],V(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:(o=this.config.schema)!==null&&o!==void 0?o:{},this.description=this.config.description,Q||ie(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?rt(this.config.states,function(a,u){var f,d=new t(a,{},void 0,{parent:s,key:u});return Object.assign(s.idMap,S((f={},f[d.id]=d,f),d.idMap)),d}):He;var l=0;function c(a){var u,f;a.order=l++;try{for(var d=F(xn(a)),h=d.next();!h.done;h=d.next()){var p=h.value;c(p)}}catch(v){u={error:v}}finally{try{h&&!h.done&&(f=d.return)&&f.call(d)}finally{if(u)throw u.error}}}c(this),this.history=this.config.history===!0?"shallow":this.config.history||!1,this._transient=!!this.config.always||(this.config.on?Array.isArray(this.config.on)?this.config.on.some(function(a){var u=a.event;return u===Ge}):Ge in this.config.on:!1),this.strict=!!this.config.strict,this.onEntry=fe(this.config.entry||this.config.onEntry).map(function(a){return Fe(a)}),this.onExit=fe(this.config.exit||this.config.onExit).map(function(a){return Fe(a)}),this.meta=this.config.meta,this.doneData=this.type==="final"?this.config.data:void 0,this.invoke=fe(this.config.invoke).map(function(a,u){var f,d;if(xe(a)){var h=It(s.id,u);return s.machine.options.services=S((f={},f[h]=a,f),s.machine.options.services),Pt({src:h,id:h})}else if(G(a.src)){var h=a.id||It(s.id,u);return Pt(S(S({},a),{id:h,src:a.src}))}else if(xe(a.src)||B(a.src)){var h=a.id||It(s.id,u);return s.machine.options.services=S((d={},d[h]=a.src,d),s.machine.options.services),Pt(S(S({id:h},a),{src:h}))}else{var p=a.src;return Pt(S(S({id:It(s.id,u)},a),{src:p}))}}),this.activities=fe(this.config.activities).concat(this.invoke).map(function(a){return _t(a)}),this.transition=this.transition.bind(this),this.tags=fe(this.config.tags)}return t.prototype._init=function(){this.__cache.transitions||On(this).forEach(function(e){return e.on})},t.prototype.withConfig=function(e,r){var n=this.options,i=n.actions,s=n.activities,o=n.guards,l=n.services,c=n.delays;return new t(this.config,{actions:S(S({},i),e.actions),activities:S(S({},s),e.activities),guards:S(S({},o),e.guards),services:S(S({},l),e.services),delays:S(S({},c),e.delays)},r!=null?r:this.context)},t.prototype.withContext=function(e){return new t(this.config,this.options,e)},Object.defineProperty(t.prototype,"context",{get:function(){return B(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:rt(this.states,function(e){return e.definition}),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return this.definition},Object.defineProperty(t.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce(function(r,n){return r[n.eventType]=r[n.eventType]||[],r[n.eventType].push(n),r},{})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),t.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var r=e===Ge,n=this.transitions.filter(function(i){var s=i.eventType===e;return r?s:s||i.eventType===dt});return this.__cache.candidates[e]=n,n},t.prototype.getDelayedTransitions=function(){var e=this,r=this.config.after;if(!r)return[];var n=function(s,o){var l=B(s)?"".concat(e.id,":delay[").concat(o,"]"):s,c=Sn(l,e.id);return e.onEntry.push(Re(c,{delay:s})),e.onExit.push(mn(c)),c},i=Me(r)?r.map(function(s,o){var l=n(s.delay,o);return S(S({},s),{event:l})}):X(Object.keys(r).map(function(s,o){var l=r[s],c=G(l)?{target:l}:l,a=isNaN(+s)?s:+s,u=n(a,o);return fe(c).map(function(f){return S(S({},f),{event:u,delay:a})})}));return i.map(function(s){var o=s.delay;return S(S({},e.formatTransition(s)),{delay:o})})},t.prototype.getStateNodes=function(e){var r,n=this;if(!e)return[];var i=e instanceof pe?e.value:tt(e,this.delimiter);if(G(i)){var s=this.getStateNode(i).initial;return s!==void 0?this.getStateNodes((r={},r[i]=s,r)):[this,this.states[i]]}var o=Object.keys(i),l=[this];return l.push.apply(l,z([],V(X(o.map(function(c){return n.getStateNode(c).getStateNodes(i[c])}))),!1)),l},t.prototype.handles=function(e){var r=rn(e);return this.events.includes(r)},t.prototype.resolveState=function(e){var r=e instanceof pe?e:pe.create(e),n=Array.from(ct([],this.getStateNodes(r.value)));return new pe(S(S({},r),{value:this.resolve(r.value),configuration:n,done:Dt(n,this),tags:An(n),machine:this.machine}))},t.prototype.transitionLeafNode=function(e,r,n){var i=this.getStateNode(e),s=i.next(r,n);return!s||!s.transitions.length?this.next(r,n):s},t.prototype.transitionCompoundNode=function(e,r,n){var i=Object.keys(e),s=this.getStateNode(i[0]),o=s._transition(e[i[0]],r,n);return!o||!o.transitions.length?this.next(r,n):o},t.prototype.transitionParallelNode=function(e,r,n){var i,s,o={};try{for(var l=F(Object.keys(e)),c=l.next();!c.done;c=l.next()){var a=c.value,u=e[a];if(u){var f=this.getStateNode(a),d=f._transition(u,r,n);d&&(o[a]=d)}}}catch(g){i={error:g}}finally{try{c&&!c.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}var h=Object.keys(o).map(function(g){return o[g]}),p=X(h.map(function(g){return g.transitions})),v=h.some(function(g){return g.transitions.length>0});if(!v)return this.next(r,n);var E=X(Object.keys(o).map(function(g){return o[g].configuration}));return{transitions:p,exitSet:X(h.map(function(g){return g.exitSet})),configuration:E,source:r,actions:X(Object.keys(o).map(function(g){return o[g].actions}))}},t.prototype._transition=function(e,r,n){return G(e)?this.transitionLeafNode(e,r,n):Object.keys(e).length===1?this.transitionCompoundNode(e,r,n):this.transitionParallelNode(e,r,n)},t.prototype.getTransitionData=function(e,r){return this._transition(e.value,e,ae(r))},t.prototype.next=function(e,r){var n,i,s=this,o=r.name,l=[],c=[],a;try{for(var u=F(this.getCandidates(o)),f=u.next();!f.done;f=u.next()){var d=f.value,h=d.cond,p=d.in,v=e.context,E=p?G(p)&&Ke(p)?e.matches(tt(this.getStateNodeById(p).path,this.delimiter)):ir(tt(p,this.delimiter),ss(this.path.slice(0,-2))(e.value)):!0,g=!1;try{g=!h||ln(this.machine,h,v,r,e)}catch(k){throw new Error("Unable to evaluate guard '".concat(h.name||h.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,`':
`).concat(k.message))}if(g&&E){d.target!==void 0&&(c=d.target),l.push.apply(l,z([],V(d.actions),!1)),a=d;break}}}catch(k){n={error:k}}finally{try{f&&!f.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}if(a){if(!c.length)return{transitions:[a],exitSet:[],configuration:e.value?[this]:[],source:e,actions:l};var x=X(c.map(function(k){return s.getRelativeStateNodes(k,e.historyValue)})),O=!!a.internal;return{transitions:[a],exitSet:O?[]:X(c.map(function(k){return s.getPotentiallyReenteringNodes(k)})),configuration:x,source:e,actions:l}}},t.prototype.getPotentiallyReenteringNodes=function(e){if(this.order<e.order)return[this];for(var r=[],n=this,i=e;n&&n!==i;)r.push(n),n=n.parent;return n!==i?[]:(r.push(i),r)},t.prototype.getActions=function(e,r,n,i,s,o,l){var c,a,u,f,d=this,h=o?ct([],this.getStateNodes(o.value)):[],p=new Set;try{for(var v=F(Array.from(e).sort(function(D,$){return D.order-$.order})),E=v.next();!E.done;E=v.next()){var g=E.value;(!ut(h,g)||ut(n.exitSet,g)||g.parent&&p.has(g.parent))&&p.add(g)}}catch(D){c={error:D}}finally{try{E&&!E.done&&(a=v.return)&&a.call(v)}finally{if(c)throw c.error}}try{for(var x=F(h),O=x.next();!O.done;O=x.next()){var g=O.value;(!ut(e,g)||ut(n.exitSet,g.parent))&&n.exitSet.push(g)}}catch(D){u={error:D}}finally{try{O&&!O.done&&(f=x.return)&&f.call(x)}finally{if(u)throw u.error}}n.exitSet.sort(function(D,$){return $.order-D.order});var k=Array.from(p).sort(function(D,$){return D.order-$.order}),C=new Set(n.exitSet),b=X(k.map(function(D){var $=[];if(D.type!=="final")return $;var re=D.parent;if(!re.parent)return $;$.push(it(D.id,D.doneData),it(re.id,D.doneData?kt(D.doneData,i,s):void 0));var W=re.parent;return W.type==="parallel"&&at(W).every(function(Ce){return Dt(n.configuration,Ce)})&&$.push(it(W.id)),$})),_=k.map(function(D){var $=D.onEntry,re=D.activities.map(function(W){return yn(W)});return{type:"entry",actions:Oe(l?z(z([],V($),!1),V(re),!1):z(z([],V(re),!1),V($),!1),d.machine.options.actions)}}).concat({type:"state_done",actions:b.map(function(D){return hn(D)})}),M=Array.from(C).map(function(D){return{type:"exit",actions:Oe(z(z([],V(D.onExit),!1),V(D.activities.map(function($){return gn($)})),!1),d.machine.options.actions)}}),j=M.concat({type:"transition",actions:Oe(n.actions,this.machine.options.actions)}).concat(_);if(r){var Z=Oe(X(z([],V(e),!1).sort(function(D,$){return $.order-D.order}).map(function(D){return D.onExit})),this.machine.options.actions).filter(function(D){return!or(D)});return j.concat({type:"stop",actions:Z})}return j},t.prototype.transition=function(e,r,n,i){e===void 0&&(e=this.initialState);var s=ae(r),o;if(e instanceof pe)o=n===void 0?e:this.resolveState(pe.from(e,n));else{var l=G(e)?this.resolve(xt(this.getResolvedPath(e))):this.resolve(e),c=n!=null?n:this.machine.context;o=this.resolveState(pe.from(l,c))}if(!Q&&s.name===dt)throw new Error("An event cannot have the wildcard type ('".concat(dt,"')"));if(this.strict&&!this.events.includes(s.name)&&!as(s.name))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(s.name,"'"));var a=this._transition(o.value,o,s)||{transitions:[],configuration:[],exitSet:[],source:o,actions:[]},u=ct([],this.getStateNodes(o.value)),f=a.configuration.length?ct(u,a.configuration):u;return a.configuration=z([],V(f),!1),this.resolveTransition(a,o,o.context,i,s)},t.prototype.resolveRaisedTransition=function(e,r,n,i){var s,o=e.actions;return e=this.transition(e,r,void 0,i),e._event=n,e.event=n.data,(s=e.actions).unshift.apply(s,z([],V(o),!1)),e},t.prototype.resolveTransition=function(e,r,n,i,s){var o,l,c,a,u=this;s===void 0&&(s=Ne);var f=e.configuration,d=!r||e.transitions.length>0,h=d?e.configuration:r?r.configuration:[],p=Dt(h,this),v=d?Ps(this.machine,f):void 0,E=r?r.historyValue?r.historyValue:e.source?this.machine.historyValue(r.value):void 0:void 0,g=this.getActions(new Set(h),p,e,n,s,r,i),x=r?S({},r.activities):{};try{for(var O=F(g),k=O.next();!k.done;k=O.next()){var C=k.value;try{for(var b=(c=void 0,F(C.actions)),_=b.next();!_.done;_=b.next()){var M=_.value;M.type===mt?x[M.activity.id||M.activity.type]=M:M.type===yt&&(x[M.activity.id||M.activity.type]=!1)}}catch(he){c={error:he}}finally{try{_&&!_.done&&(a=b.return)&&a.call(b)}finally{if(c)throw c.error}}}}catch(he){o={error:he}}finally{try{k&&!k.done&&(l=O.return)&&l.call(O)}finally{if(o)throw o.error}}var j=V(ot(this,r,n,s,g,i,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),Z=j[0],D=j[1],$=V(us(Z,or),2),re=$[0],W=$[1],Ce=Z.filter(function(he){var ne;return he.type===mt&&((ne=he.activity)===null||ne===void 0?void 0:ne.type)===Tt}),Le=Ce.reduce(function(he,ne){return he[ne.activity.id]=_s(ne.activity,u.machine,D,s),he},r?S({},r.children):{}),m=new pe({value:v||r.value,context:D,_event:s,_sessionid:r?r._sessionid:null,historyValue:v?E?ls(E,v):void 0:r?r.historyValue:void 0,history:!v||e.source?r:void 0,actions:v?W:[],activities:v?x:r?r.activities:{},events:[],configuration:h,transitions:e.transitions,children:Le,done:p,tags:An(h),machine:this}),w=n!==D;m.changed=s.name===St||w;var N=m.history;N&&delete N.history;var q=!p&&(this._transient||f.some(function(he){return he._transient}));if(!d&&(!q||s.name===Ge))return m;var H=m;if(!p)for(q&&(H=this.resolveRaisedTransition(H,{type:Wr},s,i));re.length;){var K=re.shift();H=this.resolveRaisedTransition(H,K._event,s,i)}var Xe=H.changed||(N?!!H.actions.length||w||typeof N.value!=typeof H.value||!In(H.value,N.value):void 0);return H.changed=Xe,H.history=N,H},t.prototype.getStateNode=function(e){if(Ke(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var r=this.states[e];if(!r)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return r},t.prototype.getStateNodeById=function(e){var r=Ke(e)?e.slice(fr.length):e;if(r===this.id)return this;var n=this.machine.idMap[r];if(!n)throw new Error("Child state node '#".concat(r,"' does not exist on machine '").concat(this.id,"'"));return n},t.prototype.getStateNodeByPath=function(e){if(typeof e=="string"&&Ke(e))try{return this.getStateNodeById(e.slice(1))}catch{}for(var r=sr(e,this.delimiter).slice(),n=this;r.length;){var i=r.shift();if(!i.length)break;n=n.getStateNode(i)}return n},t.prototype.resolve=function(e){var r,n=this;if(!e)return this.initialStateValue||He;switch(this.type){case"parallel":return rt(this.initialStateValue,function(s,o){return s?n.getStateNode(o).resolve(e[o]||s):He});case"compound":if(G(e)){var i=this.getStateNode(e);return i.type==="parallel"||i.type==="compound"?(r={},r[e]=i.initialStateValue,r):e}return Object.keys(e).length?rt(e,function(s,o){return s?n.getStateNode(o).resolve(s):He}):this.initialStateValue||{};default:return e||He}},t.prototype.getResolvedPath=function(e){if(Ke(e)){var r=this.machine.idMap[e.slice(fr.length)];if(!r)throw new Error("Unable to find state node '".concat(e,"'"));return r.path}return sr(e,this.delimiter)},Object.defineProperty(t.prototype,"initialStateValue",{get:function(){var e;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;var r;if(this.type==="parallel")r=nn(this.states,function(n){return n.initialStateValue||He},function(n){return n.type!=="history"});else if(this.initial!==void 0){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));r=Rt(this.states[this.initial])?this.initial:(e={},e[this.initial]=this.states[this.initial].initialStateValue,e)}else r={};return this.__cache.initialStateValue=r,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),t.prototype.getInitialState=function(e,r){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,r!=null?r:this.machine.context,void 0)},Object.defineProperty(t.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){var e;if(this.type==="history"){var r=this.config;G(r.target)?e=Ke(r.target)?xt(this.machine.getStateNodeById(r.target).path.slice(this.path.length-1)):r.target:e=r.target}return e},enumerable:!1,configurable:!0}),t.prototype.getRelativeStateNodes=function(e,r,n){return n===void 0&&(n=!0),n?e.type==="history"?e.resolveHistory(r):e.initialStateNodes:[e]},Object.defineProperty(t.prototype,"initialStateNodes",{get:function(){var e=this;if(Rt(this))return[this];if(this.type==="compound"&&!this.initial)return Q||ie(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this];var r=Ot(this.initialStateValue);return X(r.map(function(n){return e.getFromRelativePath(n)}))},enumerable:!1,configurable:!0}),t.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var r=V(e),n=r[0],i=r.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var s=this.getStateNode(n);if(s.type==="history")return s.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(i)},t.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:nn(this.states,function(r,n){if(!e)return r.historyValue();var i=G(e)?void 0:e[n];return r.historyValue(i||r.initialStateValue)},function(r){return!r.history})}},t.prototype.resolveHistory=function(e){var r=this;if(this.type!=="history")return[this];var n=this.parent;if(!e){var i=this.target;return i?X(Ot(i).map(function(o){return n.getFromRelativePath(o)})):n.initialStateNodes}var s=os(n.path,"states")(e).current;return G(s)?[n.getStateNode(s)]:X(Ot(s).map(function(o){return r.history==="deep"?n.getFromRelativePath(o):[n.states[o[0]]]}))},Object.defineProperty(t.prototype,"stateIds",{get:function(){var e=this,r=X(Object.keys(this.states).map(function(n){return e.states[n].stateIds}));return[this.id].concat(r)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var e,r,n,i;if(this.__cache.events)return this.__cache.events;var s=this.states,o=new Set(this.ownEvents);if(s)try{for(var l=F(Object.keys(s)),c=l.next();!c.done;c=l.next()){var a=c.value,u=s[a];if(u.states)try{for(var f=(n=void 0,F(u.events)),d=f.next();!d.done;d=f.next()){var h=d.value;o.add("".concat(h))}}catch(p){n={error:p}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}}}catch(p){e={error:p}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter(function(r){return!(!r.target&&!r.actions.length&&r.internal)}).map(function(r){return r.eventType}));return Array.from(e)},enumerable:!1,configurable:!0}),t.prototype.resolveTarget=function(e){var r=this;if(e!==void 0)return e.map(function(n){if(!G(n))return n;var i=n[0]===r.delimiter;if(i&&!r.parent)return r.getStateNodeByPath(n.slice(1));var s=i?r.key+n:n;if(r.parent)try{var o=r.parent.getStateNodeByPath(s);return o}catch(l){throw new Error("Invalid transition definition for state node '".concat(r.id,`':
`).concat(l.message))}else return r.getStateNodeByPath(s)})},t.prototype.formatTransition=function(e){var r=this,n=ps(e.target),i="internal"in e?e.internal:n?n.some(function(c){return G(c)&&c[0]===r.delimiter}):!0,s=this.machine.options.guards,o=this.resolveTarget(n),l=S(S({},e),{actions:Oe(fe(e.actions)),cond:un(e.cond,s),target:o,source:this,internal:i,eventType:e.event,toJSON:function(){return S(S({},l),{target:l.target?l.target.map(function(c){return"#".concat(c.id)}):void 0,source:"#".concat(r.id)})}});return l},t.prototype.formatTransitions=function(){var e,r,n=this,i;if(!this.config.on)i=[];else if(Array.isArray(this.config.on))i=this.config.on;else{var s=this.config.on,o=dt,l=s[o],c=l===void 0?[]:l,a=Zt(s,[typeof o=="symbol"?o:o+""]);i=X(Object.keys(a).map(function(x){!Q&&x===Ge&&ie(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(n.id,'".'));var O=je(x,a[x]);return Q||zs(n,x,O),O}).concat(je(dt,c)))}var u=this.config.always?je("",this.config.always):[],f=this.config.onDone?je(String(it(this.id)),this.config.onDone):[];Q||ie(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var d=X(this.invoke.map(function(x){var O=[];return x.onDone&&O.push.apply(O,z([],V(je(String(st(x.id)),x.onDone)),!1)),x.onError&&O.push.apply(O,z([],V(je(String(Ve(x.id)),x.onError)),!1)),O})),h=this.after,p=X(z(z(z(z([],V(f),!1),V(d),!1),V(i),!1),V(u),!1).map(function(x){return fe(x).map(function(O){return n.formatTransition(O)})}));try{for(var v=F(h),E=v.next();!E.done;E=v.next()){var g=E.value;p.push(g)}}catch(x){e={error:x}}finally{try{E&&!E.done&&(r=v.return)&&r.call(v)}finally{if(e)throw e.error}}return p},t}(),_n=!1;function be(t,e){return!Q&&!("predictableActionArguments"in t)&&!_n&&(_n=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new Js(t,e)}var L=Tn,se=Re;/*! js-cookie v3.0.5 | MIT */function Ct(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}var Ws={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function pr(t,e){function r(i,s,o){if(typeof document!="undefined"){o=Ct({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var l="";for(var c in o)o[c]&&(l+="; "+c,o[c]!==!0&&(l+="="+o[c].split(";")[0]));return document.cookie=i+"="+t.write(s,i)+l}}function n(i){if(!(typeof document=="undefined"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],o={},l=0;l<s.length;l++){var c=s[l].split("="),a=c.slice(1).join("=");try{var u=decodeURIComponent(c[0]);if(o[u]=t.read(a,u),i===u)break}catch{}}return i?o[i]:o}}return Object.create({set:r,get:n,remove:function(i,s){r(i,"",Ct({},s,{expires:-1}))},withAttributes:function(i){return pr(this.converter,Ct({},this.attributes,i))},withConverter:function(i){return pr(Ct({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var vr=pr(Ws,{path:"/"}),mr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function yr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Qs(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var gr={exports:{}};(function(t,e){(function(r){function n(i){var s=i&&i.Promise||r.Promise,o=i&&i.XMLHttpRequest||r.XMLHttpRequest;return function(){var l=Object.create(r,{fetch:{value:void 0,writable:!0}});return function(c,a){a(e)}(this,function(c){var a=typeof l!="undefined"&&l||typeof self!="undefined"&&self||typeof a!="undefined"&&a,u={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function f(m){return m&&DataView.prototype.isPrototypeOf(m)}if(u.arrayBuffer)var d=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],h=ArrayBuffer.isView||function(m){return m&&d.indexOf(Object.prototype.toString.call(m))>-1};function p(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(m)||m==="")throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function v(m){return typeof m!="string"&&(m=String(m)),m}function E(m){var w={next:function(){var N=m.shift();return{done:N===void 0,value:N}}};return u.iterable&&(w[Symbol.iterator]=function(){return w}),w}function g(m){this.map={},m instanceof g?m.forEach(function(w,N){this.append(N,w)},this):Array.isArray(m)?m.forEach(function(w){this.append(w[0],w[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(w){this.append(w,m[w])},this)}g.prototype.append=function(m,w){m=p(m),w=v(w);var N=this.map[m];this.map[m]=N?N+", "+w:w},g.prototype.delete=function(m){delete this.map[p(m)]},g.prototype.get=function(m){return m=p(m),this.has(m)?this.map[m]:null},g.prototype.has=function(m){return this.map.hasOwnProperty(p(m))},g.prototype.set=function(m,w){this.map[p(m)]=v(w)},g.prototype.forEach=function(m,w){for(var N in this.map)this.map.hasOwnProperty(N)&&m.call(w,this.map[N],N,this)},g.prototype.keys=function(){var m=[];return this.forEach(function(w,N){m.push(N)}),E(m)},g.prototype.values=function(){var m=[];return this.forEach(function(w){m.push(w)}),E(m)},g.prototype.entries=function(){var m=[];return this.forEach(function(w,N){m.push([N,w])}),E(m)},u.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function x(m){if(m.bodyUsed)return s.reject(new TypeError("Already read"));m.bodyUsed=!0}function O(m){return new s(function(w,N){m.onload=function(){w(m.result)},m.onerror=function(){N(m.error)}})}function k(m){var w=new FileReader,N=O(w);return w.readAsArrayBuffer(m),N}function C(m){var w=new FileReader,N=O(w);return w.readAsText(m),N}function b(m){for(var w=new Uint8Array(m),N=new Array(w.length),q=0;q<w.length;q++)N[q]=String.fromCharCode(w[q]);return N.join("")}function _(m){if(m.slice)return m.slice(0);var w=new Uint8Array(m.byteLength);return w.set(new Uint8Array(m)),w.buffer}function M(){return this.bodyUsed=!1,this._initBody=function(m){this.bodyUsed=this.bodyUsed,this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:u.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:u.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:u.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():u.arrayBuffer&&u.blob&&f(m)?(this._bodyArrayBuffer=_(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):u.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||h(m))?this._bodyArrayBuffer=_(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):u.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u.blob&&(this.blob=function(){var m=x(this);if(m)return m;if(this._bodyBlob)return s.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return s.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var m=x(this);return m||(ArrayBuffer.isView(this._bodyArrayBuffer)?s.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):s.resolve(this._bodyArrayBuffer))}else return this.blob().then(k)}),this.text=function(){var m=x(this);if(m)return m;if(this._bodyBlob)return C(this._bodyBlob);if(this._bodyArrayBuffer)return s.resolve(b(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return s.resolve(this._bodyText)},u.formData&&(this.formData=function(){return this.text().then($)}),this.json=function(){return this.text().then(JSON.parse)},this}var j=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Z(m){var w=m.toUpperCase();return j.indexOf(w)>-1?w:m}function D(m,w){if(!(this instanceof D))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');w=w||{};var N=w.body;if(m instanceof D){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,w.headers||(this.headers=new g(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!N&&m._bodyInit!=null&&(N=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=w.credentials||this.credentials||"same-origin",(w.headers||!this.headers)&&(this.headers=new g(w.headers)),this.method=Z(w.method||this.method||"GET"),this.mode=w.mode||this.mode||null,this.signal=w.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&N)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(N),(this.method==="GET"||this.method==="HEAD")&&(w.cache==="no-store"||w.cache==="no-cache")){var q=/([?&])_=[^&]*/;if(q.test(this.url))this.url=this.url.replace(q,"$1_="+new Date().getTime());else{var H=/\?/;this.url+=(H.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function $(m){var w=new FormData;return m.trim().split("&").forEach(function(N){if(N){var q=N.split("="),H=q.shift().replace(/\+/g," "),K=q.join("=").replace(/\+/g," ");w.append(decodeURIComponent(H),decodeURIComponent(K))}}),w}function re(m){var w=new g,N=m.replace(/\r?\n[\t ]+/g," ");return N.split("\r").map(function(q){return q.indexOf(`
`)===0?q.substr(1,q.length):q}).forEach(function(q){var H=q.split(":"),K=H.shift().trim();if(K){var Xe=H.join(":").trim();w.append(K,Xe)}}),w}M.call(D.prototype);function W(m,w){if(!(this instanceof W))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');w||(w={}),this.type="default",this.status=w.status===void 0?200:w.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in w?w.statusText:"",this.headers=new g(w.headers),this.url=w.url||"",this._initBody(m)}M.call(W.prototype),W.prototype.clone=function(){return new W(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},W.error=function(){var m=new W(null,{status:0,statusText:""});return m.type="error",m};var Ce=[301,302,303,307,308];W.redirect=function(m,w){if(Ce.indexOf(w)===-1)throw new RangeError("Invalid status code");return new W(null,{status:w,headers:{location:m}})},c.DOMException=a.DOMException;try{new c.DOMException}catch{c.DOMException=function(w,N){this.message=w,this.name=N;var q=Error(w);this.stack=q.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function Le(m,w){return new s(function(N,q){var H=new D(m,w);if(H.signal&&H.signal.aborted)return q(new c.DOMException("Aborted","AbortError"));var K=new o;function Xe(){K.abort()}K.onload=function(){var ne={status:K.status,statusText:K.statusText,headers:re(K.getAllResponseHeaders()||"")};ne.url="responseURL"in K?K.responseURL:ne.headers.get("X-Request-URL");var Qt="response"in K?K.response:K.responseText;setTimeout(function(){N(new W(Qt,ne))},0)},K.onerror=function(){setTimeout(function(){q(new TypeError("Network request failed"))},0)},K.ontimeout=function(){setTimeout(function(){q(new TypeError("Network request failed"))},0)},K.onabort=function(){setTimeout(function(){q(new c.DOMException("Aborted","AbortError"))},0)};function he(ne){try{return ne===""&&a.location.href?a.location.href:ne}catch{return ne}}K.open(H.method,he(H.url),!0),H.credentials==="include"?K.withCredentials=!0:H.credentials==="omit"&&(K.withCredentials=!1),"responseType"in K&&(u.blob?K.responseType="blob":u.arrayBuffer&&H.headers.get("Content-Type")&&H.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(K.responseType="arraybuffer")),w&&typeof w.headers=="object"&&!(w.headers instanceof g)?Object.getOwnPropertyNames(w.headers).forEach(function(ne){K.setRequestHeader(ne,v(w.headers[ne]))}):H.headers.forEach(function(ne,Qt){K.setRequestHeader(Qt,ne)}),H.signal&&(H.signal.addEventListener("abort",Xe),K.onreadystatechange=function(){K.readyState===4&&H.signal.removeEventListener("abort",Xe)}),K.send(typeof H._bodyInit=="undefined"?null:H._bodyInit)})}Le.polyfill=!0,a.fetch||(a.fetch=Le,a.Headers=g,a.Request=D,a.Response=W),c.Headers=g,c.Request=D,c.Response=W,c.fetch=Le,Object.defineProperty(c,"__esModule",{value:!0})}),{fetch:l.fetch,Headers:l.Headers,Request:l.Request,Response:l.Response,DOMException:l.DOMException}}()}t.exports=n})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:mr)})(gr,gr.exports);var Xs=gr.exports;const Er=yr(Xs);var Zs=Object.defineProperty,eo=(t,e,r)=>e in t?Zs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ve=(t,e,r)=>eo(t,typeof e!="symbol"?e+"":e,r);const Ye="nhostRefreshToken",Lt="nhostRefreshTokenId",$e="nhostRefreshTokenExpiresAt",to=3,Nn=60,Rn=5,Dn=0,Pn=1,Ee=10,Ut=20;let qe=class extends Error{constructor(e){super(e.message),ve(this,"error"),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),e instanceof Error?(this.name=e.name,this.error={error:e.name,status:Pn,message:e.message}):(this.name=e.error,this.error=e)}};const Te={status:Ee,error:"invalid-email",message:"Email is incorrectly formatted"},ro={status:Ee,error:"invalid-mfa-type",message:"MFA type is invalid"},no={status:Ee,error:"invalid-mfa-code",message:"MFA code is invalid"},Tr={status:Ee,error:"invalid-password",message:"Password is incorrectly formatted"},Cn={status:Ee,error:"invalid-phone-number",message:"Phone number is incorrectly formatted"},io={status:Ee,error:"invalid-mfa-ticket",message:"MFA ticket is invalid"},so={status:Ee,error:"no-mfa-ticket",message:"No MFA ticket has been provided"},oo={status:Ee,error:"no-refresh-token",message:"No refresh token has been provided"},ao={status:Ut,error:"refresher-already-running",message:"The token refresher is already running. You must wait until is has finished before submitting a new token."},ue={status:Ut,error:"already-signed-in",message:"User is already signed in"},co={status:Ut,error:"unauthenticated-user",message:"User is not authenticated"},uo={status:Ut,error:"unverified-user",message:"Email needs verification"},lo={status:Ee,error:"invalid-refresh-token",message:"Invalid or expired refresh token"},ho={status:Pn,error:"invalid-sign-in-method",message:"Invalid sign-in method"},Sr={user:null,mfa:null,accessToken:{value:null,expiresAt:null,expiresInSeconds:15},refreshTimer:{startedAt:null,attempts:0,lastAttempt:null},refreshToken:{value:null},importTokenAttempts:0,errors:{}};function fo(t){return new TextEncoder().encode(t)}function ke(t){const e=new Uint8Array(t);let r="";for(const n of e)r+=String.fromCharCode(n);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function wr(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4,n=e.padEnd(e.length+r,"="),i=atob(n),s=new ArrayBuffer(i.length),o=new Uint8Array(s);for(let l=0;l<i.length;l++)o[l]=i.charCodeAt(l);return s}function Ln(){return(window==null?void 0:window.PublicKeyCredential)!==void 0&&typeof window.PublicKeyCredential=="function"}function Un(t){const{id:e}=t;return{...t,id:wr(e),transports:t.transports}}function Mn(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}let ce=class extends Error{constructor({message:e,code:r,cause:n,name:i}){super(e,{cause:n}),this.name=i!=null?i:n.name,this.code=r}};function po({error:t,options:e}){var r,n;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ce({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=i.authenticatorSelection)==null?void 0:r.requireResidentKey)===!0)return new ce({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(((n=i.authenticatorSelection)==null?void 0:n.userVerification)==="required")return new ce({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new ce({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new ce({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return i.pubKeyCredParams.filter(s=>s.type==="public-key").length===0?new ce({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new ce({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Mn(s)){if(i.rp.id!==s)return new ce({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ce({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new ce({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new ce({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return t}class vo{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const jn=new vo,mo=["cross-platform","platform"];function Fn(t){if(t&&!(mo.indexOf(t)<0))return t}async function Vn(t){var e;if(!Ln())throw new Error("WebAuthn is not supported in this browser");const r={publicKey:{...t,challenge:wr(t.challenge),user:{...t.user,id:fo(t.user.id)},excludeCredentials:(e=t.excludeCredentials)==null?void 0:e.map(Un)}};r.signal=jn.createNewAbortSignal();let n;try{n=await navigator.credentials.create(r)}catch(d){throw po({error:d,options:r})}if(!n)throw new Error("Registration was not completed");const{id:i,rawId:s,response:o,type:l}=n;let c;typeof o.getTransports=="function"&&(c=o.getTransports());let a;if(typeof o.getPublicKeyAlgorithm=="function")try{a=o.getPublicKeyAlgorithm()}catch(d){xr("getPublicKeyAlgorithm()",d)}let u;if(typeof o.getPublicKey=="function")try{const d=o.getPublicKey();d!==null&&(u=ke(d))}catch(d){xr("getPublicKey()",d)}let f;if(typeof o.getAuthenticatorData=="function")try{f=ke(o.getAuthenticatorData())}catch(d){xr("getAuthenticatorData()",d)}return{id:i,rawId:ke(s),response:{attestationObject:ke(o.attestationObject),clientDataJSON:ke(o.clientDataJSON),transports:c,publicKeyAlgorithm:a,publicKey:u,authenticatorData:f},type:l,clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:Fn(n.authenticatorAttachment)}}function xr(t,e){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${t}. You should report this error to them.
`,e)}function yo(t){return new TextDecoder("utf-8").decode(t)}function go(){const t=window.PublicKeyCredential;return t.isConditionalMediationAvailable===void 0?new Promise(e=>e(!1)):t.isConditionalMediationAvailable()}function Eo({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ce({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new ce({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(Mn(n)){if(r.rpId!==n)return new ce({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ce({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new ce({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return t}async function Or(t,e=!1){var r,n;if(!Ln())throw new Error("WebAuthn is not supported in this browser");let i;((r=t.allowCredentials)==null?void 0:r.length)!==0&&(i=(n=t.allowCredentials)==null?void 0:n.map(Un));const s={...t,challenge:wr(t.challenge),allowCredentials:i},o={};if(e){if(!await go())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');o.mediation="conditional",s.allowCredentials=[]}o.publicKey=s,o.signal=jn.createNewAbortSignal();let l;try{l=await navigator.credentials.get(o)}catch(h){throw Eo({error:h,options:o})}if(!l)throw new Error("Authentication was not completed");const{id:c,rawId:a,response:u,type:f}=l;let d;return u.userHandle&&(d=yo(u.userHandle)),{id:c,rawId:ke(a),response:{authenticatorData:ke(u.authenticatorData),clientDataJSON:ke(u.clientDataJSON),signature:ke(u.signature),userHandle:d},type:f,clientExtensionResults:l.getClientExtensionResults(),authenticatorAttachment:Fn(l.authenticatorAttachment)}}const Mt=typeof window!="undefined",jt=new Map,To=t=>{var e;return Mt&&typeof localStorage!="undefined"?localStorage.getItem(t):(e=jt.get(t))!=null?e:null},So=(t,e)=>{Mt&&typeof localStorage!="undefined"?e?localStorage.setItem(t,e):localStorage.removeItem(t):e?jt.set(t,e):jt.has(t)&&jt.delete(t)},wo=(t,e)=>{if(t==="localStorage"||t==="web")return To;if(t==="cookie")return r=>{var n;return Mt&&(n=vr.get(r))!=null?n:null};if(!e)throw Error(`clientStorageType is set to '${t}' but no clientStorage has been given`);if(t==="react-native")return r=>{var n;return(n=e.getItem)==null?void 0:n.call(e,r)};if(t==="capacitor")return r=>{var n;return(n=e.get)==null?void 0:n.call(e,{key:r})};if(t==="expo-secure-storage")return r=>{var n;return(n=e.getItemAsync)==null?void 0:n.call(e,r)};if(t==="custom"){if(e.getItem&&e.removeItem)return e.getItem;if(e.getItemAsync)return e.getItemAsync;throw Error(`clientStorageType is set to 'custom' but clientStorage is missing either "getItem" and "removeItem" properties or "getItemAsync" property`)}throw Error(`Unknown storage type: ${t}`)},xo=(t,e)=>{if(t==="localStorage"||t==="web")return So;if(t==="cookie")return(r,n)=>{Mt&&(n?vr.set(r,n,{expires:30,sameSite:"lax",httpOnly:!1}):vr.remove(r))};if(!e)throw Error(`clientStorageType is set to '${t}' but no clienStorage has been given`);if(t==="react-native")return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(t==="capacitor")return(r,n)=>{var i,s;return n?(i=e.set)==null?void 0:i.call(e,{key:r,value:n}):(s=e.remove)==null?void 0:s.call(e,{key:r})};if(t==="expo-secure-storage")return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.deleteItemAsync)==null?void 0:s.call(e,r)};if(t==="custom"){if(!e.removeItem)throw Error("clientStorageType is set to 'custom' but clientStorage is missing a removeItem property");if(e.setItem)return(r,n)=>{var i,s;return n?(i=e.setItem)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};if(e.setItemAsync)return async(r,n)=>{var i,s;return n?(i=e.setItemAsync)==null?void 0:i.call(e,r,n):(s=e.removeItem)==null?void 0:s.call(e,r)};throw Error("clientStorageType is set to 'custom' but clientStorage is missing setItem or setItemAsync property")}throw Error(`Unknown storage type: ${t}`)},Ft=t=>!t||!t.accessToken.value||!t.accessToken.expiresAt||!t.user?null:{accessToken:t.accessToken.value,accessTokenExpiresIn:(t.accessToken.expiresAt.getTime()-Date.now())/1e3,refreshToken:t.refreshToken.value,user:t.user},me=({accessToken:t,refreshToken:e,isError:r,user:n,error:i})=>r?{session:null,error:i}:n&&t?{session:{accessToken:t,accessTokenExpiresIn:0,refreshToken:e,user:n},error:null}:{session:null,error:null},Bn=()=>typeof window!="undefined"&&typeof window.location!="undefined";let Gn=globalThis.fetch;typeof EdgeRuntime!="string"&&(Gn=Er().fetch);const Hn=async(t,e,{token:r,body:n,extraHeaders:i}={})=>{const s={"Content-Type":"application/json",Accept:"*/*"};r&&(s.Authorization=`Bearer ${r}`);const o={...s,...i},l={method:e,headers:o};n&&(l.body=JSON.stringify(n));try{const c=await Gn(t,l);if(!c.ok){const a=await c.json();return Promise.reject({error:a})}try{return{data:await c.json(),error:null}}catch{return console.warn(`Unexpected response: can't parse the response of the server at ${t}`),{data:"OK",error:null}}}catch{const c={message:"Network Error",status:Dn,error:"network"};return Promise.reject({error:c})}},le=async(t,e,r,n)=>Hn(t,"POST",{token:r,body:e,extraHeaders:n}),Oo=(t,e)=>Hn(t,"GET",{token:e}),Vt=(t,e)=>{const r=e&&Object.entries(e).map(([n,i])=>{const s=Array.isArray(i)?i.join(","):typeof i=="object"?JSON.stringify(i):i;return`${n}=${encodeURIComponent(s)}`}).join("&");return r?`${t}?${r}`:t},de=(t,e)=>{if(!(e!=null&&e.redirectTo))return e;const{redirectTo:r,...n}=e;if(!t)return r.startsWith("/")?n:e;const i=new URL(t),s=Object.fromEntries(new URLSearchParams(i.search)),o=new URL(r.startsWith("/")?i.origin+r:r),l=new URLSearchParams(o.search);let c=Object.fromEntries(l);r.startsWith("/")&&(c={...s,...c});let a=i.pathname;return o.pathname.length>1&&(a+=o.pathname.slice(1)),{...n,redirectTo:Vt(o.origin+a,c)}};function Bt(t,e){var r;if(!e){if(typeof window=="undefined")return;e=((r=window.location)==null?void 0:r.href)||""}t=t.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&#]"+t+"(=([^&#]*)|&|#|$)"),i=n.exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function Kn(t){var e;if(typeof window=="undefined")return;const r=window==null?void 0:window.location;if(r&&r){const n=new URLSearchParams(r.search),i=new URLSearchParams((e=r.hash)==null?void 0:e.slice(1));n.delete(t),i.delete(t);let s=window.location.pathname;Array.from(n).length&&(s+=`?${n.toString()}`),Array.from(i).length&&(s+=`#${i.toString()}`),window.history.pushState({},"",s)}}const Se=t=>!!t&&typeof t=="string"&&!!String(t).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),kr=t=>!!t&&typeof t=="string"&&t.length>=to,Yn=t=>!!t&&typeof t=="string",ko=t=>t&&typeof t=="string"&&t.match(/^mfaTotp:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),Ao=({backendUrl:t,clientUrl:e,broadcastKey:r,clientStorageType:n="web",clientStorage:i,refreshIntervalTime:s,autoRefreshToken:o=!0,autoSignIn:l=!0})=>{const c=wo(n,i),a=xo(n,i),u=async(d,h,p,v)=>(await le(`${t}${d}`,h,p,v)).data;let f=null;if(typeof window!="undefined"&&r)try{f=new BroadcastChannel(r)}catch{}return be({schema:{context:{},events:{},services:{}},tsTypes:{},context:Sr,predictableActionArguments:!0,id:"nhost",type:"parallel",states:{authentication:{initial:"starting",on:{SESSION_UPDATE:[{cond:"hasSession",actions:["saveSession","resetTimer","reportTokenChanged"],target:".signedIn"}]},states:{starting:{tags:["loading"],always:{cond:"isSignedIn",target:"signedIn"},invoke:{id:"importRefreshToken",src:"importRefreshToken",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"signedIn"},{target:"signedOut"}],onError:[{cond:"shouldRetryImportToken",actions:"incrementTokenImportAttempts",target:"retryTokenImport"},{actions:["saveAuthenticationError"],target:"signedOut"}]}},retryTokenImport:{tags:["loading"],after:{RETRY_IMPORT_TOKEN_DELAY:"starting"}},signedOut:{initial:"noErrors",entry:"reportSignedOut",states:{noErrors:{},success:{},needsSmsOtp:{},needsMfa:{},failed:{},signingOut:{entry:["clearContextExceptTokens"],exit:["destroyAccessToken","destroyRefreshToken","reportTokenChanged"],invoke:{src:"signout",id:"signingOut",onDone:{target:"success"},onError:{target:"failed",actions:["saveAuthenticationError"]}}}},on:{SIGNIN_PASSWORD:"authenticating.password",SIGNIN_ANONYMOUS:"authenticating.anonymous",SIGNIN_SECURITY_KEY_EMAIL:"authenticating.securityKeyEmail",SIGNIN_SECURITY_KEY:"authenticating.securityKey",SIGNIN_MFA_TOTP:"authenticating.mfa.totp",SIGNIN_PAT:"authenticating.pat",SIGNIN_ID_TOKEN:"authenticating.idToken"}},authenticating:{entry:"resetErrors",states:{password:{invoke:{src:"signInPassword",id:"authenticateUserWithPassword",onDone:[{cond:"hasMfaTicket",actions:["saveMfaTicket"],target:"#nhost.authentication.signedOut.needsMfa"},{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"}],onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},pat:{invoke:{src:"signInPAT",id:"authenticateWithPAT",onDone:{actions:["savePATSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},idToken:{invoke:{src:"signInIdToken",id:"authenticateWithIdToken",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},anonymous:{invoke:{src:"signInAnonymous",id:"authenticateAnonymously",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}}},mfa:{states:{totp:{invoke:{src:"signInMfaTotp",id:"signInMfaTotp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:["saveAuthenticationError"],target:"#nhost.authentication.signedOut.failed"}}}}},securityKeyEmail:{invoke:{src:"signInSecurityKeyEmail",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}},securityKey:{invoke:{src:"signInSecurityKey",id:"authenticateUserWithSecurityKey",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:[{cond:"unverified",target:["#nhost.authentication.signedOut","#nhost.registration.incomplete.needsEmailVerification"]},{actions:"saveAuthenticationError",target:"#nhost.authentication.signedOut.failed"}]}}}},signedIn:{type:"parallel",entry:["reportSignedIn","cleanUrl","broadcastToken","resetErrors"],on:{SIGNOUT:"signedOut.signingOut"},states:{refreshTimer:{id:"timer",initial:"idle",states:{disabled:{type:"final"},stopped:{always:{cond:"noToken",target:"idle"}},idle:{always:[{cond:"isAutoRefreshDisabled",target:"disabled"},{cond:"isRefreshTokenPAT",target:"disabled"},{cond:"hasRefreshToken",target:"running"}]},running:{initial:"pending",entry:"resetTimer",states:{pending:{after:{1e3:{internal:!1,target:"pending"}},always:{cond:"refreshTimerShouldRefresh",target:"refreshing"}},refreshing:{invoke:{src:"refreshToken",id:"refreshToken",onDone:{actions:["saveSession","resetTimer","reportTokenChanged","broadcastToken"],target:"pending"},onError:[{cond:"isUnauthorizedError",target:"#nhost.authentication.signedOut"},{actions:"saveRefreshAttempt",target:"pending"}]}}}}}}}}}},token:{initial:"idle",states:{idle:{on:{TRY_TOKEN:"running"},initial:"noErrors",states:{noErrors:{},error:{}}},running:{invoke:{src:"refreshToken",id:"authenticateWithToken",onDone:{actions:["saveSession","reportTokenChanged","broadcastToken"],target:["#nhost.authentication.signedIn","idle.noErrors"]},onError:[{cond:"isSignedIn",target:"idle.error"},{actions:"saveAuthenticationError",target:["#nhost.authentication.signedOut.failed","idle.error"]}]}}}},registration:{initial:"incomplete",on:{SIGNED_IN:[{cond:"isAnonymous",target:".incomplete"},".complete"]},states:{incomplete:{on:{SIGNUP_EMAIL_PASSWORD:"emailPassword",SIGNUP_SECURITY_KEY:"securityKey",PASSWORDLESS_EMAIL:"passwordlessEmail",PASSWORDLESS_SMS:"passwordlessSms",PASSWORDLESS_SMS_OTP:"passwordlessSmsOtp",SIGNIN_EMAIL_OTP:"signInEmailOTP",VERIFY_EMAIL_OTP:"verifyEmailOTP"},initial:"noErrors",states:{noErrors:{},needsEmailVerification:{},needsOtp:{},failed:{}}},emailPassword:{entry:["resetErrors"],invoke:{src:"signUpEmailPassword",id:"signUpEmailPassword",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},securityKey:{entry:["resetErrors"],invoke:{src:"signUpSecurityKey",id:"signUpSecurityKey",onDone:[{cond:"hasSession",actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]}],onError:[{cond:"unverified",target:"incomplete.needsEmailVerification"},{actions:"saveRegistrationError",target:"incomplete.failed"}]}},passwordlessEmail:{entry:["resetErrors"],invoke:{src:"passwordlessEmail",id:"passwordlessEmail",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsEmailVerification"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSms:{entry:["resetErrors"],invoke:{src:"passwordlessSms",id:"passwordlessSms",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},passwordlessSmsOtp:{entry:["resetErrors"],invoke:{src:"passwordlessSmsOtp",id:"passwordlessSmsOtp",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},signInEmailOTP:{entry:["resetErrors"],invoke:{src:"signInEmailOTP",id:"signInEmailOTP",onDone:{actions:"clearContext",target:["#nhost.authentication.signedOut","incomplete.needsOtp"]},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},verifyEmailOTP:{entry:["resetErrors"],invoke:{src:"verifyEmailOTP",id:"verifyEmailOTP",onDone:{actions:["saveSession","reportTokenChanged"],target:"#nhost.authentication.signedIn"},onError:{actions:"saveRegistrationError",target:"incomplete.failed"}}},complete:{on:{SIGNED_OUT:"incomplete"}}}}}},{actions:{reportSignedIn:se("SIGNED_IN"),reportSignedOut:se("SIGNED_OUT"),reportTokenChanged:se("TOKEN_CHANGED"),incrementTokenImportAttempts:L({importTokenAttempts:({importTokenAttempts:d})=>d+1}),clearContext:L(()=>(a($e,null),a(Ye,null),a(Lt,null),{...Sr})),clearContextExceptTokens:L(({accessToken:d,refreshToken:h})=>({...Sr,accessToken:d,refreshToken:h})),saveSession:L({user:(d,{data:h})=>{var p;return((p=h==null?void 0:h.session)==null?void 0:p.user)||null},accessToken:(d,{data:h})=>{if(h.session){const{accessTokenExpiresIn:p,accessToken:v}=h.session,E=new Date(Date.now()+p*1e3);return a($e,E.toISOString()),{value:v,expiresAt:E,expiresInSeconds:p}}return a($e,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(d,{data:h})=>{var p,v;const E=((p=h.session)==null?void 0:p.refreshToken)||null,g=((v=h.session)==null?void 0:v.refreshTokenId)||null;return E&&a(Ye,E),g&&a(Lt,g),{value:E}}}),savePATSession:L({user:(d,{data:h})=>{var p;return((p=h==null?void 0:h.session)==null?void 0:p.user)||null},accessToken:(d,{data:h})=>{if(h.session){const{accessTokenExpiresIn:p,accessToken:v}=h.session,E=new Date(Date.now()+p*1e3);return a($e,E.toISOString()),{value:v,expiresAt:E,expiresInSeconds:p}}return a($e,null),{value:null,expiresAt:null,expiresInSeconds:null}},refreshToken:(d,{data:h})=>{var p,v;const E=((p=h.session)==null?void 0:p.refreshToken)||null,g=((v=h.session)==null?void 0:v.refreshTokenId)||null;return E&&a(Ye,E),g&&a(Lt,g),{value:E,isPAT:!0}}}),saveMfaTicket:L({mfa:(d,h)=>{var p;return(p=h.data)==null?void 0:p.mfa}}),resetTimer:L({refreshTimer:d=>({startedAt:new Date,attempts:0,lastAttempt:null})}),saveRefreshAttempt:L({refreshTimer:(d,h)=>({startedAt:d.refreshTimer.startedAt,attempts:d.refreshTimer.attempts+1,lastAttempt:new Date})}),saveAuthenticationError:L({errors:({errors:d},{data:{error:h}})=>({...d,authentication:h})}),resetErrors:L({errors:d=>({}),importTokenAttempts:d=>0}),saveRegistrationError:L({errors:({errors:d},{data:{error:h}})=>({...d,registration:h})}),destroyRefreshToken:L({refreshToken:d=>(a(Ye,null),a(Lt,null),{value:null})}),destroyAccessToken:L({accessToken:d=>(a($e,null),{value:null,expiresAt:null,expiresInSeconds:null})}),cleanUrl:()=>{l&&Bt("refreshToken")&&(Kn("refreshToken"),Kn("type"))},broadcastToken:d=>{if(l&&r&&f)try{f.postMessage({type:"broadcast_session",payload:{token:d.refreshToken.value,accessToken:d.accessToken.value,user:d.user,expiresAt:d.accessToken.expiresAt?d.accessToken.expiresAt.toISOString():null,expiresInSeconds:d.accessToken.expiresInSeconds}})}catch{}}},guards:{isAnonymous:(d,h)=>{var p;return!!((p=d.user)!=null&&p.isAnonymous)},isSignedIn:d=>!!d.user&&!!d.accessToken.value,noToken:d=>!d.refreshToken.value,isRefreshTokenPAT:d=>{var h;return!!((h=d.refreshToken)!=null&&h.isPAT)},hasRefreshToken:d=>!!d.refreshToken.value,isAutoRefreshDisabled:()=>!o,refreshTimerShouldRefresh:d=>{const{expiresAt:h}=d.accessToken;if(!h)return!1;if(d.refreshTimer.lastAttempt)return d.refreshTimer.attempts>Rn?!1:Date.now()-d.refreshTimer.lastAttempt.getTime()>Math.pow(2,d.refreshTimer.attempts-1)*5e3;if(h.getTime()<Date.now()||s&&Date.now()-d.refreshTimer.startedAt.getTime()>s*1e3)return!0;if(!d.accessToken.expiresInSeconds)return!1;const p=h.getTime()-Date.now();return p<=Nn*1e3/2||p<=Nn*1e3&&Math.random()<.1},shouldRetryImportToken:(d,h)=>d.importTokenAttempts<Rn&&(h.data.error.status===Dn||h.data.error.status>=500),unverified:(d,{data:{error:h}})=>h.status===401&&(h.message==="Email is not verified"||h.error==="unverified-user"),hasSession:(d,h)=>{var p;return!!((p=h.data)!=null&&p.session)},hasMfaTicket:(d,h)=>{var p;return!!((p=h.data)!=null&&p.mfa)},isUnauthorizedError:(d,{data:{error:h}})=>h.status===401},services:{signInPassword:(d,{email:h,password:p})=>Se(h)?kr(p)?u("/signin/email-password",{email:h,password:p}):Promise.reject({error:Tr}):Promise.reject({error:Te}),signInPAT:(d,{pat:h})=>u("/signin/pat",{personalAccessToken:h}),signInIdToken:(d,{provider:h,idToken:p,nonce:v})=>u("/signin/idtoken",{provider:h,idToken:p,...v&&{nonce:v}}),passwordlessSms:(d,{phoneNumber:h,options:p})=>{var v;return Yn(h)?(v=d.user)!=null&&v.isAnonymous?(console.warn("Deanonymisation from a phone number is not yet implemented in hasura-auth"),u("/user/deanonymize",{signInMethod:"passwordless",connection:"sms",phoneNumber:h,options:de(e,p)},d.accessToken.value)):u("/signin/passwordless/sms",{phoneNumber:h,options:de(e,p)}):Promise.reject({error:Cn})},passwordlessSmsOtp:(d,{phoneNumber:h,otp:p})=>Yn(h)?u("/signin/passwordless/sms/otp",{phoneNumber:h,otp:p}):Promise.reject({error:Cn}),signInEmailOTP:(d,{email:h,options:p})=>Se(h)?u("/signin/otp/email",{email:h,options:de(e,p)}):Promise.reject({error:Te}),verifyEmailOTP:(d,{email:h,otp:p})=>Se(h)?u("/signin/otp/email/verify",{email:h,otp:p}):Promise.reject({error:Te}),passwordlessEmail:(d,{email:h,options:p})=>{var v;return Se(h)?(v=d.user)!=null&&v.isAnonymous?u("/user/deanonymize",{signInMethod:"passwordless",connection:"email",email:h,options:de(e,p)},d.accessToken.value):u("/signin/passwordless/email",{email:h,options:de(e,p)}):Promise.reject({error:Te})},signInAnonymous:d=>u("/signin/anonymous"),signInMfaTotp:(d,h)=>{var p;const v=h.ticket||((p=d.mfa)==null?void 0:p.ticket);return v?ko(v)?u("/signin/mfa/totp",{ticket:v,otp:h.otp}):Promise.reject({error:io}):Promise.reject({error:so})},signInSecurityKeyEmail:async(d,{email:h})=>{if(!Se(h))throw new qe(Te);const p=await u("/signin/webauthn",{email:h});let v;try{v=await Or(p)}catch(E){throw new qe(E)}return u("/signin/webauthn/verify",{email:h,credential:v})},refreshToken:async(d,h)=>{const p=h.type==="TRY_TOKEN"?h.token:d.refreshToken.value;return{session:await u("/token",{refreshToken:p}),error:null}},signInSecurityKey:async()=>{try{const d=await u("/signin/webauthn",{});let h;try{h=await Or(d)}catch(p){throw new qe(p)}return u("/signin/webauthn/verify",{credential:h})}catch(d){throw new qe(d)}},signout:async(d,h)=>{const p=await u("/signout",{refreshToken:d.refreshToken.value,all:!!h.all},h.all?d.accessToken.value:void 0);if(r&&f)try{f.postMessage({type:"signout"})}catch{}return p},signUpEmailPassword:async(d,{email:h,password:p,options:v,requestOptions:E})=>{var g;return Se(h)?kr(p)?(g=d.user)!=null&&g.isAnonymous?u("/user/deanonymize",{signInMethod:"email-password",email:h,password:p,options:de(e,v)},d.accessToken.value,E==null?void 0:E.headers):u("/signup/email-password",{email:h,password:p,options:de(e,v)},null,E==null?void 0:E.headers):Promise.reject({error:Tr}):Promise.reject({error:Te})},signUpSecurityKey:async(d,{email:h,options:p,requestOptions:v})=>{if(!Se(h))return Promise.reject({error:Te});const E=p==null?void 0:p.nickname;E&&delete p.nickname;const g=await u("/signup/webauthn",{email:h,options:p},null,v==null?void 0:v.headers);let x;try{x=await Vn(g)}catch(O){throw new qe(O)}return u("/signup/webauthn/verify",{credential:x,options:{redirectTo:p==null?void 0:p.redirectTo,nickname:E,displayName:p==null?void 0:p.displayName,...(p==null?void 0:p.metadata)&&{metadata:p==null?void 0:p.metadata}}})},importRefreshToken:async d=>{if(d.user&&d.refreshToken.value&&d.accessToken.value&&d.accessToken.expiresAt)return{session:{accessToken:d.accessToken.value,accessTokenExpiresIn:d.accessToken.expiresAt.getTime()-Date.now(),refreshToken:d.refreshToken.value,user:d.user},error:null};let h=null;if(l){const v=Bt("refreshToken")||null;if(v)try{return{session:await u("/token",{refreshToken:v}),error:null}}catch(E){h=E.error}else{const E=Bt("error"),g=Bt("errorDescription");if(E&&g!=="social user already exists")return Promise.reject({session:null,error:{status:Ee,error:E,message:g||E}})}}const p=await c(Ye);if(p)try{return{session:await u("/token",{refreshToken:p}),error:null}}catch(v){h=v.error}return h?Promise.reject({error:h,session:null}):{error:null,session:null}}},delays:{RETRY_IMPORT_TOKEN_DELAY:({importTokenAttempts:d})=>Math.pow(2,d-1)*5e3}})},$n=({backendUrl:t,clientUrl:e,interpreter:r})=>be({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changeEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:L({error:n=>Te}),saveRequestError:L({error:(n,{data:{error:i}})=>i}),reportError:se(n=>({type:"ERROR",error:n.error})),reportSuccess:se("SUCCESS")},guards:{invalidEmail:(n,{email:i})=>!Se(i)},services:{requestChange:async(n,{email:i,options:s})=>(await le(`${t}/user/email/change`,{newEmail:i,options:de(e,s)},r==null?void 0:r.getSnapshot().context.accessToken.value)).data}}),qn=({backendUrl:t,interpreter:e})=>be({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidPassword",actions:"saveInvalidPasswordError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidPasswordError:L({error:r=>Tr}),saveRequestError:L({error:(r,{data:{error:n}})=>n}),reportError:se(r=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS")},guards:{invalidPassword:(r,{password:n})=>!kr(n)},services:{requestChange:(r,{password:n,ticket:i})=>le(`${t}/user/password`,{newPassword:n,ticket:i},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),Io=({backendUrl:t,interpreter:e})=>be({schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,id:"enableMfa",initial:"idle",context:{error:null,imageUrl:null,secret:null},states:{idle:{initial:"initial",on:{GENERATE:"generating",DISABLE:"disabling"},states:{initial:{},error:{},disabled:{}}},generating:{invoke:{src:"generate",id:"generate",onDone:{target:"generated",actions:["reportGeneratedSuccess","saveGeneration"]},onError:{actions:["saveError","reportGeneratedError"],target:"idle.error"}}},generated:{initial:"idle",states:{idle:{initial:"idle",on:{ACTIVATE:[{cond:"invalidMfaType",actions:"saveInvalidMfaTypeError",target:".error"},{cond:"invalidMfaCode",actions:"saveInvalidMfaCodeError",target:".error"},{target:"activating"}],DISABLE:"#enableMfa.disabling"},states:{idle:{},error:{}}},activating:{invoke:{src:"activate",id:"activate",onDone:{target:"activated",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}},activated:{type:"final"}}},disabling:{invoke:{src:"disable",id:"disable",onDone:{target:"idle.disabled",actions:"reportSuccess"},onError:{actions:["saveError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidMfaTypeError:L({error:r=>ro}),saveInvalidMfaCodeError:L({error:r=>no}),saveError:L({error:(r,{data:{error:n}})=>n}),saveGeneration:L({imageUrl:(r,{data:{imageUrl:n}})=>n,secret:(r,{data:{totpSecret:n}})=>n}),reportError:se((r,n)=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS"),reportGeneratedSuccess:se("GENERATED"),reportGeneratedError:se(r=>({type:"GENERATED_ERROR",error:r.error}))},guards:{invalidMfaCode:(r,{code:n})=>!n,invalidMfaType:(r,{activeMfaType:n})=>!n||n!=="totp"},services:{generate:async r=>{const{data:n}=await Oo(`${t}/mfa/totp/generate`,e==null?void 0:e.getSnapshot().context.accessToken.value);return n},activate:(r,{code:n,activeMfaType:i})=>le(`${t}/user/mfa`,{code:n,activeMfaType:i},e==null?void 0:e.getSnapshot().context.accessToken.value),disable:(r,{code:n})=>le(`${t}/user/mfa`,{code:n,activeMfaType:""},e==null?void 0:e.getSnapshot().context.accessToken.value)}}),zn=({backendUrl:t,clientUrl:e})=>be({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"changePassword",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"requestChange",id:"requestChange",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:L({error:r=>Te}),saveRequestError:L({error:(r,{data:{error:n}})=>n}),reportError:se(r=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!Se(n)},services:{requestChange:(r,{email:n,options:i})=>le(`${t}/user/password/reset`,{email:n,options:de(e,i)})}}),Jn=({backendUrl:t,clientUrl:e})=>be({schema:{context:{},events:{},services:{}},tsTypes:{},predictableActionArguments:!0,id:"sendVerificationEmail",initial:"idle",context:{error:null},states:{idle:{on:{REQUEST:[{cond:"invalidEmail",actions:"saveInvalidEmailError",target:".error"},{target:"requesting"}]},initial:"initial",states:{initial:{},success:{},error:{}}},requesting:{invoke:{src:"request",id:"request",onDone:{target:"idle.success",actions:"reportSuccess"},onError:{actions:["saveRequestError","reportError"],target:"idle.error"}}}}},{actions:{saveInvalidEmailError:L({error:r=>Te}),saveRequestError:L({error:(r,{data:{error:n}})=>n}),reportError:se(r=>({type:"ERROR",error:r.error})),reportSuccess:se("SUCCESS")},guards:{invalidEmail:(r,{email:n})=>!Se(n)},services:{request:async(r,{email:n,options:i})=>(await le(`${t}/user/email/send-verification-email`,{email:n,options:de(e,i)})).data}});class bo{constructor({clientStorageType:e="web",autoSignIn:r=!0,autoRefreshToken:n=!0,start:i=!0,backendUrl:s,clientUrl:o,broadcastKey:l,devTools:c,...a}){ve(this,"backendUrl"),ve(this,"clientUrl"),ve(this,"_machine"),ve(this,"_interpreter"),ve(this,"_started",!1),ve(this,"_channel"),ve(this,"_subscriptionsQueue",new Set),ve(this,"_subscriptions",new Set);var u;if(this.backendUrl=s,this.clientUrl=o,this._machine=Ao({...a,backendUrl:s,clientUrl:o,broadcastKey:l,clientStorageType:e,autoSignIn:r,autoRefreshToken:n}),i&&this.start({devTools:c}),typeof window!="undefined"&&l)try{this._channel=new BroadcastChannel(l),r&&((u=this._channel)==null||u.addEventListener("message",f=>{var d;const{type:h,payload:p}=f.data;if(h==="broadcast_session"){const v=(d=this.interpreter)==null?void 0:d.getSnapshot().context,E=v==null?void 0:v.refreshToken.value;this.interpreter&&p.token&&p.token!==E&&this.interpreter.send("SESSION_UPDATE",{data:{session:{user:p.user,accessToken:p.accessToken,refreshToken:p.token,accessTokenExpiresIn:p.expiresInSeconds}}})}})),this._channel.addEventListener("message",f=>{const{type:d}=f.data;d==="signout"&&this.interpreter&&this.interpreter.send("SIGNOUT")})}catch{}}start({devTools:e=!1,initialSession:r,interpreter:n}={}){var i,s;const o={...this.machine.context,accessToken:{...this.machine.context.accessToken},refreshToken:{...this.machine.context.refreshToken}};r&&(o.user=r.user,o.refreshToken.value=(i=r.refreshToken)!=null?i:null,o.accessToken.value=(s=r.accessToken)!=null?s:null,o.accessToken.expiresAt=new Date(Date.now()+r.accessTokenExpiresIn*1e3));const l=this.machine.withContext(o);this._interpreter||(this._interpreter=n||De(l,{devTools:e})),(!this._started||typeof window=="undefined")&&(this._interpreter.initialized&&(this._interpreter.stop(),this._subscriptions.forEach(c=>c())),this._interpreter.start(l.initialState),this._subscriptionsQueue.forEach(c=>c(this))),this._started=!0}get machine(){return this._machine}get interpreter(){return this._interpreter}get started(){return this._started}subscribe(e){if(this.started){const r=e(this);return this._subscriptions.add(r),r}else return this._subscriptionsQueue.add(e),()=>{console.log("onTokenChanged was added before the interpreter started. Cannot unsubscribe listener.")}}}const Wn=async({backendUrl:t,interpreter:e},r)=>{try{const{data:n}=await le(`${t}/user/webauthn/add`,{},e==null?void 0:e.getSnapshot().context.accessToken.value);let i;try{i=await Vn(n)}catch(o){throw new qe(o)}const{data:s}=await le(`${t}/user/webauthn/verify`,{credential:i,nickname:r},e==null?void 0:e.getSnapshot().context.accessToken.value);return{key:s,isError:!1,error:null,isSuccess:!0}}catch(n){const{error:i}=n;return{isError:!0,error:i,isSuccess:!1}}},Qn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,needsEmailVerification:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,needsEmailVerification:!0})})}),Xn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{password:e,ticket:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSuccess:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSuccess:!0})})}),_o=t=>new Promise(e=>{t.send("GENERATE"),t.onTransition(r=>{r.matches("generated")?e({error:null,isError:!1,isGenerated:!0,qrCodeDataUrl:r.context.imageUrl||"",totpSecret:r.context.secret}):r.matches({idle:"error"})&&e({error:r.context.error||null,isError:!0,isGenerated:!1,qrCodeDataUrl:"",totpSecret:r.context.secret})})}),No=(t,e)=>new Promise(r=>{t.send("ACTIVATE",{activeMfaType:"totp",code:e}),t.onTransition(n=>{n.matches({generated:"activated"})?r({error:null,isActivated:!0,isError:!1}):n.matches({generated:{idle:"error"}})&&r({error:n.context.error,isActivated:!1,isError:!0})})}),Ro=(t,e)=>new Promise(r=>{t.send("DISABLE",{code:e}),t.onTransition(n=>{n.matches({idle:"disabled"})?r({error:null,isDisabled:!0,isError:!1}):n.matches({idle:"error"})&&r({error:n.context.error,isDisabled:!1,isError:!0})})}),Zn=async(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),ei=(t,e,r)=>new Promise(n=>{t.send("REQUEST",{email:e,options:r}),t.onTransition(i=>{i.matches({idle:"error"})?n({error:i.context.error,isError:!0,isSent:!1}):i.matches({idle:"success"})&&n({error:null,isError:!1,isSent:!0})})}),ti=t=>new Promise(e=>{const{changed:r}=t.send("SIGNIN_ANONYMOUS");r||e({isSuccess:!1,isError:!0,error:ue,user:null,accessToken:null,refreshToken:null}),t.onTransition(n=>{n.matches({authentication:"signedIn"})&&e({isSuccess:!0,isError:!1,error:null,user:n.context.user,accessToken:n.context.accessToken.value,refreshToken:n.context.refreshToken.value}),n.matches({authentication:{signedOut:"failed"}})&&e({isSuccess:!1,isError:!0,error:n.context.errors.authentication||null,user:null,accessToken:null,refreshToken:null})})}),ri=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_PASSWORD",{email:e,password:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:ue,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:{signedOut:"needsMfa"}})?n({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!0,mfa:o.context.mfa,user:null}):o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,needsMfaOtp:!1,mfa:null,user:o.context.user})})}),Ar=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_EMAIL",{email:e,options:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1});t.onTransition(s=>{s.matches("registration.incomplete.failed")?n({error:s.context.errors.registration||null,isError:!0,isSuccess:!1}):s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})&&n({error:null,isError:!1,isSuccess:!0})})}),ni=(t,e)=>new Promise(r=>{const{changed:n,context:i}=t.send({type:"SIGNIN_SECURITY_KEY_EMAIL",email:e});if(!n)return r({accessToken:i.accessToken.value,refreshToken:i.refreshToken.value,error:ue,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:i.user});t.onTransition(s=>{s.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?r({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):s.matches({authentication:{signedOut:"failed"}})?r({accessToken:null,refreshToken:null,error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):s.matches({authentication:"signedIn"})&&r({accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:s.context.user})})});function ii(t){return{error:t.message||"Something went wrong!",status:t.status||1,message:t.message||"Something went wrong!"}}const si=async(t,e)=>{var r,n;const i=(r=t.interpreter)==null?void 0:r.getSnapshot(),s=i==null?void 0:i.context.accessToken.value;let o;try{o=(await le(`${t.backendUrl}/elevate/webauthn`,{email:e},s)).data}catch(c){return{error:ii(c),isError:!0,isSuccess:!1,elevated:!1}}let l;try{l=await Or(o)}catch(c){return{error:ii(c),isError:!0,isSuccess:!1,elevated:!1}}try{const{data:{session:c},error:a}=await le(`${t.backendUrl}/elevate/webauthn/verify`,{email:e,credential:l},s);return c&&!a?((n=t.interpreter)==null||n.send({type:"SESSION_UPDATE",data:{session:c}}),{error:null,isError:!1,isSuccess:!0,elevated:!0}):{error:a,isError:!0,isSuccess:!1,elevated:!1}}catch(c){const{error:a}=c;return{error:a,isError:!0,isSuccess:!1,elevated:!1}}},oi=(t,e,r)=>new Promise(n=>{const{changed:i,context:s}=t.send("SIGNIN_MFA_TOTP",{otp:e,ticket:r});if(!i)return n({accessToken:s.accessToken.value,refreshToken:s.refreshToken.value,error:ue,isError:!0,isSuccess:!1,user:s.user});t.onTransition(o=>{o.matches({authentication:{signedOut:"failed"}})?n({accessToken:null,refreshToken:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null}):o.matches({authentication:"signedIn"})&&n({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,user:o.context.user})})}),ai=(t,e)=>new Promise(r=>{const{changed:n}=t.send("SIGNIN_PAT",{pat:e});n||r({isSuccess:!1,isError:!0,error:ue,user:null,accessToken:null,refreshToken:null}),t.onTransition(i=>{if(i.matches({authentication:{signedOut:"failed"}}))return r({accessToken:null,refreshToken:null,user:null,error:i.context.errors.authentication||null,isError:!0,isSuccess:!1});if(i.matches({authentication:"signedIn"}))return r({accessToken:i.context.accessToken.value,refreshToken:i.context.refreshToken.value,user:i.context.user,error:null,isError:!1,isSuccess:!0})})}),Ir=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("PASSWORDLESS_SMS",{phoneNumber:e,options:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1,needsOtp:!1});t.onTransition(s=>{s.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!1,needsOtp:!0}):s.matches("registration.incomplete.failed")&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),br=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send({type:"PASSWORDLESS_SMS_OTP",phoneNumber:e,otp:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});t.onTransition(s=>{s.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:s.context.user,accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value}):s.matches({registration:{incomplete:"failed"}})&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),ci=async(t,e)=>new Promise(r=>{const{event:n}=t.send("SIGNOUT",{all:e});if(n.type!=="SIGNED_OUT")return r({isSuccess:!1,isError:!0,error:co});t.onTransition(i=>{i.matches({authentication:{signedOut:"success"}})?r({isSuccess:!0,isError:!1,error:null}):i.matches("authentication.signedOut.failed")&&r({isSuccess:!1,isError:!0,error:i.context.errors.signout||null})})}),_r=(t,e,r,n,i)=>new Promise(s=>{const{changed:o,context:l}=t.send("SIGNUP_EMAIL_PASSWORD",{email:e,password:r,options:n,requestOptions:i});if(!o)return s({error:ue,accessToken:l.accessToken.value,refreshToken:l.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:l.user});t.onTransition(c=>{c.matches("registration.incomplete.failed")?s({accessToken:null,refreshToken:null,error:c.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):c.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?s({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):c.matches({authentication:"signedIn",registration:"complete"})&&s({accessToken:c.context.accessToken.value,refreshToken:c.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:c.context.user})})}),ui=(t,e,r,n)=>new Promise(i=>{const{changed:s,context:o}=t.send("SIGNUP_SECURITY_KEY",{email:e,options:r,requestOptions:n});if(!s)return i({error:ue,accessToken:o.accessToken.value,refreshToken:o.refreshToken.value,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:o.user});t.onTransition(l=>{l.matches("registration.incomplete.failed")?i({accessToken:null,refreshToken:null,error:l.context.errors.registration||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):l.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?i({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):l.matches({authentication:"signedIn",registration:"complete"})&&i({accessToken:l.context.accessToken.value,refreshToken:l.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:l.context.user})})}),li=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send("SIGNIN_EMAIL_OTP",{email:e,options:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1,needsOtp:!1});t.onTransition(s=>{s.matches("registration.incomplete.needsOtp")?n({error:null,isError:!1,isSuccess:!0,needsOtp:!0}):s.matches("registration.incomplete.failed")&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,needsOtp:!1})})}),di=(t,e,r)=>new Promise(n=>{const{changed:i}=t.send({type:"VERIFY_EMAIL_OTP",email:e,otp:r});if(!i)return n({error:ue,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null});t.onTransition(s=>{s.matches({authentication:"signedIn"})?n({error:null,isError:!1,isSuccess:!0,user:s.context.user,accessToken:s.context.accessToken.value,refreshToken:s.context.refreshToken.value}):s.matches({registration:{incomplete:"failed"}})&&n({error:s.context.errors.authentication||null,isError:!0,isSuccess:!1,user:null,accessToken:null,refreshToken:null})})}),hi=(t,{provider:e,idToken:r,nonce:n})=>new Promise(i=>{const{changed:s}=t.send("SIGNIN_ID_TOKEN",{provider:e,idToken:r,...n&&{nonce:n}});s||i({isSuccess:!1,isError:!0,error:ue,user:null,accessToken:null,refreshToken:null}),t.onTransition(o=>{if(o.matches({authentication:{signedOut:"failed"}}))return i({accessToken:null,refreshToken:null,user:null,error:o.context.errors.authentication||null,isError:!0,isSuccess:!1});if(o.matches({authentication:"signedIn"}))return i({accessToken:o.context.accessToken.value,refreshToken:o.context.refreshToken.value,user:o.context.user,error:null,isError:!1,isSuccess:!0})})}),fi=async({backendUrl:t,interpreter:e},{provider:r,idToken:n,nonce:i})=>{try{return await le(`${t}/link/idtoken`,{provider:r,idToken:n,...i&&{nonce:i}},e==null?void 0:e.getSnapshot().context.accessToken.value),{isError:!1,error:null,isSuccess:!0}}catch(s){const{error:o}=s;return{isError:!0,error:o,isSuccess:!1}}},pi=t=>new Promise(e=>{const{changed:r,context:n}=t.send({type:"SIGNIN_SECURITY_KEY"});if(!r)return e({accessToken:n.accessToken.value,refreshToken:n.refreshToken.value,error:ue,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:n.user});t.onTransition(i=>{i.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}})?e({accessToken:null,refreshToken:null,error:null,isError:!1,isSuccess:!1,needsEmailVerification:!0,user:null}):i.matches({authentication:{signedOut:"failed"}})?e({accessToken:null,refreshToken:null,error:i.context.errors.authentication||null,isError:!0,isSuccess:!1,needsEmailVerification:!1,user:null}):i.matches({authentication:"signedIn"})&&e({accessToken:i.context.accessToken.value,refreshToken:i.context.refreshToken.value,error:null,isError:!1,isSuccess:!0,needsEmailVerification:!1,user:i.context.user})})}),Do=async({backendUrl:t,interpreter:e},{expiresAt:r,metadata:n})=>{try{const{data:i}=await le(`${t}/pat`,{expiresAt:r.toISOString(),metadata:n},e==null?void 0:e.getSnapshot().context.accessToken.value);return{data:i?{id:i.id||null,personalAccessToken:i.personalAccessToken||null}:null,isError:!1,error:null,isSuccess:!0}}catch(i){const{error:s}=i;return{isError:!0,error:s,isSuccess:!1,data:null}}};class Po{constructor({url:e,broadcastKey:r,autoRefreshToken:n=!0,autoSignIn:i=!0,clientStorage:s,clientStorageType:o,refreshIntervalTime:l,start:c=!0}){ve(this,"_client"),ve(this,"url");var a;this.url=e,this._client=new bo({backendUrl:e,clientUrl:typeof window!="undefined"&&((a=window.location)==null?void 0:a.origin)||"",broadcastKey:r,autoRefreshToken:n,autoSignIn:i,start:c,clientStorage:s,clientStorageType:o,refreshIntervalTime:l})}async signUp(e,r){const n=await this.waitUntilReady();if("securityKey"in e){const{email:l,options:c}=e;return me(await ui(n,l,c,r))}const{email:i,password:s,options:o}=e;return me(await _r(n,i,s,o,r))}async connectProvider(e){const r=(await this.waitUntilReady()).getSnapshot().context.accessToken.value,{provider:n,options:i}=e,s=Vt(`${this._client.backendUrl}/signin/provider/${n}`,de(this._client.clientUrl,{...i,connect:r}));return Bn()&&(window.location.href=s),{providerUrl:s}}async signInIdToken(e){const r=await this.waitUntilReady(),n=await hi(r,e);return{...me(n),mfa:null}}async linkIdToken(e){return fi(this._client,e)}async signIn(e){const r=await this.waitUntilReady();if(!e){const n=await ti(r);return{...me(n),mfa:null}}if("provider"in e){const{provider:n,options:i}=e,s=Vt(`${this._client.backendUrl}/signin/provider/${n}`,de(this._client.clientUrl,i));return Bn()&&(window.location.href=s),{providerUrl:s,provider:n,session:null,mfa:null,error:null}}if("email"in e&&"password"in e){const n=await ri(r,e.email,e.password);return n.needsEmailVerification?{session:null,mfa:null,error:uo}:n.needsMfaOtp?{session:null,mfa:n.mfa,error:null}:{...me(n),mfa:null}}if("email"in e&&"securityKey"in e){if(e.securityKey!==!0)throw Error("securityKey must be true");const n=await ni(r,e.email);return{...me(n),mfa:null}}if("email"in e){const{email:n,options:i}=e,{error:s}=await Ar(r,n,i);return{session:null,mfa:null,error:s}}if("phoneNumber"in e&&"otp"in e){const n=await br(r,e.phoneNumber,e.otp);return{...me(n),mfa:null}}if("phoneNumber"in e){const{error:n}=await Ir(r,e.phoneNumber,e.options);return{error:n,mfa:null,session:null}}if("otp"in e){const n=await oi(r,e.otp,e.ticket);return{...me(n),mfa:null}}return{error:ho,mfa:null,session:null}}async signInPAT(e){const r=await this.waitUntilReady(),n=await ai(r,e);return me(n)}async signInEmailOTP(e,r){const n=await this.waitUntilReady(),{error:i}=await li(n,e,r);return{error:i,session:null,mfa:null}}async verifyEmailOTP(e,r){const n=await this.waitUntilReady(),i=await di(n,e,r);return{...me(i),mfa:null}}async signInSecurityKey(){const e=await this.waitUntilReady(),r=await pi(e);return{...me(r),mfa:null}}async signOut(e){const r=await this.waitUntilReady(),{error:n}=await ci(r,e==null?void 0:e.all);return{error:n}}async resetPassword({email:e,options:r}){const n=De(zn(this._client)).start(),{error:i}=await Zn(n,e,r);return{error:i}}async changePassword({newPassword:e,ticket:r}){const n=De(qn(this._client)).start(),{error:i}=await Xn(n,e,r);return{error:i}}async sendVerificationEmail({email:e,options:r}){const n=De(Jn(this._client)).start(),{error:i}=await ei(n,e,r);return{error:i}}async changeEmail({newEmail:e,options:r}){const n=De($n(this._client)).start(),{error:i}=await Qn(n,e,r);return{error:i}}async deanonymize(e){const r=await this.waitUntilReady();if(e.signInMethod==="passwordless"){if(e.connection==="email"){const{error:n}=await Ar(r,e.email,e.options);return{error:n}}if(e.connection==="sms"){const{error:n}=await Ir(r,e.phoneNumber,e.options);return{error:n}}}if(e.signInMethod==="email-password"){const{error:n}=await _r(r,e.email,e.password,e.options);return{error:n}}throw Error("Unknown deanonymization method")}async addSecurityKey(e){const{error:r,key:n}=await Wn(this._client,e);return{error:r,key:n}}async elevateEmailSecurityKey(e){if(!e)throw Error("A user email is required");return{...await si(this._client,e),mfa:null}}async createPAT(e,r){return Do(this._client,{expiresAt:e,metadata:r})}onTokenChanged(e){return this._client.subscribe(()=>{var r;const n=(r=this._client.interpreter)==null?void 0:r.onTransition(({event:i,context:s})=>{i.type==="TOKEN_CHANGED"&&e(Ft(s))});return()=>n==null?void 0:n.stop()})}onAuthStateChanged(e){return this._client.subscribe(()=>{var r;const n=(r=this._client.interpreter)==null?void 0:r.onTransition(({event:i,context:s})=>{(i.type==="SIGNED_IN"||i.type==="SIGNED_OUT")&&e(i.type,Ft(s))});return()=>n==null?void 0:n.stop()})}isAuthenticated(){var e;return!!((e=this._client.interpreter)!=null&&e.getSnapshot().matches({authentication:"signedIn"}))}async isAuthenticatedAsync(){return(await this.waitUntilReady()).getSnapshot().matches({authentication:"signedIn"})}getAuthenticationStatus(){var e;const r=((e=this.client.interpreter)==null?void 0:e.getSnapshot().context.importTokenAttempts)||0;return this.isReady()?{isAuthenticated:this.isAuthenticated(),isLoading:!1,connectionAttempts:r}:{isAuthenticated:!1,isLoading:!0,connectionAttempts:r}}getAccessToken(){var e,r;return(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot().context.accessToken.value)!=null?r:void 0}getDecodedAccessToken(){const e=this.getAccessToken();return e?Xt(e):null}getHasuraClaims(){var e;return((e=this.getDecodedAccessToken())==null?void 0:e["https://hasura.io/jwt/claims"])||null}getHasuraClaim(e){var r;return((r=this.getHasuraClaims())==null?void 0:r[e.startsWith("x-hasura-")?e:`x-hasura-${e}`])||null}async refreshSession(e){try{const r=await this.waitUntilReady();return new Promise(n=>{const i=e||r.getSnapshot().context.refreshToken.value;if(!i)return n({session:null,error:oo});const{changed:s}=r.send("TRY_TOKEN",{token:i});if(!s)return n({session:null,error:ao});r.onTransition(o=>{o.matches({token:{idle:"error"}})?n({session:null,error:lo}):o.event.type==="TOKEN_CHANGED"&&n({session:Ft(o.context),error:null})})})}catch(r){return{session:null,error:r.message}}}getSession(){var e,r;return Ft((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)}async initWithSession({session:e}){this.client.start({initialSession:e}),await this.waitUntilReady()}getUser(){var e,r,n;return((n=(r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())==null?void 0:r.context)==null?void 0:n.user)||null}waitUntilReady(){const e=this._client.interpreter;if(!e)throw Error("Auth interpreter not set");return e.getSnapshot().hasTag("loading")?new Promise((r,n)=>{let i=setTimeout(()=>n("The state machine is not yet ready after 15 seconds."),15e3);e.onTransition(s=>{if(!s.hasTag("loading"))return clearTimeout(i),r(e)})}):Promise.resolve(e)}isReady(){var e,r;return!((r=(e=this._client.interpreter)==null?void 0:e.getSnapshot())!=null&&r.hasTag("loading"))}get client(){return this._client}}var Co=typeof self=="object"?self.FormData:window.FormData;const Nr=yr(Co);var Lo=Object.defineProperty,Uo=(t,e,r)=>e in t?Lo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ze=(t,e,r)=>Uo(t,typeof e!="symbol"?e+"":e,r);let vi=globalThis.fetch;const Rr=async(t,e,{accessToken:r,name:n,fileId:i,bucketId:s,adminSecret:o,onUploadProgress:l,headers:c={}}={})=>{var a;const u={...c};s&&e.append("bucket-id",s),o&&(u["x-hasura-admin-secret"]=o),r&&(u.Authorization=`Bearer ${r}`);const f=`${t}/files`;if(typeof XMLHttpRequest=="undefined")try{e instanceof Nr&&(vi=Er().fetch);const d=await vi(f,{method:"POST",headers:u,body:e}),h=await d.json();return d.ok?{fileMetadata:h,error:null}:{error:{status:d.status,message:((a=h==null?void 0:h.error)==null?void 0:a.message)||d.statusText,error:d.statusText},fileMetadata:null}}catch(d){return{error:{status:0,message:d.message,error:d.message},fileMetadata:null}}return new Promise(d=>{let h=new XMLHttpRequest;h.responseType="json",h.onload=()=>{var p,v,E,g,x,O,k,C;if(h.status<200||h.status>=300){const b={error:(x=(g=(v=(p=h.response)==null?void 0:p.error)==null?void 0:v.message)!=null?g:(E=h.response)==null?void 0:E.error)!=null?x:h.response,message:(C=(k=(O=h.response)==null?void 0:O.error)==null?void 0:k.message)!=null?C:h.response,status:h.status};return d({fileMetadata:null,error:b})}return d({fileMetadata:h.response,error:null})},h.onerror=()=>{const p={error:h.statusText,message:h.statusText,status:h.status};return d({fileMetadata:null,error:p})},l&&h.upload.addEventListener("progress",l,!1),h.open("POST",f,!0),Object.entries(u).forEach(([p,v])=>{h.setRequestHeader(p,v)}),h.send(e)})};function Dr(t,e){if(!e||Object.keys(e).length===0)return t;const r=new URL(t),n=Object.entries(e).reduce((i,[s,o])=>({...i,[s.charAt(0)]:o}),{});return Object.entries(n).forEach(([i,s])=>{s&&r.searchParams.set(i,s)}),r.toString()}let ht;typeof ht=="undefined"&&(ht=Er().fetch);class Mo{constructor({url:e}){ze(this,"url"),ze(this,"accessToken"),ze(this,"adminSecret"),ze(this,"headers",{}),this.url=e}async uploadFormData({formData:e,bucketId:r,headers:n}){const{error:i,fileMetadata:s}=await Rr(this.url,e,{bucketId:r,headers:{...this.headers,...n},accessToken:this.accessToken,adminSecret:this.adminSecret});return i?{fileMetadata:null,error:i}:s&&!("processedFiles"in s)?{fileMetadata:{processedFiles:[s]},error:null}:{fileMetadata:s,error:null}}async uploadFile({file:e,bucketId:r,id:n,name:i,headers:s}){const o=typeof window=="undefined"?new Nr:new FormData;o.append("file[]",e),o.append("metadata[]",JSON.stringify({id:n,name:i}));const{error:l,fileMetadata:c}=await Rr(this.url,o,{accessToken:this.accessToken,adminSecret:this.adminSecret,bucketId:r,fileId:n,name:i,headers:{...this.headers,...s}});return l?{fileMetadata:null,error:l}:c&&"processedFiles"in c?{fileMetadata:c.processedFiles[0],error:null}:{fileMetadata:c,error:null}}async downloadFile(e){try{const{fileId:r,headers:n,...i}=e,s=Dr(`${this.url}/files/${r}`,i),o=await ht(s,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...n}});if(!o.ok)throw new Error(await o.text());return{file:await o.blob(),error:null}}catch(r){return{file:null,error:r}}}async getPresignedUrl(e){try{const{fileId:r,headers:n}=e,i=await ht(`${this.url}/files/${r}/presignedurl`,{method:"GET",headers:{...this.generateAuthHeaders(),...this.headers,...n}});if(!i.ok)throw new Error(await i.text());return{presignedUrl:await i.json(),error:null}}catch(r){return{presignedUrl:null,error:r}}}async delete(e){try{const{fileId:r,headers:n}=e,i=await ht(`${this.url}/files/${r}`,{method:"DELETE",headers:{...this.generateAuthHeaders(),...this.headers,...n}});if(!i.ok)throw new Error(await i.text());return{error:null}}catch(r){return{error:r}}}setAccessToken(e){return this.accessToken=e,this}setAdminSecret(e){return this.adminSecret=e,this}getHeaders(){return this.headers}setHeaders(e){return e?(this.headers={...this.headers,...e},this):this}unsetHeaders(){const e=this.headers["x-hasura-role"];return this.headers=e?{"x-hasura-role":e}:{},this}generateAuthHeaders(){if(!(!this.adminSecret&&!this.accessToken))return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:{Authorization:`Bearer ${this.accessToken}`}}}class jo{constructor({url:e,adminSecret:r}){ze(this,"url"),ze(this,"api"),this.url=e,this.api=new Mo({url:e}),this.setAdminSecret(r)}async upload(e){return"file"in e?this.api.uploadFile(e):this.api.uploadFormData(e)}getPublicUrl(e){const{fileId:r,...n}=e;return Dr(`${this.url}/files/${r}`,n)}async getPresignedUrl(e){const{fileId:r,headers:n,...i}=e,{presignedUrl:s,error:o}=await this.api.getPresignedUrl(e);if(o)return{presignedUrl:null,error:o};if(!s)return{presignedUrl:null,error:new Error("Invalid file id")};const l=Dr(s.url,i);return{presignedUrl:{...s,url:l},error:null}}async download(e){const{file:r,error:n}=await this.api.downloadFile(e);return n?{file:null,error:n}:r?{file:r,error:null}:{file:null,error:new Error("File does not exist")}}async delete(e){const{error:r}=await this.api.delete(e);return r?{error:r}:{error:null}}setAccessToken(e){return this.api.setAccessToken(e),this}setAdminSecret(e){return this.api.setAdminSecret(e),this}getHeaders(){return this.api.getHeaders()}setHeaders(e){return this.api.setHeaders(e),this}unsetHeaders(){return this.api.unsetHeaders(),this}}let Pr;typeof Pr=="undefined"&&(Pr=Nr);const Cr={progress:null,loaded:0,error:null,bucketId:void 0,file:void 0,id:void 0},mi=()=>be({predictableActionArguments:!0,schema:{context:{},events:{}},tsTypes:{},context:{...Cr},initial:"idle",on:{DESTROY:{actions:"sendDestroy",target:"stopped"}},states:{idle:{on:{ADD:{actions:"addFile"},UPLOAD:{cond:"hasFile",target:"uploading"}}},uploading:{entry:"resetProgress",on:{UPLOAD_PROGRESS:{actions:["incrementProgress","sendProgress"]},UPLOAD_DONE:"uploaded",UPLOAD_ERROR:"error",CANCEL:"idle"},invoke:{src:"uploadFile"}},uploaded:{entry:["setFileMetadata","sendDone"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},error:{entry:["setError","sendError"],on:{ADD:{actions:"addFile",target:"idle"},UPLOAD:{actions:"resetContext",target:"uploading"}}},stopped:{type:"final"}}},{guards:{hasFile:(t,e)=>!!t.file||!!e.file},actions:{incrementProgress:L({loaded:(t,{loaded:e})=>e,progress:(t,{progress:e})=>e}),setFileMetadata:L({id:(t,{id:e})=>e,bucketId:(t,{bucketId:e})=>e,progress:t=>100}),setError:L({error:(t,{error:e})=>e}),sendProgress:()=>{},sendError:()=>{},sendDestroy:()=>{},sendDone:()=>{},resetProgress:L({progress:t=>null,loaded:t=>0}),resetContext:L(t=>Cr),addFile:L({file:(t,{file:e})=>e,bucketId:(t,{bucketId:e})=>e,id:(t,{id:e})=>e})},services:{uploadFile:(t,e)=>r=>{const n=e.file||t.file,i=new Pr;i.append("file[]",n);let s=0;return Rr(e.url,i,{fileId:e.id||t.id,bucketId:e.bucketId||t.bucketId,accessToken:e.accessToken,adminSecret:e.adminSecret,name:e.name||n.name,onUploadProgress:o=>{const l=o.total?Math.round(o.loaded*n.size/o.total):0,c=l-s;s=l,r({type:"UPLOAD_PROGRESS",progress:o.total?Math.round(l*100/o.total):0,loaded:l,additions:c})}}).then(({fileMetadata:o,error:l})=>{if(l&&r({type:"UPLOAD_ERROR",error:l}),o&&!("processedFiles"in o)){const{id:c,bucketId:a}=o;r({type:"UPLOAD_DONE",id:c,bucketId:a})}if(o&&"processedFiles"in o){const{id:c,bucketId:a}=o.processedFiles[0];r({type:"UPLOAD_DONE",id:c,bucketId:a})}}),()=>{}}}}),{pure:Lr,sendParent:Gt}=Is,Fo=()=>be({id:"files-list",schema:{context:{},events:{}},tsTypes:{},predictableActionArguments:!0,context:{progress:null,files:[],loaded:0,total:0},initial:"idle",on:{UPLOAD:{cond:"hasFileToDownload",actions:"addItem",target:"uploading"},ADD:{actions:"addItem"},REMOVE:{actions:"removeItem"}},states:{idle:{entry:["resetProgress","resetLoaded","resetTotal"],on:{CLEAR:{actions:"clearList",target:"idle"}}},uploading:{entry:["upload","startProgress","resetLoaded","resetTotal"],on:{UPLOAD_PROGRESS:{actions:["incrementProgress"]},UPLOAD_DONE:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],UPLOAD_ERROR:[{cond:"isAllUploaded",target:"uploaded"},{cond:"isAllUploadedOrError",target:"error"}],CANCEL:{actions:"cancel",target:"idle"}}},uploaded:{entry:"setUploaded",on:{CLEAR:{actions:"clearList",target:"idle"}}},error:{on:{CLEAR:{actions:"clearList",target:"idle"}}}}},{guards:{hasFileToDownload:(t,e)=>t.files.some(r=>r.getSnapshot().matches("idle"))||!!e.files,isAllUploaded:t=>t.files.every(e=>{var r;return(r=e.getSnapshot())==null?void 0:r.matches("uploaded")}),isAllUploadedOrError:t=>t.files.every(e=>{const r=e.getSnapshot();return(r==null?void 0:r.matches("error"))||(r==null?void 0:r.matches("uploaded"))})},actions:{incrementProgress:L((t,e)=>{const r=t.loaded+e.additions,n=Math.round(r*100/t.total);return{...t,loaded:r,progress:n}}),setUploaded:L({progress:t=>100,loaded:({files:t})=>t.map(e=>e.getSnapshot()).filter(e=>e.matches("uploaded")).reduce((e,r)=>{var n;return e+((n=r.context.file)==null?void 0:n.size)},0)}),resetTotal:L({total:({files:t})=>t.map(e=>e.getSnapshot()).filter(e=>!e.matches("uploaded")).reduce((e,r)=>{var n;return e+((n=r.context.file)==null?void 0:n.size)},0)}),resetLoaded:L({loaded:t=>0}),startProgress:L({progress:t=>0}),resetProgress:L({progress:t=>null}),addItem:L((t,{files:e,bucketId:r})=>{const n=e?Array.isArray(e)?e:"item"in e?Array.from(e):[e]:[],i=t.total+n.reduce((o,l)=>o+l.size,0),s=Math.round(t.loaded*100/i);return{files:[...t.files,...n.map(o=>Ys(mi().withConfig({actions:{sendProgress:Gt((l,{additions:c})=>({type:"UPLOAD_PROGRESS",additions:c})),sendDone:Gt("UPLOAD_DONE"),sendError:Gt("UPLOAD_ERROR"),sendDestroy:Gt("REMOVE")}}).withContext({...Cr,file:o,bucketId:r}),{sync:!0}))],total:i,loaded:t.loaded,progress:s}}),removeItem:L({files:t=>t.files.filter(e=>{var r,n;const i=(r=e.getSnapshot())==null?void 0:r.matches("stopped");return i&&((n=e.stop)==null||n.call(e)),!i})}),clearList:Lr(t=>t.files.map(e=>se({type:"DESTROY"},{to:e.id}))),upload:Lr((t,e)=>t.files.map(r=>se(e,{to:r.id}))),cancel:Lr(t=>t.files.map(e=>se({type:"CANCEL"},{to:e.id})))}}),Vo=async(t,e)=>new Promise(r=>{e.send({type:"UPLOAD",...t}),e.subscribe(n=>{var i;n.matches("error")?r({error:n.context.error,isError:!0,isUploaded:!1}):n.matches("uploaded")&&r({error:null,isError:!1,isUploaded:!0,id:n.context.id,bucketId:n.context.id,name:(i=n.context.file)==null?void 0:i.name})})}),Bo=async(t,e)=>new Promise(r=>{e.send({type:"UPLOAD",...t,files:t.files}),e.onTransition(n=>{n.matches("error")?r({errors:n.context.files.filter(i=>{var s;return(s=i.getSnapshot())==null?void 0:s.context.error}),isError:!0,files:[]}):n.matches("uploaded")&&r({errors:[],isError:!1,files:n.context.files})})});function Go(t,e){return e=e||{},new Promise(function(r,n){var i=new XMLHttpRequest,s=[],o=[],l={},c=function(){return{ok:(i.status/100|0)==2,statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:c,headers:{keys:function(){return s},entries:function(){return o},get:function(u){return l[u.toLowerCase()]},has:function(u){return u.toLowerCase()in l}}}};for(var a in i.open(e.method||"get",t,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(u,f,d){s.push(f=f.toLowerCase()),o.push([f,d]),l[f]=l[f]?l[f]+","+d:d}),r(c())},i.onerror=n,i.withCredentials=e.credentials=="include",e.headers)i.setRequestHeader(a,e.headers[a]);i.send(e.body||null)})}const yi=Qs(Object.freeze(Object.defineProperty({__proto__:null,default:Go},Symbol.toStringTag,{value:"Module"})));var Ho=self.fetch||(self.fetch=yi.default||yi);const gi=yr(Ho);function Ht(t,e){if(!!!t)throw new Error(e)}function Ko(t){return typeof t=="object"&&t!==null}function Yo(t,e){if(!!!t)throw new Error("Unexpected invariant triggered.")}const $o=/\r\n|[\n\r]/g;function Ur(t,e){let r=0,n=1;for(const i of t.body.matchAll($o)){if(typeof i.index=="number"||Yo(!1),i.index>=e)break;r=i.index+i[0].length,n+=1}return{line:n,column:e+1-r}}function qo(t){return Ei(t.source,Ur(t.source,t.start))}function Ei(t,e){const r=t.locationOffset.column-1,n="".padStart(r)+t.body,i=e.line-1,s=t.locationOffset.line-1,o=e.line+s,l=e.line===1?r:0,c=e.column+l,a=`${t.name}:${o}:${c}
`,u=n.split(/\r\n|[\n\r]/g),f=u[i];if(f.length>120){const d=Math.floor(c/80),h=c%80,p=[];for(let v=0;v<f.length;v+=80)p.push(f.slice(v,v+80));return a+Ti([[`${o} |`,p[0]],...p.slice(1,d+1).map(v=>["|",v]),["|","^".padStart(h)],["|",p[d+1]]])}return a+Ti([[`${o-1} |`,u[i-1]],[`${o} |`,f],["|","^".padStart(c)],[`${o+1} |`,u[i+1]]])}function Ti(t){const e=t.filter(([n,i])=>i!==void 0),r=Math.max(...e.map(([n])=>n.length));return e.map(([n,i])=>n.padStart(r)+(i?" "+i:"")).join(`
`)}function zo(t){const e=t[0];return e==null||"kind"in e||"length"in e?{nodes:e,source:t[1],positions:t[2],path:t[3],originalError:t[4],extensions:t[5]}:e}class Mr extends Error{constructor(e,...r){var n,i,s;const{nodes:o,source:l,positions:c,path:a,originalError:u,extensions:f}=zo(r);super(e),this.name="GraphQLError",this.path=a!=null?a:void 0,this.originalError=u!=null?u:void 0,this.nodes=Si(Array.isArray(o)?o:o?[o]:void 0);const d=Si((n=this.nodes)===null||n===void 0?void 0:n.map(p=>p.loc).filter(p=>p!=null));this.source=l!=null?l:d==null||(i=d[0])===null||i===void 0?void 0:i.source,this.positions=c!=null?c:d==null?void 0:d.map(p=>p.start),this.locations=c&&l?c.map(p=>Ur(l,p)):d==null?void 0:d.map(p=>Ur(p.source,p.start));const h=Ko(u==null?void 0:u.extensions)?u==null?void 0:u.extensions:void 0;this.extensions=(s=f!=null?f:h)!==null&&s!==void 0?s:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),u!=null&&u.stack?Object.defineProperty(this,"stack",{value:u.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Mr):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const r of this.nodes)r.loc&&(e+=`

`+qo(r.loc));else if(this.source&&this.locations)for(const r of this.locations)e+=`

`+Ei(this.source,r);return e}toJSON(){const e={message:this.message};return this.locations!=null&&(e.locations=this.locations),this.path!=null&&(e.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function Si(t){return t===void 0||t.length===0?void 0:t}function oe(t,e,r){return new Mr(`Syntax Error: ${r}`,{source:t,positions:[e]})}class Jo{constructor(e,r,n){this.start=e.start,this.end=r.end,this.startToken=e,this.endToken=r,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class wi{constructor(e,r,n,i,s,o){this.kind=e,this.start=r,this.end=n,this.line=i,this.column=s,this.value=o,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const xi={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},Wo=new Set(Object.keys(xi));function Oi(t){const e=t==null?void 0:t.kind;return typeof e=="string"&&Wo.has(e)}var Je;(function(t){t.QUERY="query",t.MUTATION="mutation",t.SUBSCRIPTION="subscription"})(Je||(Je={}));var jr;(function(t){t.QUERY="QUERY",t.MUTATION="MUTATION",t.SUBSCRIPTION="SUBSCRIPTION",t.FIELD="FIELD",t.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",t.FRAGMENT_SPREAD="FRAGMENT_SPREAD",t.INLINE_FRAGMENT="INLINE_FRAGMENT",t.VARIABLE_DEFINITION="VARIABLE_DEFINITION",t.SCHEMA="SCHEMA",t.SCALAR="SCALAR",t.OBJECT="OBJECT",t.FIELD_DEFINITION="FIELD_DEFINITION",t.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",t.INTERFACE="INTERFACE",t.UNION="UNION",t.ENUM="ENUM",t.ENUM_VALUE="ENUM_VALUE",t.INPUT_OBJECT="INPUT_OBJECT",t.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(jr||(jr={}));var R;(function(t){t.NAME="Name",t.DOCUMENT="Document",t.OPERATION_DEFINITION="OperationDefinition",t.VARIABLE_DEFINITION="VariableDefinition",t.SELECTION_SET="SelectionSet",t.FIELD="Field",t.ARGUMENT="Argument",t.FRAGMENT_SPREAD="FragmentSpread",t.INLINE_FRAGMENT="InlineFragment",t.FRAGMENT_DEFINITION="FragmentDefinition",t.VARIABLE="Variable",t.INT="IntValue",t.FLOAT="FloatValue",t.STRING="StringValue",t.BOOLEAN="BooleanValue",t.NULL="NullValue",t.ENUM="EnumValue",t.LIST="ListValue",t.OBJECT="ObjectValue",t.OBJECT_FIELD="ObjectField",t.DIRECTIVE="Directive",t.NAMED_TYPE="NamedType",t.LIST_TYPE="ListType",t.NON_NULL_TYPE="NonNullType",t.SCHEMA_DEFINITION="SchemaDefinition",t.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",t.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",t.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",t.FIELD_DEFINITION="FieldDefinition",t.INPUT_VALUE_DEFINITION="InputValueDefinition",t.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",t.UNION_TYPE_DEFINITION="UnionTypeDefinition",t.ENUM_TYPE_DEFINITION="EnumTypeDefinition",t.ENUM_VALUE_DEFINITION="EnumValueDefinition",t.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",t.DIRECTIVE_DEFINITION="DirectiveDefinition",t.SCHEMA_EXTENSION="SchemaExtension",t.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",t.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",t.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",t.UNION_TYPE_EXTENSION="UnionTypeExtension",t.ENUM_TYPE_EXTENSION="EnumTypeExtension",t.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(R||(R={}));function Fr(t){return t===9||t===32}function ft(t){return t>=48&&t<=57}function ki(t){return t>=97&&t<=122||t>=65&&t<=90}function Ai(t){return ki(t)||t===95}function Qo(t){return ki(t)||ft(t)||t===95}function Xo(t){var e;let r=Number.MAX_SAFE_INTEGER,n=null,i=-1;for(let o=0;o<t.length;++o){var s;const l=t[o],c=Zo(l);c!==l.length&&(n=(s=n)!==null&&s!==void 0?s:o,i=o,o!==0&&c<r&&(r=c))}return t.map((o,l)=>l===0?o:o.slice(r)).slice((e=n)!==null&&e!==void 0?e:0,i+1)}function Zo(t){let e=0;for(;e<t.length&&Fr(t.charCodeAt(e));)++e;return e}function ea(t,e){const r=t.replace(/"""/g,'\\"""'),n=r.split(/\r\n|[\n\r]/g),i=n.length===1,s=n.length>1&&n.slice(1).every(h=>h.length===0||Fr(h.charCodeAt(0))),o=r.endsWith('\\"""'),l=t.endsWith('"')&&!o,c=t.endsWith("\\"),a=l||c,u=!i||t.length>70||a||s||o;let f="";const d=i&&Fr(t.charCodeAt(0));return(u&&!d||s)&&(f+=`
`),f+=r,(u||a)&&(f+=`
`),'"""'+f+'"""'}var T;(function(t){t.SOF="<SOF>",t.EOF="<EOF>",t.BANG="!",t.DOLLAR="$",t.AMP="&",t.PAREN_L="(",t.PAREN_R=")",t.SPREAD="...",t.COLON=":",t.EQUALS="=",t.AT="@",t.BRACKET_L="[",t.BRACKET_R="]",t.BRACE_L="{",t.PIPE="|",t.BRACE_R="}",t.NAME="Name",t.INT="Int",t.FLOAT="Float",t.STRING="String",t.BLOCK_STRING="BlockString",t.COMMENT="Comment"})(T||(T={}));class ta{constructor(e){const r=new wi(T.SOF,0,0,0,0);this.source=e,this.lastToken=r,this.token=r,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==T.EOF)do if(e.next)e=e.next;else{const r=na(this,e.end);e.next=r,r.prev=e,e=r}while(e.kind===T.COMMENT);return e}}function ra(t){return t===T.BANG||t===T.DOLLAR||t===T.AMP||t===T.PAREN_L||t===T.PAREN_R||t===T.SPREAD||t===T.COLON||t===T.EQUALS||t===T.AT||t===T.BRACKET_L||t===T.BRACKET_R||t===T.BRACE_L||t===T.PIPE||t===T.BRACE_R}function We(t){return t>=0&&t<=55295||t>=57344&&t<=1114111}function Kt(t,e){return Ii(t.charCodeAt(e))&&bi(t.charCodeAt(e+1))}function Ii(t){return t>=55296&&t<=56319}function bi(t){return t>=56320&&t<=57343}function Pe(t,e){const r=t.source.body.codePointAt(e);if(r===void 0)return T.EOF;if(r>=32&&r<=126){const n=String.fromCodePoint(r);return n==='"'?`'"'`:`"${n}"`}return"U+"+r.toString(16).toUpperCase().padStart(4,"0")}function te(t,e,r,n,i){const s=t.line,o=1+r-t.lineStart;return new wi(e,r,n,s,o,i)}function na(t,e){const r=t.source.body,n=r.length;let i=e;for(;i<n;){const s=r.charCodeAt(i);switch(s){case 65279:case 9:case 32:case 44:++i;continue;case 10:++i,++t.line,t.lineStart=i;continue;case 13:r.charCodeAt(i+1)===10?i+=2:++i,++t.line,t.lineStart=i;continue;case 35:return ia(t,i);case 33:return te(t,T.BANG,i,i+1);case 36:return te(t,T.DOLLAR,i,i+1);case 38:return te(t,T.AMP,i,i+1);case 40:return te(t,T.PAREN_L,i,i+1);case 41:return te(t,T.PAREN_R,i,i+1);case 46:if(r.charCodeAt(i+1)===46&&r.charCodeAt(i+2)===46)return te(t,T.SPREAD,i,i+3);break;case 58:return te(t,T.COLON,i,i+1);case 61:return te(t,T.EQUALS,i,i+1);case 64:return te(t,T.AT,i,i+1);case 91:return te(t,T.BRACKET_L,i,i+1);case 93:return te(t,T.BRACKET_R,i,i+1);case 123:return te(t,T.BRACE_L,i,i+1);case 124:return te(t,T.PIPE,i,i+1);case 125:return te(t,T.BRACE_R,i,i+1);case 34:return r.charCodeAt(i+1)===34&&r.charCodeAt(i+2)===34?la(t,i):oa(t,i)}if(ft(s)||s===45)return sa(t,i,s);if(Ai(s))return da(t,i);throw oe(t.source,i,s===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:We(s)||Kt(r,i)?`Unexpected character: ${Pe(t,i)}.`:`Invalid character: ${Pe(t,i)}.`)}return te(t,T.EOF,n,n)}function ia(t,e){const r=t.source.body,n=r.length;let i=e+1;for(;i<n;){const s=r.charCodeAt(i);if(s===10||s===13)break;if(We(s))++i;else if(Kt(r,i))i+=2;else break}return te(t,T.COMMENT,e,i,r.slice(e+1,i))}function sa(t,e,r){const n=t.source.body;let i=e,s=r,o=!1;if(s===45&&(s=n.charCodeAt(++i)),s===48){if(s=n.charCodeAt(++i),ft(s))throw oe(t.source,i,`Invalid number, unexpected digit after 0: ${Pe(t,i)}.`)}else i=Vr(t,i,s),s=n.charCodeAt(i);if(s===46&&(o=!0,s=n.charCodeAt(++i),i=Vr(t,i,s),s=n.charCodeAt(i)),(s===69||s===101)&&(o=!0,s=n.charCodeAt(++i),(s===43||s===45)&&(s=n.charCodeAt(++i)),i=Vr(t,i,s),s=n.charCodeAt(i)),s===46||Ai(s))throw oe(t.source,i,`Invalid number, expected digit but got: ${Pe(t,i)}.`);return te(t,o?T.FLOAT:T.INT,e,i,n.slice(e,i))}function Vr(t,e,r){if(!ft(r))throw oe(t.source,e,`Invalid number, expected digit but got: ${Pe(t,e)}.`);const n=t.source.body;let i=e+1;for(;ft(n.charCodeAt(i));)++i;return i}function oa(t,e){const r=t.source.body,n=r.length;let i=e+1,s=i,o="";for(;i<n;){const l=r.charCodeAt(i);if(l===34)return o+=r.slice(s,i),te(t,T.STRING,e,i+1,o);if(l===92){o+=r.slice(s,i);const c=r.charCodeAt(i+1)===117?r.charCodeAt(i+2)===123?aa(t,i):ca(t,i):ua(t,i);o+=c.value,i+=c.size,s=i;continue}if(l===10||l===13)break;if(We(l))++i;else if(Kt(r,i))i+=2;else throw oe(t.source,i,`Invalid character within String: ${Pe(t,i)}.`)}throw oe(t.source,i,"Unterminated string.")}function aa(t,e){const r=t.source.body;let n=0,i=3;for(;i<12;){const s=r.charCodeAt(e+i++);if(s===125){if(i<5||!We(n))break;return{value:String.fromCodePoint(n),size:i}}if(n=n<<4|pt(s),n<0)break}throw oe(t.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+i)}".`)}function ca(t,e){const r=t.source.body,n=_i(r,e+2);if(We(n))return{value:String.fromCodePoint(n),size:6};if(Ii(n)&&r.charCodeAt(e+6)===92&&r.charCodeAt(e+7)===117){const i=_i(r,e+8);if(bi(i))return{value:String.fromCodePoint(n,i),size:12}}throw oe(t.source,e,`Invalid Unicode escape sequence: "${r.slice(e,e+6)}".`)}function _i(t,e){return pt(t.charCodeAt(e))<<12|pt(t.charCodeAt(e+1))<<8|pt(t.charCodeAt(e+2))<<4|pt(t.charCodeAt(e+3))}function pt(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:-1}function ua(t,e){const r=t.source.body;switch(r.charCodeAt(e+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw oe(t.source,e,`Invalid character escape sequence: "${r.slice(e,e+2)}".`)}function la(t,e){const r=t.source.body,n=r.length;let i=t.lineStart,s=e+3,o=s,l="";const c=[];for(;s<n;){const a=r.charCodeAt(s);if(a===34&&r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34){l+=r.slice(o,s),c.push(l);const u=te(t,T.BLOCK_STRING,e,s+3,Xo(c).join(`
`));return t.line+=c.length-1,t.lineStart=i,u}if(a===92&&r.charCodeAt(s+1)===34&&r.charCodeAt(s+2)===34&&r.charCodeAt(s+3)===34){l+=r.slice(o,s),o=s+1,s+=4;continue}if(a===10||a===13){l+=r.slice(o,s),c.push(l),a===13&&r.charCodeAt(s+1)===10?s+=2:++s,l="",o=s,i=s;continue}if(We(a))++s;else if(Kt(r,s))s+=2;else throw oe(t.source,s,`Invalid character within String: ${Pe(t,s)}.`)}throw oe(t.source,s,"Unterminated string.")}function da(t,e){const r=t.source.body,n=r.length;let i=e+1;for(;i<n;){const s=r.charCodeAt(i);if(Qo(s))++i;else break}return te(t,T.NAME,e,i,r.slice(e,i))}const ha=10,Ni=2;function Br(t){return Yt(t,[])}function Yt(t,e){switch(typeof t){case"string":return JSON.stringify(t);case"function":return t.name?`[function ${t.name}]`:"[function]";case"object":return fa(t,e);default:return String(t)}}function fa(t,e){if(t===null)return"null";if(e.includes(t))return"[Circular]";const r=[...e,t];if(pa(t)){const n=t.toJSON();if(n!==t)return typeof n=="string"?n:Yt(n,r)}else if(Array.isArray(t))return ma(t,r);return va(t,r)}function pa(t){return typeof t.toJSON=="function"}function va(t,e){const r=Object.entries(t);return r.length===0?"{}":e.length>Ni?"["+ya(t)+"]":"{ "+r.map(([i,s])=>i+": "+Yt(s,e)).join(", ")+" }"}function ma(t,e){if(t.length===0)return"[]";if(e.length>Ni)return"[Array]";const r=Math.min(ha,t.length),n=t.length-r,i=[];for(let s=0;s<r;++s)i.push(Yt(t[s],e));return n===1?i.push("... 1 more item"):n>1&&i.push(`... ${n} more items`),"["+i.join(", ")+"]"}function ya(t){const e=Object.prototype.toString.call(t).replace(/^\[object /,"").replace(/]$/,"");if(e==="Object"&&typeof t.constructor=="function"){const r=t.constructor.name;if(typeof r=="string"&&r!=="")return r}return e}const ga=globalThis.process&&globalThis.process.env.NODE_ENV==="production"?function(e,r){return e instanceof r}:function(e,r){if(e instanceof r)return!0;if(typeof e=="object"&&e!==null){var n;const i=r.prototype[Symbol.toStringTag],s=Symbol.toStringTag in e?e[Symbol.toStringTag]:(n=e.constructor)===null||n===void 0?void 0:n.name;if(i===s){const o=Br(e);throw new Error(`Cannot use ${i} "${o}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class Ri{constructor(e,r="GraphQL request",n={line:1,column:1}){typeof e=="string"||Ht(!1,`Body must be a string. Received: ${Br(e)}.`),this.body=e,this.name=r,this.locationOffset=n,this.locationOffset.line>0||Ht(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||Ht(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function Ea(t){return ga(t,Ri)}function Ta(t,e){return new Sa(t,e).parseDocument()}class Sa{constructor(e,r={}){const n=Ea(e)?e:new Ri(e);this._lexer=new ta(n),this._options=r,this._tokenCounter=0}parseName(){const e=this.expectToken(T.NAME);return this.node(e,{kind:R.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:R.DOCUMENT,definitions:this.many(T.SOF,this.parseDefinition,T.EOF)})}parseDefinition(){if(this.peek(T.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),r=e?this._lexer.lookahead():this._lexer.token;if(r.kind===T.NAME){switch(r.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw oe(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(r.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(r)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(T.BRACE_L))return this.node(e,{kind:R.OPERATION_DEFINITION,operation:Je.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const r=this.parseOperationType();let n;return this.peek(T.NAME)&&(n=this.parseName()),this.node(e,{kind:R.OPERATION_DEFINITION,operation:r,name:n,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(T.NAME);switch(e.value){case"query":return Je.QUERY;case"mutation":return Je.MUTATION;case"subscription":return Je.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(T.PAREN_L,this.parseVariableDefinition,T.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:R.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(T.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(T.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(T.DOLLAR),this.node(e,{kind:R.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:R.SELECTION_SET,selections:this.many(T.BRACE_L,this.parseSelection,T.BRACE_R)})}parseSelection(){return this.peek(T.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,r=this.parseName();let n,i;return this.expectOptionalToken(T.COLON)?(n=r,i=this.parseName()):i=r,this.node(e,{kind:R.FIELD,alias:n,name:i,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(T.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const r=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(T.PAREN_L,r,T.PAREN_R)}parseArgument(e=!1){const r=this._lexer.token,n=this.parseName();return this.expectToken(T.COLON),this.node(r,{kind:R.ARGUMENT,name:n,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(T.SPREAD);const r=this.expectOptionalKeyword("on");return!r&&this.peek(T.NAME)?this.node(e,{kind:R.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:R.INLINE_FRAGMENT,typeCondition:r?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(e,{kind:R.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:R.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(e){const r=this._lexer.token;switch(r.kind){case T.BRACKET_L:return this.parseList(e);case T.BRACE_L:return this.parseObject(e);case T.INT:return this.advanceLexer(),this.node(r,{kind:R.INT,value:r.value});case T.FLOAT:return this.advanceLexer(),this.node(r,{kind:R.FLOAT,value:r.value});case T.STRING:case T.BLOCK_STRING:return this.parseStringLiteral();case T.NAME:switch(this.advanceLexer(),r.value){case"true":return this.node(r,{kind:R.BOOLEAN,value:!0});case"false":return this.node(r,{kind:R.BOOLEAN,value:!1});case"null":return this.node(r,{kind:R.NULL});default:return this.node(r,{kind:R.ENUM,value:r.value})}case T.DOLLAR:if(e)if(this.expectToken(T.DOLLAR),this._lexer.token.kind===T.NAME){const n=this._lexer.token.value;throw oe(this._lexer.source,r.start,`Unexpected variable "$${n}" in constant value.`)}else throw this.unexpected(r);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:R.STRING,value:e.value,block:e.kind===T.BLOCK_STRING})}parseList(e){const r=()=>this.parseValueLiteral(e);return this.node(this._lexer.token,{kind:R.LIST,values:this.any(T.BRACKET_L,r,T.BRACKET_R)})}parseObject(e){const r=()=>this.parseObjectField(e);return this.node(this._lexer.token,{kind:R.OBJECT,fields:this.any(T.BRACE_L,r,T.BRACE_R)})}parseObjectField(e){const r=this._lexer.token,n=this.parseName();return this.expectToken(T.COLON),this.node(r,{kind:R.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e)})}parseDirectives(e){const r=[];for(;this.peek(T.AT);)r.push(this.parseDirective(e));return r}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const r=this._lexer.token;return this.expectToken(T.AT),this.node(r,{kind:R.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let r;if(this.expectOptionalToken(T.BRACKET_L)){const n=this.parseTypeReference();this.expectToken(T.BRACKET_R),r=this.node(e,{kind:R.LIST_TYPE,type:n})}else r=this.parseNamedType();return this.expectOptionalToken(T.BANG)?this.node(e,{kind:R.NON_NULL_TYPE,type:r}):r}parseNamedType(){return this.node(this._lexer.token,{kind:R.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(T.STRING)||this.peek(T.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("schema");const n=this.parseConstDirectives(),i=this.many(T.BRACE_L,this.parseOperationTypeDefinition,T.BRACE_R);return this.node(e,{kind:R.SCHEMA_DEFINITION,description:r,directives:n,operationTypes:i})}parseOperationTypeDefinition(){const e=this._lexer.token,r=this.parseOperationType();this.expectToken(T.COLON);const n=this.parseNamedType();return this.node(e,{kind:R.OPERATION_TYPE_DEFINITION,operation:r,type:n})}parseScalarTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("scalar");const n=this.parseName(),i=this.parseConstDirectives();return this.node(e,{kind:R.SCALAR_TYPE_DEFINITION,description:r,name:n,directives:i})}parseObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("type");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:R.OBJECT_TYPE_DEFINITION,description:r,name:n,interfaces:i,directives:s,fields:o})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(T.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(T.BRACE_L,this.parseFieldDefinition,T.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseName(),i=this.parseArgumentDefs();this.expectToken(T.COLON);const s=this.parseTypeReference(),o=this.parseConstDirectives();return this.node(e,{kind:R.FIELD_DEFINITION,description:r,name:n,arguments:i,type:s,directives:o})}parseArgumentDefs(){return this.optionalMany(T.PAREN_L,this.parseInputValueDef,T.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseName();this.expectToken(T.COLON);const i=this.parseTypeReference();let s;this.expectOptionalToken(T.EQUALS)&&(s=this.parseConstValueLiteral());const o=this.parseConstDirectives();return this.node(e,{kind:R.INPUT_VALUE_DEFINITION,description:r,name:n,type:i,defaultValue:s,directives:o})}parseInterfaceTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("interface");const n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseConstDirectives(),o=this.parseFieldsDefinition();return this.node(e,{kind:R.INTERFACE_TYPE_DEFINITION,description:r,name:n,interfaces:i,directives:s,fields:o})}parseUnionTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("union");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseUnionMemberTypes();return this.node(e,{kind:R.UNION_TYPE_DEFINITION,description:r,name:n,directives:i,types:s})}parseUnionMemberTypes(){return this.expectOptionalToken(T.EQUALS)?this.delimitedMany(T.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("enum");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseEnumValuesDefinition();return this.node(e,{kind:R.ENUM_TYPE_DEFINITION,description:r,name:n,directives:i,values:s})}parseEnumValuesDefinition(){return this.optionalMany(T.BRACE_L,this.parseEnumValueDefinition,T.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,r=this.parseDescription(),n=this.parseEnumValueName(),i=this.parseConstDirectives();return this.node(e,{kind:R.ENUM_VALUE_DEFINITION,description:r,name:n,directives:i})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw oe(this._lexer.source,this._lexer.token.start,`${$t(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("input");const n=this.parseName(),i=this.parseConstDirectives(),s=this.parseInputFieldsDefinition();return this.node(e,{kind:R.INPUT_OBJECT_TYPE_DEFINITION,description:r,name:n,directives:i,fields:s})}parseInputFieldsDefinition(){return this.optionalMany(T.BRACE_L,this.parseInputValueDef,T.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===T.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const r=this.parseConstDirectives(),n=this.optionalMany(T.BRACE_L,this.parseOperationTypeDefinition,T.BRACE_R);if(r.length===0&&n.length===0)throw this.unexpected();return this.node(e,{kind:R.SCHEMA_EXTENSION,directives:r,operationTypes:n})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const r=this.parseName(),n=this.parseConstDirectives();if(n.length===0)throw this.unexpected();return this.node(e,{kind:R.SCALAR_TYPE_EXTENSION,name:r,directives:n})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:R.OBJECT_TYPE_EXTENSION,name:r,interfaces:n,directives:i,fields:s})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const r=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();if(n.length===0&&i.length===0&&s.length===0)throw this.unexpected();return this.node(e,{kind:R.INTERFACE_TYPE_EXTENSION,name:r,interfaces:n,directives:i,fields:s})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseUnionMemberTypes();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:R.UNION_TYPE_EXTENSION,name:r,directives:n,types:i})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseEnumValuesDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:R.ENUM_TYPE_EXTENSION,name:r,directives:n,values:i})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const r=this.parseName(),n=this.parseConstDirectives(),i=this.parseInputFieldsDefinition();if(n.length===0&&i.length===0)throw this.unexpected();return this.node(e,{kind:R.INPUT_OBJECT_TYPE_EXTENSION,name:r,directives:n,fields:i})}parseDirectiveDefinition(){const e=this._lexer.token,r=this.parseDescription();this.expectKeyword("directive"),this.expectToken(T.AT);const n=this.parseName(),i=this.parseArgumentDefs(),s=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const o=this.parseDirectiveLocations();return this.node(e,{kind:R.DIRECTIVE_DEFINITION,description:r,name:n,arguments:i,repeatable:s,locations:o})}parseDirectiveLocations(){return this.delimitedMany(T.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,r=this.parseName();if(Object.prototype.hasOwnProperty.call(jr,r.value))return r;throw this.unexpected(e)}node(e,r){return this._options.noLocation!==!0&&(r.loc=new Jo(e,this._lexer.lastToken,this._lexer.source)),r}peek(e){return this._lexer.token.kind===e}expectToken(e){const r=this._lexer.token;if(r.kind===e)return this.advanceLexer(),r;throw oe(this._lexer.source,r.start,`Expected ${Di(e)}, found ${$t(r)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e?(this.advanceLexer(),!0):!1}expectKeyword(e){const r=this._lexer.token;if(r.kind===T.NAME&&r.value===e)this.advanceLexer();else throw oe(this._lexer.source,r.start,`Expected "${e}", found ${$t(r)}.`)}expectOptionalKeyword(e){const r=this._lexer.token;return r.kind===T.NAME&&r.value===e?(this.advanceLexer(),!0):!1}unexpected(e){const r=e!=null?e:this._lexer.token;return oe(this._lexer.source,r.start,`Unexpected ${$t(r)}.`)}any(e,r,n){this.expectToken(e);const i=[];for(;!this.expectOptionalToken(n);)i.push(r.call(this));return i}optionalMany(e,r,n){if(this.expectOptionalToken(e)){const i=[];do i.push(r.call(this));while(!this.expectOptionalToken(n));return i}return[]}many(e,r,n){this.expectToken(e);const i=[];do i.push(r.call(this));while(!this.expectOptionalToken(n));return i}delimitedMany(e,r){this.expectOptionalToken(e);const n=[];do n.push(r.call(this));while(this.expectOptionalToken(e));return n}advanceLexer(){const{maxTokens:e}=this._options,r=this._lexer.advance();if(e!==void 0&&r.kind!==T.EOF&&(++this._tokenCounter,this._tokenCounter>e))throw oe(this._lexer.source,r.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function $t(t){const e=t.value;return Di(t.kind)+(e!=null?` "${e}"`:"")}function Di(t){return ra(t)?`"${t}"`:t}function wa(t){return`"${t.replace(xa,Oa)}"`}const xa=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function Oa(t){return ka[t.charCodeAt(0)]}const ka=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],Aa=Object.freeze({});function Ia(t,e,r=xi){const n=new Map;for(const g of Object.values(R))n.set(g,ba(e,g));let i,s=Array.isArray(t),o=[t],l=-1,c=[],a=t,u,f;const d=[],h=[];do{l++;const g=l===o.length,x=g&&c.length!==0;if(g){if(u=h.length===0?void 0:d[d.length-1],a=f,f=h.pop(),x)if(s){a=a.slice();let k=0;for(const[C,b]of c){const _=C-k;b===null?(a.splice(_,1),k++):a[_]=b}}else{a=Object.defineProperties({},Object.getOwnPropertyDescriptors(a));for(const[k,C]of c)a[k]=C}l=i.index,o=i.keys,c=i.edits,s=i.inArray,i=i.prev}else if(f){if(u=s?l:o[l],a=f[u],a==null)continue;d.push(u)}let O;if(!Array.isArray(a)){var p,v;Oi(a)||Ht(!1,`Invalid AST Node: ${Br(a)}.`);const k=g?(p=n.get(a.kind))===null||p===void 0?void 0:p.leave:(v=n.get(a.kind))===null||v===void 0?void 0:v.enter;if(O=k==null?void 0:k.call(e,a,u,f,d,h),O===Aa)break;if(O===!1){if(!g){d.pop();continue}}else if(O!==void 0&&(c.push([u,O]),!g))if(Oi(O))a=O;else{d.pop();continue}}if(O===void 0&&x&&c.push([u,a]),g)d.pop();else{var E;i={inArray:s,index:l,keys:o,edits:c,prev:i},s=Array.isArray(a),o=s?a:(E=r[a.kind])!==null&&E!==void 0?E:[],l=-1,c=[],f&&h.push(f),f=a}}while(i!==void 0);return c.length!==0?c[c.length-1][1]:t}function ba(t,e){const r=t[e];return typeof r=="object"?r:typeof r=="function"?{enter:r,leave:void 0}:{enter:t.enter,leave:t.leave}}function _a(t){return Ia(t,Ra)}const Na=80,Ra={Name:{leave:t=>t.value},Variable:{leave:t=>"$"+t.name},Document:{leave:t=>A(t.definitions,`

`)},OperationDefinition:{leave(t){const e=U("(",A(t.variableDefinitions,", "),")"),r=A([t.operation,A([t.name,e]),A(t.directives," ")]," ");return(r==="query"?"":r+" ")+t.selectionSet}},VariableDefinition:{leave:({variable:t,type:e,defaultValue:r,directives:n})=>t+": "+e+U(" = ",r)+U(" ",A(n," "))},SelectionSet:{leave:({selections:t})=>ye(t)},Field:{leave({alias:t,name:e,arguments:r,directives:n,selectionSet:i}){const s=U("",t,": ")+e;let o=s+U("(",A(r,", "),")");return o.length>Na&&(o=s+U(`(
`,qt(A(r,`
`)),`
)`)),A([o,A(n," "),i]," ")}},Argument:{leave:({name:t,value:e})=>t+": "+e},FragmentSpread:{leave:({name:t,directives:e})=>"..."+t+U(" ",A(e," "))},InlineFragment:{leave:({typeCondition:t,directives:e,selectionSet:r})=>A(["...",U("on ",t),A(e," "),r]," ")},FragmentDefinition:{leave:({name:t,typeCondition:e,variableDefinitions:r,directives:n,selectionSet:i})=>`fragment ${t}${U("(",A(r,", "),")")} on ${e} ${U("",A(n," ")," ")}`+i},IntValue:{leave:({value:t})=>t},FloatValue:{leave:({value:t})=>t},StringValue:{leave:({value:t,block:e})=>e?ea(t):wa(t)},BooleanValue:{leave:({value:t})=>t?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:t})=>t},ListValue:{leave:({values:t})=>"["+A(t,", ")+"]"},ObjectValue:{leave:({fields:t})=>"{"+A(t,", ")+"}"},ObjectField:{leave:({name:t,value:e})=>t+": "+e},Directive:{leave:({name:t,arguments:e})=>"@"+t+U("(",A(e,", "),")")},NamedType:{leave:({name:t})=>t},ListType:{leave:({type:t})=>"["+t+"]"},NonNullType:{leave:({type:t})=>t+"!"},SchemaDefinition:{leave:({description:t,directives:e,operationTypes:r})=>U("",t,`
`)+A(["schema",A(e," "),ye(r)]," ")},OperationTypeDefinition:{leave:({operation:t,type:e})=>t+": "+e},ScalarTypeDefinition:{leave:({description:t,name:e,directives:r})=>U("",t,`
`)+A(["scalar",e,A(r," ")]," ")},ObjectTypeDefinition:{leave:({description:t,name:e,interfaces:r,directives:n,fields:i})=>U("",t,`
`)+A(["type",e,U("implements ",A(r," & ")),A(n," "),ye(i)]," ")},FieldDefinition:{leave:({description:t,name:e,arguments:r,type:n,directives:i})=>U("",t,`
`)+e+(Pi(r)?U(`(
`,qt(A(r,`
`)),`
)`):U("(",A(r,", "),")"))+": "+n+U(" ",A(i," "))},InputValueDefinition:{leave:({description:t,name:e,type:r,defaultValue:n,directives:i})=>U("",t,`
`)+A([e+": "+r,U("= ",n),A(i," ")]," ")},InterfaceTypeDefinition:{leave:({description:t,name:e,interfaces:r,directives:n,fields:i})=>U("",t,`
`)+A(["interface",e,U("implements ",A(r," & ")),A(n," "),ye(i)]," ")},UnionTypeDefinition:{leave:({description:t,name:e,directives:r,types:n})=>U("",t,`
`)+A(["union",e,A(r," "),U("= ",A(n," | "))]," ")},EnumTypeDefinition:{leave:({description:t,name:e,directives:r,values:n})=>U("",t,`
`)+A(["enum",e,A(r," "),ye(n)]," ")},EnumValueDefinition:{leave:({description:t,name:e,directives:r})=>U("",t,`
`)+A([e,A(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:t,name:e,directives:r,fields:n})=>U("",t,`
`)+A(["input",e,A(r," "),ye(n)]," ")},DirectiveDefinition:{leave:({description:t,name:e,arguments:r,repeatable:n,locations:i})=>U("",t,`
`)+"directive @"+e+(Pi(r)?U(`(
`,qt(A(r,`
`)),`
)`):U("(",A(r,", "),")"))+(n?" repeatable":"")+" on "+A(i," | ")},SchemaExtension:{leave:({directives:t,operationTypes:e})=>A(["extend schema",A(t," "),ye(e)]," ")},ScalarTypeExtension:{leave:({name:t,directives:e})=>A(["extend scalar",t,A(e," ")]," ")},ObjectTypeExtension:{leave:({name:t,interfaces:e,directives:r,fields:n})=>A(["extend type",t,U("implements ",A(e," & ")),A(r," "),ye(n)]," ")},InterfaceTypeExtension:{leave:({name:t,interfaces:e,directives:r,fields:n})=>A(["extend interface",t,U("implements ",A(e," & ")),A(r," "),ye(n)]," ")},UnionTypeExtension:{leave:({name:t,directives:e,types:r})=>A(["extend union",t,A(e," "),U("= ",A(r," | "))]," ")},EnumTypeExtension:{leave:({name:t,directives:e,values:r})=>A(["extend enum",t,A(e," "),ye(r)]," ")},InputObjectTypeExtension:{leave:({name:t,directives:e,fields:r})=>A(["extend input",t,A(e," "),ye(r)]," ")}};function A(t,e=""){var r;return(r=t==null?void 0:t.filter(n=>n).join(e))!==null&&r!==void 0?r:""}function ye(t){return U(`{
`,qt(A(t,`
`)),`
}`)}function U(t,e,r=""){return e!=null&&e!==""?t+e+r:""}function qt(t){return U("  ",t.replace(/\n/g,`
  `))}function Pi(t){var e;return(e=t==null?void 0:t.some(r=>r.includes(`
`)))!==null&&e!==void 0?e:!1}var Da=Object.defineProperty,Pa=(t,e,r)=>e in t?Da(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qe=(t,e,r)=>Pa(t,typeof e!="symbol"?e+"":e,r);function Ca(t,e,r){return t.document?t:{document:t,variables:e,config:r}}function Ci(t){var e;let r;const n=t.definitions.filter(i=>i.kind==="OperationDefinition");return n.length===1&&(r=(e=n[0].name)==null?void 0:e.value),r}function La(t){if(typeof t=="string"){let r;try{const n=Ta(t);r=Ci(n)}catch{}return{query:t,operationName:r}}const e=Ci(t);return{query:_a(t),operationName:e}}let Ua=class{constructor(e){Qe(this,"_url"),Qe(this,"accessToken"),Qe(this,"adminSecret"),Qe(this,"headers",{}),Qe(this,"isAccessTokenValidOrNull",()=>{if(!this.accessToken)return!0;try{const i=Xt(this.accessToken);return i.exp!=null&&i.exp*1e3>Date.now()}catch(i){return console.error("Error decoding token:",i),!1}}),Qe(this,"awaitForValidAccessTokenOrNull",async()=>{if(this.isAccessTokenValidOrNull())return!0;const i=()=>this.isAccessTokenValidOrNull()?Promise.resolve(!0):new Promise(s=>{setTimeout(()=>i().then(s),100)});return i()});const{url:r,adminSecret:n}=e;this._url=r,this.accessToken=null,this.adminSecret=n}async request(e,...r){const[n,i]=r,s=Ca(e,n,i),{headers:o,...l}=i||{},{query:c,operationName:a}=La(s.document);typeof process!="undefined"&&!process.env.TEST_MODE&&await this.awaitForValidAccessTokenOrNull();try{const u=await gi(this.httpUrl,{method:"POST",body:JSON.stringify({operationName:a,query:c,variables:n}),headers:{"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...this.headers,...o},...l});if(!u.ok)return{data:null,error:{error:u.statusText,message:u.statusText,status:u.status}};const{data:f,errors:d}=await u.json();return d?{data:null,error:d}:typeof f!="object"||Array.isArray(f)||f===null?{data:null,error:{error:"invalid-response",message:"incorrect response data from GraphQL server",status:0}}:{data:f,error:null}}catch(u){const f=u;return{data:null,error:{message:f.message,status:f.name==="AbortError"?0:500,error:f.name==="AbortError"?"abort-error":"unknown"}}}}get httpUrl(){return this._url}get wsUrl(){return this._url.replace(/^(http)(s?):\/\//,"ws$2://")}get url(){return this._url}getUrl(){return this._url}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){const e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}};var Ma=Object.defineProperty,ja=(t,e,r)=>e in t?Ma(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,we=(t,e,r)=>ja(t,typeof e!="symbol"?e+"":e,r);const Fa=/^((?<protocol>http[s]?):\/\/)?(?<host>(localhost|local))(:(?<port>(\d+|__\w+__)))?$/;function zt(t,e){const{subdomain:r,region:n}=t;if(!r)throw new Error("A `subdomain` must be set.");const i=r.match(Fa);if(i!=null&&i.groups){const{protocol:s,host:o,port:l}=i.groups;return Ga(e)||(o==="localhost"?(console.warn('The `subdomain` is set to "localhost". Support for this will be removed in a future release. Please use "local" instead.'),`${s||"http"}://localhost:${l||1337}/v1/${e}`):l?`${s||"https"}://local.${e}.local.nhost.run:${l}/v1`:`${s||"https"}://local.${e}.local.nhost.run/v1`)}if(!n)throw new Error('`region` must be set when using a `subdomain` other than "local".');return`https://${r}.${e}.${n}.nhost.run/v1`}function Va(){return typeof window!="undefined"}function Ba(){return typeof process!="undefined"&&process.env}function Ga(t){return Va()||!Ba()?null:process.env[`NHOST_${t.toUpperCase()}_URL`]}function Ha(t,e){const r=e.startsWith("/")?e:`/${e}`;return t+r}function Ka(t){const e="subdomain"in t?zt(t,"auth"):t.authUrl,{subdomain:r,region:n}=t;if(!e)throw new Error("Please provide `subdomain` or `authUrl`.");return new Po({url:e,broadcastKey:`${r}${n!=null?n:"local"}`,...t})}function Ya(t){const e="subdomain"in t?zt(t,"functions"):t.functionsUrl;if(!e)throw new Error("Please provide `subdomain` or `functionsUrl`.");return new $a({url:e,...t})}class $a{constructor(e){we(this,"url"),we(this,"accessToken"),we(this,"adminSecret"),we(this,"headers",{});const{url:r,adminSecret:n}=e;this.url=r,this.accessToken=null,this.adminSecret=n}async call(e,r,n){var i,s;const o={"Content-Type":"application/json",...this.generateAccessTokenHeaders(),...n==null?void 0:n.headers,...this.headers},l=Ha(this.url,e);try{const c=await gi(l,{body:r?JSON.stringify(r):null,headers:o,method:"POST"});if(!c.ok){let u;return(i=c.headers.get("content-type"))!=null&&i.includes("application/json")?u=await c.json():u=await c.text(),{res:null,error:{message:u,error:c.statusText,status:c.status}}}let a;return(s=c.headers.get("content-type"))!=null&&s.includes("application/json")?a=await c.json():a=await c.text(),{res:{data:a,status:c.status,statusText:c.statusText},error:null}}catch(c){const a=c;return{res:null,error:{message:a.message,status:a.name==="AbortError"?0:500,error:a.name==="AbortError"?"abort-error":"unknown"}}}}setAccessToken(e){if(!e){this.accessToken=null;return}this.accessToken=e}getHeaders(){return this.headers}setHeaders(e){e&&(this.headers={...this.headers,...e})}unsetHeaders(){const e=this.headers["x-hasura-role"];this.headers=e?{"x-hasura-role":e}:{}}generateAccessTokenHeaders(){return this.adminSecret?{"x-hasura-admin-secret":this.adminSecret}:this.accessToken?{Authorization:`Bearer ${this.accessToken}`}:{}}}function qa(t){const e="subdomain"in t?zt(t,"graphql"):t.graphqlUrl;if(!e)throw new Error("Please provide `subdomain` or `graphqlUrl`.");return new Ua({url:e,...t})}function za(t){const e="subdomain"in t?zt(t,"storage"):t.storageUrl;if(!e)throw new Error("Please provide `subdomain` or `storageUrl`.");return new jo({url:e,...t})}class Ja{constructor({refreshIntervalTime:e,clientStorage:r,clientStorageType:n,autoRefreshToken:i,autoSignIn:s,adminSecret:o,devTools:l,start:c=!0,...a}){we(this,"auth"),we(this,"storage"),we(this,"functions"),we(this,"graphql"),we(this,"_adminSecret"),we(this,"devTools"),this.auth=Ka({refreshIntervalTime:e,clientStorage:r,clientStorageType:n,autoRefreshToken:i,autoSignIn:s,start:c,...a}),this.storage=za({adminSecret:o,...a}),this.functions=Ya({adminSecret:o,...a}),this.graphql=qa({adminSecret:o,...a}),this.auth.onAuthStateChanged((u,f)=>{if(u==="SIGNED_OUT"){this.storage.setAccessToken(void 0),this.functions.setAccessToken(void 0),this.graphql.setAccessToken(void 0);return}const d=f==null?void 0:f.accessToken;this.storage.setAccessToken(d),this.functions.setAccessToken(d),this.graphql.setAccessToken(d)}),this.auth.onTokenChanged(u=>{const f=u==null?void 0:u.accessToken;this.storage.setAccessToken(f),this.functions.setAccessToken(f),this.graphql.setAccessToken(f)}),this._adminSecret=o,this.devTools=l}get adminSecret(){return this._adminSecret}set adminSecret(e){this._adminSecret=e,this.storage.setAdminSecret(e)}setRole(e){this.graphql.setHeaders({"x-hasura-role":e}),this.storage.setHeaders({"x-hasura-role":e}),this.functions.setHeaders({"x-hasura-role":e})}unsetRole(){this.graphql.setHeaders((({"x-hasura-role":e,...r})=>r)(this.graphql.getHeaders())),this.storage.setHeaders((({"x-hasura-role":e,...r})=>r)(this.storage.getHeaders())),this.functions.setHeaders((({"x-hasura-role":e,...r})=>r)(this.functions.getHeaders()))}}const Li=Ja;class Wa extends Li{constructor(e){super({...e,start:!1})}}var Gr={exports:{}},Hr={},Jt={exports:{}},Kr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ui;function Qa(){if(Ui)return Kr;Ui=1;var t=P;function e(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function l(f,d){var h=d(),p=n({inst:{value:h,getSnapshot:d}}),v=p[0].inst,E=p[1];return s(function(){v.value=h,v.getSnapshot=d,c(v)&&E({inst:v})},[f,h,d]),i(function(){return c(v)&&E({inst:v}),f(function(){c(v)&&E({inst:v})})},[f]),o(h),h}function c(f){var d=f.getSnapshot;f=f.value;try{var h=d();return!r(f,h)}catch{return!0}}function a(f,d){return d()}var u=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?a:l;return Kr.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:u,Kr}var Yr={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mi;function Xa(){return Mi||(Mi=1,process.env.NODE_ENV!=="production"&&function(){function t(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}function e(h,p){u||i.startTransition===void 0||(u=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var v=p();if(!f){var E=p();s(v,E)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),f=!0)}E=o({inst:{value:v,getSnapshot:p}});var g=E[0].inst,x=E[1];return c(function(){g.value=v,g.getSnapshot=p,r(g)&&x({inst:g})},[h,v,p]),l(function(){return r(g)&&x({inst:g}),h(function(){r(g)&&x({inst:g})})},[h]),a(v),v}function r(h){var p=h.getSnapshot;h=h.value;try{var v=p();return!s(h,v)}catch{return!0}}function n(h,p){return p()}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var i=P,s=typeof Object.is=="function"?Object.is:t,o=i.useState,l=i.useEffect,c=i.useLayoutEffect,a=i.useDebugValue,u=!1,f=!1,d=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?n:e;Yr.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:d,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),Yr}var ji;function Fi(){return ji||(ji=1,process.env.NODE_ENV==="production"?Jt.exports=Qa():Jt.exports=Xa()),Jt.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vi;function Za(){if(Vi)return Hr;Vi=1;var t=P,e=Fi();function r(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,l=t.useMemo,c=t.useDebugValue;return Hr.useSyncExternalStoreWithSelector=function(a,u,f,d,h){var p=s(null);if(p.current===null){var v={hasValue:!1,value:null};p.current=v}else v=p.current;p=l(function(){function g(b){if(!x){if(x=!0,O=b,b=d(b),h!==void 0&&v.hasValue){var _=v.value;if(h(_,b))return k=_}return k=b}if(_=k,n(O,b))return _;var M=d(b);return h!==void 0&&h(_,M)?(O=b,_):(O=b,k=M)}var x=!1,O,k,C=f===void 0?null:f;return[function(){return g(u())},C===null?void 0:function(){return g(C())}]},[u,f,d,h]);var E=i(a,p[0],p[1]);return o(function(){v.hasValue=!0,v.value=E},[E]),c(E),E},Hr}var $r={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bi;function ec(){return Bi||(Bi=1,process.env.NODE_ENV!=="production"&&function(){function t(a,u){return a===u&&(a!==0||1/a===1/u)||a!==a&&u!==u}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var e=P,r=Fi(),n=typeof Object.is=="function"?Object.is:t,i=r.useSyncExternalStore,s=e.useRef,o=e.useEffect,l=e.useMemo,c=e.useDebugValue;$r.useSyncExternalStoreWithSelector=function(a,u,f,d,h){var p=s(null);if(p.current===null){var v={hasValue:!1,value:null};p.current=v}else v=p.current;p=l(function(){function g(b){if(!x){if(x=!0,O=b,b=d(b),h!==void 0&&v.hasValue){var _=v.value;if(h(_,b))return k=_}return k=b}if(_=k,n(O,b))return _;var M=d(b);return h!==void 0&&h(_,M)?(O=b,_):(O=b,k=M)}var x=!1,O,k,C=f===void 0?null:f;return[function(){return g(u())},C===null?void 0:function(){return g(C())}]},[u,f,d,h]);var E=i(a,p[0],p[1]);return o(function(){v.hasValue=!0,v.value=E},[E]),c(E),E},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),$r}process.env.NODE_ENV==="production"?Gr.exports=Za():Gr.exports=ec();var tc=Gr.exports,rc=P.useLayoutEffect;function Gi(t){var e=Wi.useRef();return e.current||(e.current={v:t()}),e.current.v}var Wt=function(){return Wt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Wt.apply(this,arguments)},nc=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Hi=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s};function ic(t,e){var r=Gi(function(){return typeof t=="function"?t():t});if(process.env.NODE_ENV!=="production"&&typeof t!="function"){var n=Hi(P.useState(r),1),i=n[0];t!==i&&console.warn("Machine given to `useMachine` has changed between renders. This is not supported and might lead to unexpected results.\nPlease make sure that you pass the same Machine as argument each time.")}var s=e.context,o=e.guards,l=e.actions,c=e.activities,a=e.services,u=e.delays;e.state;var f=nc(e,["context","guards","actions","activities","services","delays","state"]),d=Gi(function(){var h={context:s,guards:o,actions:l,activities:c,services:a,delays:u},p=r.withConfig(h,function(){return Wt(Wt({},r.context),s)});return De(p,f)});return rc(function(){Object.assign(d.machine.options.actions,l),Object.assign(d.machine.options.guards,o),Object.assign(d.machine.options.activities,c),Object.assign(d.machine.options.services,a),Object.assign(d.machine.options.delays,u)},[l,o,c,a,u]),d}function _e(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Hi(e,2),i=n[0],s=i===void 0?{}:i,o=n[1],l=ic(t,s);return P.useEffect(function(){if(o){var c=l.subscribe(nt(o));return function(){c.unsubscribe()}}},[o]),P.useEffect(function(){var c=s.state;return l.start(c?pe.create(c):void 0),function(){l.stop(),l.status=ee.NotStarted}},[]),l}function sc(t){return t.status!==0?t.getSnapshot():t.machine.initialState}function oc(t){return"state"in t&&"machine"in t}function ac(t){return"state"in t}var cc=function(t,e){return t===e},uc=function(t,e){if(oc(t)){if(t.status===0&&e.current)return e.current;var r=sc(t);return e.current=t.status===0?r:null,r}return ac(t)?t.state:void 0};function y(t,e,r,n){r===void 0&&(r=cc);var i=P.useRef(null),s=P.useCallback(function(c){var a=t.subscribe(c).unsubscribe;return a},[t]),o=P.useCallback(function(){return uc(t,i)},[t,n]),l=tc.useSyncExternalStoreWithSelector(s,o,o,e,r);return l}const vt=P.createContext({}),Ki=({nhost:t,initial:e,...r})=>{const n=_e(t.auth.client.machine,{devTools:t.devTools});t.auth.client.start({interpreter:n,initialSession:e,devTools:t.devTools});const i=P.useRef(!0);return P.useEffect(()=>{i.current?i.current=!1:e&&n.send("SESSION_UPDATE",{data:{session:e}})},[e,n]),zi.jsx(vt.Provider,{value:t,children:r.children})},lc=Ki,J=()=>{var r;const e=(r=P.useContext(vt).auth)==null?void 0:r.client.interpreter;if(!e)throw Error("Could not find the Nhost auth client. Did you wrap your app in <NhostProvider />?");return e},qr=()=>{const t=J();return y(t,e=>({isAuthenticated:e.matches({authentication:"signedIn"}),isLoading:e.hasTag("loading"),error:e.context.errors.authentication||null,isError:e.matches({authentication:{signedOut:"failed"}}),connectionAttempts:e.context.importTokenAttempts}),(e,r)=>e.isAuthenticated===r.isAuthenticated&&e.isLoading===r.isLoading&&e.connectionAttempts===r.connectionAttempts)};function dc({children:t}){const{isAuthenticated:e}=qr();return e?P.createElement(P.Fragment,null,t):null}function hc({children:t}){const{isAuthenticated:e}=qr();return e?null:P.createElement(P.Fragment,null,t)}const zr=()=>{const t=J();return y(t,e=>e.context.accessToken.value)},ge=()=>P.useContext(vt),fc=()=>{const t=ge(),[e,r]=P.useState(null),n=!e,i=!!e,[s,o]=P.useState(!1);return{add:async c=>{o(!0);const a=await Wn(t.auth.client,c),{error:u}=a;return u&&r(u),o(!1),a},isLoading:s,isSuccess:n,isError:i,error:e}},pc=()=>{const t=J(),[e,r]=P.useState(!!t.status&&t.getSnapshot().matches({authentication:"signedIn"}));return P.useEffect(()=>t.subscribe(i=>{const s=i.matches({authentication:"signedIn"});r(s)}).unsubscribe,[t]),e};function vc(t){const e=ge(),r=P.useMemo(()=>$n(e.auth.client),[e]),n=_e(r),i=y(n,a=>a.matches("requesting")),s=y(n,a=>a.context.error),o=y(n,a=>a.matches("idle.error")),l=y(n,a=>a.matches("idle.success"));return{changeEmail:P.useCallback(async(a,u=t)=>Qn(n,a,u),[n,t]),isLoading:i,needsEmailVerification:l,isError:o,error:s}}const mc=()=>{const t=ge(),e=P.useMemo(()=>qn(t.auth.client),[t]),r=_e(e),n=y(r,c=>c.matches({idle:"error"})),i=y(r,c=>c.matches({idle:"success"})),s=y(r,c=>c.context.error),o=y(r,c=>c.matches("requesting"));return{changePassword:c=>Xn(r,c),isLoading:o,isSuccess:i,isError:n,error:s}},yc=()=>{const t=ge(),e=P.useMemo(()=>Io(t.auth.client),[t]),r=_e(e),n=y(r,v=>v.matches({idle:"error"})||v.matches({generated:{idle:"error"}})),i=y(r,v=>v.matches("generating")),s=y(r,v=>v.matches("generated")),o=y(r,v=>v.matches({generated:"activating"})),l=y(r,v=>v.matches({generated:"activated"})),c=y(r,v=>v.matches("disabling")),a=y(r,v=>v.context.error),u=y(r,v=>v.context.imageUrl||""),f=y(r,v=>v.context.secret||"");return{generateQrCode:()=>_o(r),isGenerating:i,qrCodeDataUrl:u,isGenerated:s,activateMfa:v=>No(r,v),isActivating:o,isActivated:l,isDisabling:c,isError:n,error:a,disableMfa:v=>Ro(r,v),totpSecret:f}},Yi=()=>{const t=zr();return t?Xt(t):null},$i=t=>{const e=ge(),r=p=>{t.send({type:"ADD",file:p.file,bucketId:p.bucketId||d})},n=p=>Vo({url:e.storage.url,accessToken:e.auth.getAccessToken(),adminSecret:e.adminSecret,...p},t),i=()=>{t.send("CANCEL")},s=()=>{t.send("DESTROY")},o=y(t,p=>p.matches("uploading")),l=y(t,p=>p.matches("uploaded")),c=y(t,p=>p.matches("error")),a=y(t,p=>p.context.error||null),u=y(t,p=>p.context.progress),f=y(t,p=>p.context.id),d=y(t,p=>p.context.bucketId),h=y(t,p=>{var v;return(v=p.context.file)==null?void 0:v.name});return{add:r,upload:n,cancel:i,destroy:s,isUploaded:l,isUploading:o,isError:c,error:a,progress:u,id:f,bucketId:d,name:h}},gc=()=>{const t=_e(mi);return $i(t)},Jr=()=>{const t=Yi();return(t==null?void 0:t["https://hasura.io/jwt/claims"])||null},Ec=t=>{const e=Jr();return(e==null?void 0:e[t.startsWith("x-hasura-")?t:`x-hasura-${t}`])||null},Tc=()=>{const t=ge(),[e,r]=P.useState([]),n=_e(Fo,{},h=>{h.event.type==="UPLOAD_ERROR"?r(h.context.files.filter(p=>{var v;return(v=p.getSnapshot())==null?void 0:v.context.error})):(h.matches("uploaded")||h.event.type==="CLEAR")&&e.length>0&&r([])}),i=h=>{n.send({type:"ADD",...h})},s=h=>Bo({url:t.storage.url,accessToken:t.auth.getAccessToken(),adminSecret:t.adminSecret,...h},n),o=()=>{n.send("CANCEL")},l=()=>{n.send("CLEAR")},c=y(n,h=>h.matches("uploading")),a=y(n,h=>h.matches("uploaded")),u=y(n,h=>h.matches("error")),f=y(n,h=>h.context.progress),d=y(n,h=>h.context.files);return{upload:s,add:i,clear:l,cancel:o,progress:f,isUploaded:a,isUploading:c,files:d,isError:u,errors:e}},Sc=t=>{const[e,r]=P.useState(!0),n=zr();P.useEffect(()=>{r(!1)},[]);const i=P.useContext(vt);return new Proxy({},{get(s,o){let l=`${i.auth.client.backendUrl}/signin/provider/${o}`;const c=t!=null&&t.connect?{connect:n}:{};return Vt(l,de(e?void 0:i.auth.client.clientUrl,{...t,...c}))}})},wc=t=>{const e=ge(),r=P.useMemo(()=>zn(e.auth.client),[e]),n=_e(r),i=y(n,a=>a.matches("requesting")),s=y(n,a=>a.context.error),o=y(n,a=>a.matches("idle.error")),l=y(n,a=>a.matches("idle.success"));return{resetPassword:(a,u=t)=>Zn(n,a,u),isLoading:i,isSent:l,isError:o,error:s}},xc=t=>{const e=ge(),r=P.useMemo(()=>Jn(e.auth.client),[e]),n=_e(r),i=y(n,a=>a.matches({idle:"error"})),s=y(n,a=>a.matches({idle:"success"})),o=y(n,a=>a.context.error),l=y(n,a=>a.matches("requesting"));return{sendEmail:(a,u=t)=>ei(n,a,u),isLoading:l,isSent:s,isError:i,error:o}},Oc=()=>{const t=J(),e=()=>ti(t),r=y(t,c=>c.context.errors.authentication||null,(c,a)=>(c==null?void 0:c.error)===(a==null?void 0:a.error)),n=y(t,c=>c.matches({authentication:{authenticating:"anonymous"}})),i=y(t,c=>c.matches({authentication:"signedIn"})),s=y(t,c=>c.matches({authentication:{signedOut:"failed"}})),o=y(t,c=>c.context.user,(c,a)=>(c==null?void 0:c.id)===(a==null?void 0:a.id));return{accessToken:y(t,c=>c.context.accessToken.value),error:r,isError:s,isLoading:n,isSuccess:i,signInAnonymous:e,user:o}},kc=()=>{const t=J(),e=(h,p)=>ri(t,h,p),r=h=>oi(t,h),n=y(t,h=>h.context.user,(h,p)=>(h==null?void 0:h.id)===(p==null?void 0:p.id)),i=y(t,h=>h.context.accessToken.value),s=y(t,h=>h.context.refreshToken.value),o=y(t,h=>h.context.errors.authentication||null,(h,p)=>(h==null?void 0:h.error)===(p==null?void 0:p.error)),l=y(t,h=>h.matches({authentication:"signedIn"})),c=y(t,h=>h.matches({authentication:{authenticating:"password"}}),(h,p)=>h===p),a=y(t,h=>h.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(h,p)=>h===p),u=y(t,h=>h.context.mfa!==null),f=y(t,h=>h.matches({authentication:{signedOut:"failed"}}),(h,p)=>h===p),d=y(t,h=>h.context.mfa);return{accessToken:i,refreshToken:s,error:o,isError:f,isLoading:c,isSuccess:l,needsEmailVerification:a,needsMfaOtp:u,mfa:d,sendMfaOtp:r,signInEmailPassword:e,user:n}};function Ac(t){const e=J(),r=(l,c=t)=>Ar(e,l,c),n=y(e,l=>l.context.errors.registration||null,(l,c)=>(l==null?void 0:l.error)===(c==null?void 0:c.error)),i=y(e,l=>l.matches("registration.passwordlessEmail")),s=y(e,l=>l.matches("registration.incomplete.needsEmailVerification")),o=y(e,l=>l.matches("registration.incomplete.failed"));return{signInEmailPasswordless:r,isLoading:i,isSuccess:s,isError:o,error:n}}const Ic=()=>{const t=J(),e=u=>ni(t,u),r=y(t,u=>u.context.user,(u,f)=>(u==null?void 0:u.id)===(f==null?void 0:f.id)),n=y(t,u=>u.context.accessToken.value),i=y(t,u=>u.context.refreshToken.value),s=y(t,u=>u.context.errors.authentication||null,(u,f)=>(u==null?void 0:u.error)===(f==null?void 0:f.error)),o=y(t,u=>u.matches({authentication:"signedIn"})),l=y(t,u=>u.matches({authentication:{authenticating:"securityKeyEmail"}}),(u,f)=>u===f),c=y(t,u=>u.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(u,f)=>u===f),a=y(t,u=>u.matches({authentication:{signedOut:"failed"}}),(u,f)=>u===f);return{accessToken:n,refreshToken:i,error:s,isError:a,isLoading:l,isSuccess:o,needsEmailVerification:c,signInEmailSecurityKey:e,user:r}},qi=()=>{const t=J();return y(t,e=>e.context.user,(e,r)=>(e&&JSON.stringify(e))===(r&&JSON.stringify(r)))},bc=()=>{const t=qi(),e=ge(),r=Jr(),n=t?(r==null?void 0:r["x-hasura-auth-elevated"])===(t==null?void 0:t.id):!1,[i,s]=P.useState(!!n),o=l=>si(e.auth.client,l);return P.useEffect(()=>{s(!!n)},[n]),{elevated:i,elevateEmailSecurityKey:o}},_c=()=>{const t=J(),e=a=>ai(t,a),r=y(t,a=>a.context.user,(a,u)=>(a==null?void 0:a.id)===(u==null?void 0:u.id)),n=y(t,a=>a.context.accessToken.value),i=y(t,a=>a.context.refreshToken.value),s=y(t,a=>a.context.errors.authentication||null,(a,u)=>(a==null?void 0:a.error)===(u==null?void 0:u.error)),o=y(t,a=>a.matches({authentication:"signedIn"})),l=y(t,a=>a.matches({authentication:{authenticating:"password"}}),(a,u)=>a===u),c=y(t,a=>a.matches({authentication:{signedOut:"failed"}}),(a,u)=>a===u);return{accessToken:n,refreshToken:i,error:s,isError:c,isLoading:l,isSuccess:o,signInPAT:e,user:r}};function Nc(t){const e=J(),[r,n]=P.useState(""),i=(f,d=t)=>(n(f),Ir(e,f,d)),s=async(...f)=>{if(f.length===2){const[h,p]=f;return br(e,h,p)}const[d]=f;return br(e,r,d)},o=y(e,f=>f.context.errors.registration||null,(f,d)=>(f==null?void 0:f.error)===(d==null?void 0:d.error)),l=y(e,f=>f.matches("registration.passwordlessSms")||f.matches("registration.passwordlessSmsOtp")),c=y(e,f=>f.matches("authentication.signedIn")),a=y(e,f=>f.matches("registration.incomplete.needsOtp")),u=y(e,f=>f.matches("registration.incomplete.failed"));return{signInSmsPasswordless:i,sendOtp:s,isLoading:l,isSuccess:c,needsOtp:a,isError:u,error:o}}const Rc=(t=!1)=>{const e=J(),r=s=>ci(e,typeof s=="boolean"?s:t),n=y(e,s=>s.matches({authentication:{signedOut:"success"}}),(s,o)=>s===o),i=y(e,s=>s.context.errors.signout||null,(s,o)=>(s==null?void 0:s.error)===(o==null?void 0:o.error));return{signOut:r,isSuccess:n,error:i}},Dc=t=>{const e=J(),r=y(e,f=>!!f.context.errors.registration),n=y(e,f=>f.context.errors.registration||null,(f,d)=>(f==null?void 0:f.error)===(d==null?void 0:d.error)),i=y(e,f=>f.matches("registration.emailPassword")),s=y(e,f=>f.matches("registration.incomplete.needsEmailVerification")),o=y(e,f=>f.matches({authentication:"signedIn",registration:"complete"})),l=(f,d,h=t,p)=>_r(e,f,d,h,p),c=y(e,f=>f.context.user,(f,d)=>(f==null?void 0:f.id)===(d==null?void 0:d.id)),a=y(e,f=>f.context.accessToken.value),u=y(e,f=>f.context.refreshToken.value);return{accessToken:a,refreshToken:u,error:n,isError:r,isLoading:i,isSuccess:o,needsEmailVerification:s,signUpEmailPassword:l,user:c}},Pc=t=>{const e=J(),r=y(e,f=>!!f.context.errors.registration),n=y(e,f=>f.context.errors.registration||null,(f,d)=>(f==null?void 0:f.error)===(d==null?void 0:d.error)),i=y(e,f=>f.matches("registration.securityKey")),s=y(e,f=>f.matches("registration.incomplete.needsEmailVerification")),o=y(e,f=>f.matches({authentication:"signedIn",registration:"complete"})),l=(f,d=t,h)=>ui(e,f,d,h),c=y(e,f=>f.context.user,(f,d)=>(f==null?void 0:f.id)===(d==null?void 0:d.id)),a=y(e,f=>f.context.accessToken.value),u=y(e,f=>f.context.refreshToken.value);return{accessToken:a,refreshToken:u,error:n,isError:r,isLoading:i,isSuccess:o,needsEmailVerification:s,signUpEmailSecurityKey:l,user:c}},Cc=()=>{const t=J();return y(t,e=>{var r;return(r=e.context.user)==null?void 0:r.avatarUrl},(e,r)=>e===r)},Lc=()=>{const t=J();return y(t,e=>{var r;return(r=e.context.user)==null?void 0:r.defaultRole},(e,r)=>e===r)},Uc=()=>{const t=J();return y(t,e=>{var r;return(r=e.context.user)==null?void 0:r.displayName},(e,r)=>e===r)},Mc=()=>{const t=J();return y(t,e=>{var r;return(r=e.context.user)==null?void 0:r.email},(e,r)=>e===r)},jc=()=>{const t=J();return y(t,e=>{var r;return(r=e.context.user)==null?void 0:r.id},(e,r)=>e===r)},Fc=()=>{const t=J();return y(t,e=>{var r;return(r=e.context.user)==null?void 0:r.isAnonymous},(e,r)=>e===r)},Vc=()=>{const t=J();return y(t,e=>{var r;return(r=e.context.user)==null?void 0:r.locale},(e,r)=>e===r)},Bc=()=>{const t=J();return y(t,e=>{var r;return e.matches("authentication.signedIn")?((r=e.context.user)==null?void 0:r.roles)||[]:[]})};function Gc(t){const e=J(),r=(a,u=t)=>li(e,a,u),n=async(a,u)=>di(e,a,u),i=y(e,a=>a.context.errors.registration||null,(a,u)=>(a==null?void 0:a.error)===(u==null?void 0:u.error)),s=y(e,a=>a.matches("registration.signInEmailOTP")||a.matches("registration.verifyEmailOTP")),o=y(e,a=>a.matches("authentication.signedIn")),l=y(e,a=>a.matches("registration.incomplete.needsOtp")),c=y(e,a=>a.matches("registration.incomplete.failed"));return{signInEmailOTP:r,verifyEmailOTP:n,isLoading:s,isSuccess:o,isError:c,error:i,needsOtp:l}}const Hc=()=>{const t=J(),e=(a,u,f)=>hi(t,{provider:a,idToken:u,nonce:f}),r=y(t,a=>a.context.user,(a,u)=>(a==null?void 0:a.id)===(u==null?void 0:u.id)),n=y(t,a=>a.context.accessToken.value),i=y(t,a=>a.context.refreshToken.value),s=y(t,a=>a.context.errors.authentication||null,(a,u)=>(a==null?void 0:a.error)===(u==null?void 0:u.error)),o=y(t,a=>a.matches({authentication:"signedIn"})),l=y(t,a=>a.matches({authentication:{authenticating:"idToken"}}),(a,u)=>a===u),c=y(t,a=>a.matches({authentication:{signedOut:"failed"}}),(a,u)=>a===u);return{accessToken:n,refreshToken:i,error:s,isError:c,isLoading:l,isSuccess:o,signInIdToken:e,user:r}},Kc=()=>{const t=ge(),[e,r]=P.useState(null),n=!e,i=!!e,[s,o]=P.useState(!1);return{linkIdToken:async({provider:c,idToken:a,nonce:u})=>{o(!0);const f=await fi(t.auth.client,{provider:c,idToken:a,...u&&{nonce:u}}),{error:d}=f;return d&&r(d),o(!1),f},isLoading:s,isSuccess:n,isError:i,error:e}},Yc=()=>{const t=J(),e=()=>pi(t),r=y(t,u=>u.context.user,(u,f)=>(u==null?void 0:u.id)===(f==null?void 0:f.id)),n=y(t,u=>u.context.accessToken.value),i=y(t,u=>u.context.refreshToken.value),s=y(t,u=>u.context.errors.authentication||null,(u,f)=>(u==null?void 0:u.error)===(f==null?void 0:f.error)),o=y(t,u=>u.matches({authentication:"signedIn"})),l=y(t,u=>u.matches({authentication:{authenticating:"securityKeyEmail"}}),(u,f)=>u===f),c=y(t,u=>u.matches({authentication:{signedOut:"noErrors"},registration:{incomplete:"needsEmailVerification"}}),(u,f)=>u===f),a=y(t,u=>u.matches({authentication:{signedOut:"failed"}}),(u,f)=>u===f);return{accessToken:n,refreshToken:i,error:s,isError:a,isLoading:l,isSuccess:o,needsEmailVerification:c,signInSecurityKey:e,user:r}};I.NHOST_REFRESH_TOKEN_KEY=Ye,I.NhostClient=Wa,I.NhostProvider=Ki,I.NhostReactContext=vt,I.NhostReactProvider=lc,I.SignedIn=dc,I.SignedOut=hc,I.VanillaNhostClient=Li,I.useAccessToken=zr,I.useAddSecurityKey=fc,I.useAuthInterpreter=J,I.useAuthenticated=pc,I.useAuthenticationStatus=qr,I.useChangeEmail=vc,I.useChangePassword=mc,I.useConfigMfa=yc,I.useDecodedAccessToken=Yi,I.useElevateSecurityKeyEmail=bc,I.useFileUpload=gc,I.useFileUploadItem=$i,I.useHasuraClaim=Ec,I.useHasuraClaims=Jr,I.useLinkIdToken=Kc,I.useMultipleFilesUpload=Tc,I.useNhostClient=ge,I.useProviderLink=Sc,I.useResetPassword=wc,I.useSendVerificationEmail=xc,I.useSignInAnonymous=Oc,I.useSignInEmailOTP=Gc,I.useSignInEmailPassword=kc,I.useSignInEmailPasswordless=Ac,I.useSignInEmailSecurityKey=Ic,I.useSignInIdToken=Hc,I.useSignInPAT=_c,I.useSignInSecurityKey=Yc,I.useSignInSmsPasswordless=Nc,I.useSignOut=Rc,I.useSignUpEmailPassword=Dc,I.useSignUpEmailSecurityKeyEmail=Pc,I.useUserAvatarUrl=Cc,I.useUserData=qi,I.useUserDefaultRole=Lc,I.useUserDisplayName=Uc,I.useUserEmail=Mc,I.useUserId=jc,I.useUserIsAnonymous=Fc,I.useUserLocale=Vc,I.useUserRoles=Bc,Object.defineProperty(I,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=react.umd.js.map
